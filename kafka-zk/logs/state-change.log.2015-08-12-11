[2015-08-12 11:10:39,192] TRACE Controller 2 epoch 8 changed state of replica 2 for partition [t1,0] from OnlineReplica to OnlineReplica (state.change.logger)
[2015-08-12 11:10:39,192] TRACE Controller 2 epoch 8 changed state of replica 2 for partition [t3,0] from OnlineReplica to OnlineReplica (state.change.logger)
[2015-08-12 11:10:39,195] TRACE Controller 2 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7) with correlationId 0 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-12 11:10:39,195] TRACE Controller 2 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7) with correlationId 0 to broker 2 for partition [t3,0] (state.change.logger)
[2015-08-12 11:10:39,197] TRACE Controller 2 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7) with correlationId 0 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-12 11:10:39,197] TRACE Controller 2 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7) with correlationId 0 to broker 2 for partition [t3,0] (state.change.logger)
[2015-08-12 11:10:39,200] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:2) correlation id 0 from controller 2 epoch 8 for partition [t1,0] (state.change.logger)
[2015-08-12 11:10:39,200] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:2) correlation id 0 from controller 2 epoch 8 for partition [t3,0] (state.change.logger)
[2015-08-12 11:10:39,201] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 8 for partition [t1,0] since its associated leader epoch 4 is old. Current leader epoch is 4 (state.change.logger)
[2015-08-12 11:10:39,201] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 8 for partition [t3,0] since its associated leader epoch 4 is old. Current leader epoch is 4 (state.change.logger)
[2015-08-12 11:10:39,203] TRACE Controller 2 epoch 8 started leader election for partition [t2,0] (state.change.logger)
[2015-08-12 11:10:39,205] TRACE Controller 2 epoch 8 received response LeaderAndIsrResponse(0,Map((t1,0) -> 13, (t3,0) -> 13),0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-12 11:10:39,209] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 2 epoch 8 with correlation id 0 (state.change.logger)
[2015-08-12 11:10:39,209] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:2) for partition [t3,0] in response to UpdateMetadata request sent by controller 2 epoch 8 with correlation id 0 (state.change.logger)
[2015-08-12 11:10:39,209] TRACE Controller 2 epoch 8 received response UpdateMetadataResponse(0,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-12 11:10:39,215] ERROR Controller 2 epoch 8 initiated state change for partition [t2,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:139)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:134)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:549)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-12 11:10:39,215] TRACE Controller 2 epoch 8 started leader election for partition [t7,0] (state.change.logger)
[2015-08-12 11:10:39,224] ERROR Controller 2 epoch 8 initiated state change for partition [t7,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t7,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:139)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:134)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:549)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-12 11:10:39,224] TRACE Controller 2 epoch 8 started leader election for partition [t6,0] (state.change.logger)
[2015-08-12 11:10:39,232] ERROR Controller 2 epoch 8 initiated state change for partition [t6,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t6,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:139)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:134)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:549)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-12 11:10:39,232] TRACE Controller 2 epoch 8 started leader election for partition [t4,0] (state.change.logger)
[2015-08-12 11:10:39,238] ERROR Controller 2 epoch 8 initiated state change for partition [t4,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t4,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:139)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:134)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:549)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-12 11:10:39,252] TRACE Controller 2 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7) with correlationId 3 to broker 2 for partition [t3,0] (state.change.logger)
[2015-08-12 11:10:39,252] TRACE Controller 2 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7) with correlationId 3 to broker 2 for partition [t7,0] (state.change.logger)
[2015-08-12 11:10:39,252] TRACE Controller 2 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7) with correlationId 3 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-12 11:10:39,252] TRACE Controller 2 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7) with correlationId 3 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-12 11:10:39,253] TRACE Controller 2 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7) with correlationId 3 to broker 2 for partition [t6,0] (state.change.logger)
[2015-08-12 11:10:39,253] TRACE Controller 2 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7) with correlationId 3 to broker 2 for partition [t2,0] (state.change.logger)
[2015-08-12 11:10:39,254] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:2) for partition [t3,0] in response to UpdateMetadata request sent by controller 2 epoch 8 with correlation id 3 (state.change.logger)
[2015-08-12 11:10:39,254] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:1) for partition [t7,0] in response to UpdateMetadata request sent by controller 2 epoch 8 with correlation id 3 (state.change.logger)
[2015-08-12 11:10:39,254] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 2 epoch 8 with correlation id 3 (state.change.logger)
[2015-08-12 11:10:39,255] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:1) for partition [t4,0] in response to UpdateMetadata request sent by controller 2 epoch 8 with correlation id 3 (state.change.logger)
[2015-08-12 11:10:39,255] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:1) for partition [t6,0] in response to UpdateMetadata request sent by controller 2 epoch 8 with correlation id 3 (state.change.logger)
[2015-08-12 11:10:39,255] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:1) for partition [t2,0] in response to UpdateMetadata request sent by controller 2 epoch 8 with correlation id 3 (state.change.logger)
[2015-08-12 11:10:39,256] TRACE Controller 2 epoch 8 received response UpdateMetadataResponse(3,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-12 11:11:16,487] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2015-08-12 11:12:05,208] TRACE Controller 1 epoch 9 started leader election for partition [t1,0] (state.change.logger)
[2015-08-12 11:12:05,225] ERROR Controller 1 epoch 9 initiated state change for partition [t1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-12 11:12:05,228] TRACE Controller 1 epoch 9 started leader election for partition [t2,0] (state.change.logger)
[2015-08-12 11:12:05,242] ERROR Controller 1 epoch 9 initiated state change for partition [t2,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-12 11:12:05,243] TRACE Controller 1 epoch 9 started leader election for partition [t7,0] (state.change.logger)
[2015-08-12 11:12:05,256] ERROR Controller 1 epoch 9 initiated state change for partition [t7,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t7,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-12 11:12:05,257] TRACE Controller 1 epoch 9 started leader election for partition [t3,0] (state.change.logger)
[2015-08-12 11:12:05,272] ERROR Controller 1 epoch 9 initiated state change for partition [t3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-12 11:12:05,273] TRACE Controller 1 epoch 9 started leader election for partition [t6,0] (state.change.logger)
[2015-08-12 11:12:05,282] ERROR Controller 1 epoch 9 initiated state change for partition [t6,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t6,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-12 11:12:05,284] TRACE Controller 1 epoch 9 started leader election for partition [t4,0] (state.change.logger)
[2015-08-12 11:12:05,295] ERROR Controller 1 epoch 9 initiated state change for partition [t4,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t4,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-12 11:12:05,395] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7) with correlationId 3 to broker 1 for partition [t3,0] (state.change.logger)
[2015-08-12 11:12:05,396] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7) with correlationId 3 to broker 1 for partition [t7,0] (state.change.logger)
[2015-08-12 11:12:05,396] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7) with correlationId 3 to broker 1 for partition [t1,0] (state.change.logger)
[2015-08-12 11:12:05,396] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7) with correlationId 3 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-12 11:12:05,396] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7) with correlationId 3 to broker 1 for partition [t6,0] (state.change.logger)
[2015-08-12 11:12:05,397] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7) with correlationId 3 to broker 1 for partition [t2,0] (state.change.logger)
[2015-08-12 11:12:05,415] TRACE Controller 1 epoch 9 changed state of replica 1 for partition [t2,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-12 11:12:05,416] TRACE Controller 1 epoch 9 changed state of replica 1 for partition [t7,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-12 11:12:05,416] TRACE Controller 1 epoch 9 changed state of replica 1 for partition [t6,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-12 11:12:05,417] TRACE Controller 1 epoch 9 changed state of replica 1 for partition [t4,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-12 11:12:05,420] TRACE Controller 1 epoch 9 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7) with correlationId 4 to broker 1 for partition [t7,0] (state.change.logger)
[2015-08-12 11:12:05,421] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:2) for partition [t3,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 3 (state.change.logger)
[2015-08-12 11:12:05,421] TRACE Controller 1 epoch 9 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7) with correlationId 4 to broker 1 for partition [t2,0] (state.change.logger)
[2015-08-12 11:12:05,421] TRACE Controller 1 epoch 9 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7) with correlationId 4 to broker 1 for partition [t6,0] (state.change.logger)
[2015-08-12 11:12:05,421] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:1) for partition [t7,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 3 (state.change.logger)
[2015-08-12 11:12:05,421] TRACE Controller 1 epoch 9 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7) with correlationId 4 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-12 11:12:05,421] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 3 (state.change.logger)
[2015-08-12 11:12:05,421] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:1) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 3 (state.change.logger)
[2015-08-12 11:12:05,421] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7) with correlationId 4 to broker 1 for partition [t7,0] (state.change.logger)
[2015-08-12 11:12:05,421] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:1) for partition [t6,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 3 (state.change.logger)
[2015-08-12 11:12:05,422] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7) with correlationId 4 to broker 1 for partition [t2,0] (state.change.logger)
[2015-08-12 11:12:05,422] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:1) for partition [t2,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 3 (state.change.logger)
[2015-08-12 11:12:05,422] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7) with correlationId 4 to broker 1 for partition [t6,0] (state.change.logger)
[2015-08-12 11:12:05,422] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7) with correlationId 4 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-12 11:12:05,422] TRACE Controller 1 epoch 9 started leader election for partition [t1,0] (state.change.logger)
[2015-08-12 11:12:05,430] ERROR Controller 1 epoch 9 initiated state change for partition [t1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-12 11:12:05,431] TRACE Controller 1 epoch 9 started leader election for partition [t2,0] (state.change.logger)
[2015-08-12 11:12:05,437] TRACE Controller 1 epoch 9 received response UpdateMetadataResponse(3,0) for a request sent to broker id:1,host:fufuka,port:9092 (state.change.logger)
[2015-08-12 11:12:05,445] TRACE Controller 1 epoch 9 elected leader 1 for Offline partition [t2,0] (state.change.logger)
[2015-08-12 11:12:05,453] TRACE Controller 1 epoch 9 changed partition [t2,0] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2015-08-12 11:12:05,453] TRACE Controller 1 epoch 9 started leader election for partition [t7,0] (state.change.logger)
[2015-08-12 11:12:05,459] TRACE Controller 1 epoch 9 elected leader 1 for Offline partition [t7,0] (state.change.logger)
[2015-08-12 11:12:05,460] TRACE Controller 1 epoch 9 changed partition [t7,0] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2015-08-12 11:12:05,460] TRACE Controller 1 epoch 9 started leader election for partition [t3,0] (state.change.logger)
[2015-08-12 11:12:05,467] ERROR Controller 1 epoch 9 initiated state change for partition [t3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-12 11:12:05,468] TRACE Controller 1 epoch 9 started leader election for partition [t6,0] (state.change.logger)
[2015-08-12 11:12:05,474] TRACE Controller 1 epoch 9 elected leader 1 for Offline partition [t6,0] (state.change.logger)
[2015-08-12 11:12:05,476] TRACE Controller 1 epoch 9 changed partition [t6,0] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2015-08-12 11:12:05,476] TRACE Controller 1 epoch 9 started leader election for partition [t4,0] (state.change.logger)
[2015-08-12 11:12:05,481] TRACE Controller 1 epoch 9 elected leader 1 for Offline partition [t4,0] (state.change.logger)
[2015-08-12 11:12:05,482] TRACE Controller 1 epoch 9 changed partition [t4,0] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2015-08-12 11:12:05,482] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:1) correlation id 4 from controller 1 epoch 9 for partition [t2,0] (state.change.logger)
[2015-08-12 11:12:05,482] TRACE Controller 1 epoch 9 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 5 to broker 1 for partition [t7,0] (state.change.logger)
[2015-08-12 11:12:05,482] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:1) correlation id 4 from controller 1 epoch 9 for partition [t7,0] (state.change.logger)
[2015-08-12 11:12:05,482] TRACE Controller 1 epoch 9 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 5 to broker 1 for partition [t2,0] (state.change.logger)
[2015-08-12 11:12:05,482] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:1) correlation id 4 from controller 1 epoch 9 for partition [t6,0] (state.change.logger)
[2015-08-12 11:12:05,483] TRACE Controller 1 epoch 9 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 5 to broker 1 for partition [t6,0] (state.change.logger)
[2015-08-12 11:12:05,483] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:1) correlation id 4 from controller 1 epoch 9 for partition [t4,0] (state.change.logger)
[2015-08-12 11:12:05,483] TRACE Controller 1 epoch 9 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 5 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-12 11:12:05,483] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 5 to broker 1 for partition [t7,0] (state.change.logger)
[2015-08-12 11:12:05,483] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 5 to broker 1 for partition [t2,0] (state.change.logger)
[2015-08-12 11:12:05,484] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 5 to broker 1 for partition [t6,0] (state.change.logger)
[2015-08-12 11:12:05,484] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 5 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-12 11:12:05,489] TRACE Broker 1 handling LeaderAndIsr request correlationId 4 from controller 1 epoch 9 starting the become-leader transition for partition [t6,0] (state.change.logger)
[2015-08-12 11:12:05,489] TRACE Broker 1 handling LeaderAndIsr request correlationId 4 from controller 1 epoch 9 starting the become-leader transition for partition [t2,0] (state.change.logger)
[2015-08-12 11:12:05,489] TRACE Broker 1 handling LeaderAndIsr request correlationId 4 from controller 1 epoch 9 starting the become-leader transition for partition [t7,0] (state.change.logger)
[2015-08-12 11:12:05,490] TRACE Broker 1 handling LeaderAndIsr request correlationId 4 from controller 1 epoch 9 starting the become-leader transition for partition [t4,0] (state.change.logger)
[2015-08-12 11:12:05,494] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 1 epoch 9 with correlation id 4 for partition [t6,0] (state.change.logger)
[2015-08-12 11:12:05,494] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 1 epoch 9 with correlation id 4 for partition [t2,0] (state.change.logger)
[2015-08-12 11:12:05,494] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 1 epoch 9 with correlation id 4 for partition [t7,0] (state.change.logger)
[2015-08-12 11:12:05,494] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 1 epoch 9 with correlation id 4 for partition [t4,0] (state.change.logger)
[2015-08-12 11:12:05,517] TRACE Broker 1 completed LeaderAndIsr request correlationId 4 from controller 1 epoch 9 for the become-leader transition for partition [t6,0] (state.change.logger)
[2015-08-12 11:12:05,517] TRACE Broker 1 completed LeaderAndIsr request correlationId 4 from controller 1 epoch 9 for the become-leader transition for partition [t2,0] (state.change.logger)
[2015-08-12 11:12:05,517] TRACE Broker 1 completed LeaderAndIsr request correlationId 4 from controller 1 epoch 9 for the become-leader transition for partition [t7,0] (state.change.logger)
[2015-08-12 11:12:05,517] TRACE Broker 1 completed LeaderAndIsr request correlationId 4 from controller 1 epoch 9 for the become-leader transition for partition [t4,0] (state.change.logger)
[2015-08-12 11:12:05,521] TRACE Controller 1 epoch 9 received response LeaderAndIsrResponse(4,Map((t2,0) -> 0, (t7,0) -> 0, (t6,0) -> 0, (t4,0) -> 0),0) for a request sent to broker id:1,host:fufuka,port:9092 (state.change.logger)
[2015-08-12 11:12:05,522] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:1) for partition [t2,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 4 (state.change.logger)
[2015-08-12 11:12:05,522] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:1) for partition [t7,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 4 (state.change.logger)
[2015-08-12 11:12:05,523] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:1) for partition [t6,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 4 (state.change.logger)
[2015-08-12 11:12:05,523] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:1) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 4 (state.change.logger)
[2015-08-12 11:12:05,523] TRACE Controller 1 epoch 9 received response UpdateMetadataResponse(4,0) for a request sent to broker id:1,host:fufuka,port:9092 (state.change.logger)
[2015-08-12 11:12:05,524] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:1) correlation id 5 from controller 1 epoch 9 for partition [t2,0] (state.change.logger)
[2015-08-12 11:12:05,524] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:1) correlation id 5 from controller 1 epoch 9 for partition [t7,0] (state.change.logger)
[2015-08-12 11:12:05,524] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:1) correlation id 5 from controller 1 epoch 9 for partition [t6,0] (state.change.logger)
[2015-08-12 11:12:05,524] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:1) correlation id 5 from controller 1 epoch 9 for partition [t4,0] (state.change.logger)
[2015-08-12 11:12:05,525] TRACE Broker 1 handling LeaderAndIsr request correlationId 5 from controller 1 epoch 9 starting the become-leader transition for partition [t6,0] (state.change.logger)
[2015-08-12 11:12:05,525] TRACE Broker 1 handling LeaderAndIsr request correlationId 5 from controller 1 epoch 9 starting the become-leader transition for partition [t2,0] (state.change.logger)
[2015-08-12 11:12:05,525] TRACE Broker 1 handling LeaderAndIsr request correlationId 5 from controller 1 epoch 9 starting the become-leader transition for partition [t7,0] (state.change.logger)
[2015-08-12 11:12:05,525] TRACE Broker 1 handling LeaderAndIsr request correlationId 5 from controller 1 epoch 9 starting the become-leader transition for partition [t4,0] (state.change.logger)
[2015-08-12 11:12:05,526] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 1 epoch 9 with correlation id 5 for partition [t6,0] (state.change.logger)
[2015-08-12 11:12:05,526] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 1 epoch 9 with correlation id 5 for partition [t2,0] (state.change.logger)
[2015-08-12 11:12:05,526] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 1 epoch 9 with correlation id 5 for partition [t7,0] (state.change.logger)
[2015-08-12 11:12:05,526] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 1 epoch 9 with correlation id 5 for partition [t4,0] (state.change.logger)
[2015-08-12 11:12:05,527] TRACE Broker 1 completed LeaderAndIsr request correlationId 5 from controller 1 epoch 9 for the become-leader transition for partition [t6,0] (state.change.logger)
[2015-08-12 11:12:05,527] TRACE Broker 1 completed LeaderAndIsr request correlationId 5 from controller 1 epoch 9 for the become-leader transition for partition [t2,0] (state.change.logger)
[2015-08-12 11:12:05,527] TRACE Broker 1 completed LeaderAndIsr request correlationId 5 from controller 1 epoch 9 for the become-leader transition for partition [t7,0] (state.change.logger)
[2015-08-12 11:12:05,527] TRACE Broker 1 completed LeaderAndIsr request correlationId 5 from controller 1 epoch 9 for the become-leader transition for partition [t4,0] (state.change.logger)
[2015-08-12 11:12:05,528] TRACE Controller 1 epoch 9 received response LeaderAndIsrResponse(5,Map((t2,0) -> 0, (t7,0) -> 0, (t6,0) -> 0, (t4,0) -> 0),0) for a request sent to broker id:1,host:fufuka,port:9092 (state.change.logger)
[2015-08-12 11:12:05,529] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:1) for partition [t2,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 5 (state.change.logger)
[2015-08-12 11:12:05,530] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:1) for partition [t7,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 5 (state.change.logger)
[2015-08-12 11:12:05,530] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:1) for partition [t6,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 5 (state.change.logger)
[2015-08-12 11:12:05,530] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:1) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 5 (state.change.logger)
[2015-08-12 11:12:05,531] TRACE Controller 1 epoch 9 received response UpdateMetadataResponse(5,0) for a request sent to broker id:1,host:fufuka,port:9092 (state.change.logger)
[2015-08-12 11:12:25,837] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7) with correlationId 6 to broker 2 for partition [t3,0] (state.change.logger)
[2015-08-12 11:12:25,837] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 6 to broker 2 for partition [t7,0] (state.change.logger)
[2015-08-12 11:12:25,837] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7) with correlationId 6 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-12 11:12:25,837] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 6 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-12 11:12:25,838] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 6 to broker 2 for partition [t6,0] (state.change.logger)
[2015-08-12 11:12:25,838] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 6 to broker 2 for partition [t2,0] (state.change.logger)
[2015-08-12 11:12:25,838] TRACE Controller 1 epoch 9 changed state of replica 2 for partition [t1,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-12 11:12:25,839] TRACE Controller 1 epoch 9 changed state of replica 2 for partition [t3,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-12 11:12:25,839] TRACE Controller 1 epoch 9 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7) with correlationId 7 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-12 11:12:25,839] TRACE Controller 1 epoch 9 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7) with correlationId 7 to broker 2 for partition [t3,0] (state.change.logger)
[2015-08-12 11:12:25,839] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7) with correlationId 7 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-12 11:12:25,839] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7) with correlationId 7 to broker 2 for partition [t3,0] (state.change.logger)
[2015-08-12 11:12:25,839] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7) with correlationId 7 to broker 1 for partition [t1,0] (state.change.logger)
[2015-08-12 11:12:25,840] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7) with correlationId 7 to broker 1 for partition [t3,0] (state.change.logger)
[2015-08-12 11:12:25,840] TRACE Controller 1 epoch 9 started leader election for partition [t1,0] (state.change.logger)
[2015-08-12 11:12:25,848] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 7 (state.change.logger)
[2015-08-12 11:12:25,848] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:2) for partition [t3,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 7 (state.change.logger)
[2015-08-12 11:12:25,850] TRACE Controller 1 epoch 9 received response UpdateMetadataResponse(7,0) for a request sent to broker id:1,host:fufuka,port:9092 (state.change.logger)
[2015-08-12 11:12:25,852] TRACE Controller 1 epoch 9 elected leader 2 for Offline partition [t1,0] (state.change.logger)
[2015-08-12 11:12:25,852] TRACE Controller 1 epoch 9 changed partition [t1,0] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2015-08-12 11:12:25,853] TRACE Controller 1 epoch 9 started leader election for partition [t3,0] (state.change.logger)
[2015-08-12 11:12:25,861] TRACE Controller 1 epoch 9 elected leader 2 for Offline partition [t3,0] (state.change.logger)
[2015-08-12 11:12:25,861] TRACE Controller 1 epoch 9 changed partition [t3,0] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2015-08-12 11:12:25,862] TRACE Controller 1 epoch 9 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9) with correlationId 8 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-12 11:12:25,862] TRACE Controller 1 epoch 9 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9) with correlationId 8 to broker 2 for partition [t3,0] (state.change.logger)
[2015-08-12 11:12:25,862] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9) with correlationId 8 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-12 11:12:25,862] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9) with correlationId 8 to broker 2 for partition [t3,0] (state.change.logger)
[2015-08-12 11:12:25,863] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9) with correlationId 8 to broker 1 for partition [t1,0] (state.change.logger)
[2015-08-12 11:12:25,863] TRACE Controller 1 epoch 9 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9) with correlationId 8 to broker 1 for partition [t3,0] (state.change.logger)
[2015-08-12 11:12:25,864] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 8 (state.change.logger)
[2015-08-12 11:12:25,864] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) for partition [t3,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 8 (state.change.logger)
[2015-08-12 11:12:25,866] TRACE Controller 1 epoch 9 received response UpdateMetadataResponse(8,0) for a request sent to broker id:1,host:fufuka,port:9092 (state.change.logger)
[2015-08-12 11:12:25,880] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:2) for partition [t3,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 6 (state.change.logger)
[2015-08-12 11:12:25,880] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:1) for partition [t7,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 6 (state.change.logger)
[2015-08-12 11:12:25,881] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 6 (state.change.logger)
[2015-08-12 11:12:25,881] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:1) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 6 (state.change.logger)
[2015-08-12 11:12:25,881] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:1) for partition [t6,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 6 (state.change.logger)
[2015-08-12 11:12:25,882] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:1) for partition [t2,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 6 (state.change.logger)
[2015-08-12 11:12:25,895] TRACE Controller 1 epoch 9 received response UpdateMetadataResponse(6,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-12 11:12:25,969] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:2) correlation id 7 from controller 1 epoch 9 for partition [t1,0] (state.change.logger)
[2015-08-12 11:12:25,970] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:2) correlation id 7 from controller 1 epoch 9 for partition [t3,0] (state.change.logger)
[2015-08-12 11:12:25,979] TRACE Broker 2 handling LeaderAndIsr request correlationId 7 from controller 1 epoch 9 starting the become-leader transition for partition [t1,0] (state.change.logger)
[2015-08-12 11:12:25,979] TRACE Broker 2 handling LeaderAndIsr request correlationId 7 from controller 1 epoch 9 starting the become-leader transition for partition [t3,0] (state.change.logger)
[2015-08-12 11:12:25,984] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 9 with correlation id 7 for partition [t1,0] (state.change.logger)
[2015-08-12 11:12:25,984] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 9 with correlation id 7 for partition [t3,0] (state.change.logger)
[2015-08-12 11:12:26,006] TRACE Broker 2 completed LeaderAndIsr request correlationId 7 from controller 1 epoch 9 for the become-leader transition for partition [t1,0] (state.change.logger)
[2015-08-12 11:12:26,006] TRACE Broker 2 completed LeaderAndIsr request correlationId 7 from controller 1 epoch 9 for the become-leader transition for partition [t3,0] (state.change.logger)
[2015-08-12 11:12:26,012] TRACE Controller 1 epoch 9 received response LeaderAndIsrResponse(7,Map((t1,0) -> 0, (t3,0) -> 0),0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-12 11:12:26,013] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 7 (state.change.logger)
[2015-08-12 11:12:26,014] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:2) for partition [t3,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 7 (state.change.logger)
[2015-08-12 11:12:26,014] TRACE Controller 1 epoch 9 received response UpdateMetadataResponse(7,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-12 11:12:26,015] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) correlation id 8 from controller 1 epoch 9 for partition [t1,0] (state.change.logger)
[2015-08-12 11:12:26,016] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) correlation id 8 from controller 1 epoch 9 for partition [t3,0] (state.change.logger)
[2015-08-12 11:12:26,016] TRACE Broker 2 handling LeaderAndIsr request correlationId 8 from controller 1 epoch 9 starting the become-leader transition for partition [t1,0] (state.change.logger)
[2015-08-12 11:12:26,016] TRACE Broker 2 handling LeaderAndIsr request correlationId 8 from controller 1 epoch 9 starting the become-leader transition for partition [t3,0] (state.change.logger)
[2015-08-12 11:12:26,017] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 9 with correlation id 8 for partition [t1,0] (state.change.logger)
[2015-08-12 11:12:26,017] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 9 with correlation id 8 for partition [t3,0] (state.change.logger)
[2015-08-12 11:12:26,018] TRACE Broker 2 completed LeaderAndIsr request correlationId 8 from controller 1 epoch 9 for the become-leader transition for partition [t1,0] (state.change.logger)
[2015-08-12 11:12:26,018] TRACE Broker 2 completed LeaderAndIsr request correlationId 8 from controller 1 epoch 9 for the become-leader transition for partition [t3,0] (state.change.logger)
[2015-08-12 11:12:26,022] TRACE Controller 1 epoch 9 received response LeaderAndIsrResponse(8,Map((t1,0) -> 0, (t3,0) -> 0),0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-12 11:12:26,023] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 8 (state.change.logger)
[2015-08-12 11:12:26,024] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) for partition [t3,0] in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 8 (state.change.logger)
[2015-08-12 11:12:26,024] TRACE Controller 1 epoch 9 received response UpdateMetadataResponse(8,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-12 11:15:15,354] TRACE Controller 2 epoch 10 changed state of replica 2 for partition [t1,0] from OnlineReplica to OnlineReplica (state.change.logger)
[2015-08-12 11:15:15,355] TRACE Controller 2 epoch 10 changed state of replica 2 for partition [t3,0] from OnlineReplica to OnlineReplica (state.change.logger)
[2015-08-12 11:15:15,357] TRACE Controller 2 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9) with correlationId 0 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-12 11:15:15,357] TRACE Controller 2 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9) with correlationId 0 to broker 2 for partition [t3,0] (state.change.logger)
[2015-08-12 11:15:15,359] TRACE Controller 2 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9) with correlationId 0 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-12 11:15:15,359] TRACE Controller 2 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9) with correlationId 0 to broker 2 for partition [t3,0] (state.change.logger)
[2015-08-12 11:15:15,364] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) correlation id 0 from controller 2 epoch 10 for partition [t1,0] (state.change.logger)
[2015-08-12 11:15:15,364] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) correlation id 0 from controller 2 epoch 10 for partition [t3,0] (state.change.logger)
[2015-08-12 11:15:15,364] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 10 for partition [t1,0] since its associated leader epoch 5 is old. Current leader epoch is 5 (state.change.logger)
[2015-08-12 11:15:15,365] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 10 for partition [t3,0] since its associated leader epoch 5 is old. Current leader epoch is 5 (state.change.logger)
[2015-08-12 11:15:15,366] TRACE Controller 2 epoch 10 started leader election for partition [t2,0] (state.change.logger)
[2015-08-12 11:15:15,370] TRACE Controller 2 epoch 10 received response LeaderAndIsrResponse(0,Map((t1,0) -> 13, (t3,0) -> 13),0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-12 11:15:15,374] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 2 epoch 10 with correlation id 0 (state.change.logger)
[2015-08-12 11:15:15,374] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) for partition [t3,0] in response to UpdateMetadata request sent by controller 2 epoch 10 with correlation id 0 (state.change.logger)
[2015-08-12 11:15:15,375] TRACE Controller 2 epoch 10 received response UpdateMetadataResponse(0,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-12 11:15:15,380] ERROR Controller 2 epoch 10 initiated state change for partition [t2,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:139)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:134)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:549)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-12 11:15:15,381] TRACE Controller 2 epoch 10 started leader election for partition [t7,0] (state.change.logger)
[2015-08-12 11:15:15,389] ERROR Controller 2 epoch 10 initiated state change for partition [t7,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t7,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:139)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:134)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:549)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-12 11:15:15,390] TRACE Controller 2 epoch 10 started leader election for partition [t6,0] (state.change.logger)
[2015-08-12 11:15:15,397] ERROR Controller 2 epoch 10 initiated state change for partition [t6,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t6,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:139)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:134)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:549)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-12 11:15:15,398] TRACE Controller 2 epoch 10 started leader election for partition [t4,0] (state.change.logger)
[2015-08-12 11:15:15,413] ERROR Controller 2 epoch 10 initiated state change for partition [t4,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t4,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:139)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:134)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:549)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-12 11:15:15,431] TRACE Controller 2 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9) with correlationId 3 to broker 2 for partition [t3,0] (state.change.logger)
[2015-08-12 11:15:15,431] TRACE Controller 2 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 3 to broker 2 for partition [t7,0] (state.change.logger)
[2015-08-12 11:15:15,431] TRACE Controller 2 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9) with correlationId 3 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-12 11:15:15,431] TRACE Controller 2 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 3 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-12 11:15:15,431] TRACE Controller 2 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 3 to broker 2 for partition [t6,0] (state.change.logger)
[2015-08-12 11:15:15,431] TRACE Controller 2 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 3 to broker 2 for partition [t2,0] (state.change.logger)
[2015-08-12 11:15:15,435] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) for partition [t3,0] in response to UpdateMetadata request sent by controller 2 epoch 10 with correlation id 3 (state.change.logger)
[2015-08-12 11:15:15,436] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:1) for partition [t7,0] in response to UpdateMetadata request sent by controller 2 epoch 10 with correlation id 3 (state.change.logger)
[2015-08-12 11:15:15,436] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 2 epoch 10 with correlation id 3 (state.change.logger)
[2015-08-12 11:15:15,436] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:1) for partition [t4,0] in response to UpdateMetadata request sent by controller 2 epoch 10 with correlation id 3 (state.change.logger)
[2015-08-12 11:15:15,436] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:1) for partition [t6,0] in response to UpdateMetadata request sent by controller 2 epoch 10 with correlation id 3 (state.change.logger)
[2015-08-12 11:15:15,436] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:1) for partition [t2,0] in response to UpdateMetadata request sent by controller 2 epoch 10 with correlation id 3 (state.change.logger)
[2015-08-12 11:15:15,439] TRACE Controller 2 epoch 10 received response UpdateMetadataResponse(3,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-12 11:15:19,097] TRACE Controller 1 epoch 11 started leader election for partition [t1,0] (state.change.logger)
[2015-08-12 11:15:19,137] ERROR Controller 1 epoch 11 initiated state change for partition [t1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-12 11:15:19,140] TRACE Controller 1 epoch 11 started leader election for partition [t2,0] (state.change.logger)
[2015-08-12 11:15:19,153] ERROR Controller 1 epoch 11 initiated state change for partition [t2,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-12 11:15:19,154] TRACE Controller 1 epoch 11 started leader election for partition [t7,0] (state.change.logger)
[2015-08-12 11:15:19,163] ERROR Controller 1 epoch 11 initiated state change for partition [t7,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t7,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-12 11:15:19,164] TRACE Controller 1 epoch 11 started leader election for partition [t3,0] (state.change.logger)
[2015-08-12 11:15:19,172] ERROR Controller 1 epoch 11 initiated state change for partition [t3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-12 11:15:19,173] TRACE Controller 1 epoch 11 started leader election for partition [t6,0] (state.change.logger)
[2015-08-12 11:15:19,184] ERROR Controller 1 epoch 11 initiated state change for partition [t6,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t6,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-12 11:15:19,185] TRACE Controller 1 epoch 11 started leader election for partition [t4,0] (state.change.logger)
[2015-08-12 11:15:19,193] ERROR Controller 1 epoch 11 initiated state change for partition [t4,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t4,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-12 11:15:19,270] TRACE Controller 1 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9) with correlationId 3 to broker 1 for partition [t3,0] (state.change.logger)
[2015-08-12 11:15:19,270] TRACE Controller 1 epoch 11 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 3 to broker 1 for partition [t7,0] (state.change.logger)
[2015-08-12 11:15:19,270] TRACE Controller 1 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9) with correlationId 3 to broker 1 for partition [t1,0] (state.change.logger)
[2015-08-12 11:15:19,271] TRACE Controller 1 epoch 11 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 3 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-12 11:15:19,271] TRACE Controller 1 epoch 11 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 3 to broker 1 for partition [t6,0] (state.change.logger)
[2015-08-12 11:15:19,271] TRACE Controller 1 epoch 11 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 3 to broker 1 for partition [t2,0] (state.change.logger)
[2015-08-12 11:15:19,284] TRACE Controller 1 epoch 11 changed state of replica 1 for partition [t2,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-12 11:15:19,284] TRACE Controller 1 epoch 11 changed state of replica 1 for partition [t7,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-12 11:15:19,285] TRACE Controller 1 epoch 11 changed state of replica 1 for partition [t6,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-12 11:15:19,285] TRACE Controller 1 epoch 11 changed state of replica 1 for partition [t4,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-12 11:15:19,289] TRACE Controller 1 epoch 11 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 4 to broker 1 for partition [t7,0] (state.change.logger)
[2015-08-12 11:15:19,289] TRACE Controller 1 epoch 11 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 4 to broker 1 for partition [t2,0] (state.change.logger)
[2015-08-12 11:15:19,289] TRACE Controller 1 epoch 11 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 4 to broker 1 for partition [t6,0] (state.change.logger)
[2015-08-12 11:15:19,289] TRACE Controller 1 epoch 11 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 4 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-12 11:15:19,290] TRACE Controller 1 epoch 11 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 4 to broker 1 for partition [t7,0] (state.change.logger)
[2015-08-12 11:15:19,290] TRACE Controller 1 epoch 11 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 4 to broker 1 for partition [t2,0] (state.change.logger)
[2015-08-12 11:15:19,290] TRACE Controller 1 epoch 11 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 4 to broker 1 for partition [t6,0] (state.change.logger)
[2015-08-12 11:15:19,290] TRACE Controller 1 epoch 11 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) with correlationId 4 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-12 11:15:19,291] TRACE Controller 1 epoch 11 started leader election for partition [t1,0] (state.change.logger)
[2015-08-12 11:15:19,299] ERROR Controller 1 epoch 11 initiated state change for partition [t1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-12 11:15:19,300] TRACE Controller 1 epoch 11 started leader election for partition [t2,0] (state.change.logger)
[2015-08-12 11:15:19,340] TRACE Controller 1 epoch 11 elected leader 1 for Offline partition [t2,0] (state.change.logger)
[2015-08-12 11:15:19,343] TRACE Controller 1 epoch 11 changed partition [t2,0] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2015-08-12 11:15:19,344] TRACE Controller 1 epoch 11 started leader election for partition [t7,0] (state.change.logger)
[2015-08-12 11:15:19,351] TRACE Controller 1 epoch 11 elected leader 1 for Offline partition [t7,0] (state.change.logger)
[2015-08-12 11:15:19,352] TRACE Controller 1 epoch 11 changed partition [t7,0] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2015-08-12 11:15:19,352] TRACE Controller 1 epoch 11 started leader election for partition [t3,0] (state.change.logger)
[2015-08-12 11:15:19,363] ERROR Controller 1 epoch 11 initiated state change for partition [t3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-12 11:15:19,364] TRACE Controller 1 epoch 11 started leader election for partition [t6,0] (state.change.logger)
[2015-08-12 11:15:19,369] TRACE Controller 1 epoch 11 elected leader 1 for Offline partition [t6,0] (state.change.logger)
[2015-08-12 11:15:19,370] TRACE Controller 1 epoch 11 changed partition [t6,0] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2015-08-12 11:15:19,370] TRACE Controller 1 epoch 11 started leader election for partition [t4,0] (state.change.logger)
[2015-08-12 11:15:19,376] TRACE Controller 1 epoch 11 elected leader 1 for Offline partition [t4,0] (state.change.logger)
[2015-08-12 11:15:19,377] TRACE Controller 1 epoch 11 changed partition [t4,0] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2015-08-12 11:15:19,377] TRACE Controller 1 epoch 11 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11) with correlationId 5 to broker 1 for partition [t7,0] (state.change.logger)
[2015-08-12 11:15:19,377] TRACE Controller 1 epoch 11 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11) with correlationId 5 to broker 1 for partition [t2,0] (state.change.logger)
[2015-08-12 11:15:19,377] TRACE Controller 1 epoch 11 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11) with correlationId 5 to broker 1 for partition [t6,0] (state.change.logger)
[2015-08-12 11:15:19,378] TRACE Controller 1 epoch 11 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11) with correlationId 5 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-12 11:15:19,378] TRACE Controller 1 epoch 11 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11) with correlationId 5 to broker 1 for partition [t7,0] (state.change.logger)
[2015-08-12 11:15:19,378] TRACE Controller 1 epoch 11 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11) with correlationId 5 to broker 1 for partition [t2,0] (state.change.logger)
[2015-08-12 11:15:19,378] TRACE Controller 1 epoch 11 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11) with correlationId 5 to broker 1 for partition [t6,0] (state.change.logger)
[2015-08-12 11:15:19,378] TRACE Controller 1 epoch 11 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11) with correlationId 5 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-12 11:16:36,959] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2015-08-12 11:16:52,532] TRACE Controller 1 epoch 12 started leader election for partition [t1,0] (state.change.logger)
[2015-08-12 11:16:52,546] ERROR Controller 1 epoch 12 initiated state change for partition [t1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-12 11:16:52,548] TRACE Controller 1 epoch 12 started leader election for partition [t2,0] (state.change.logger)
[2015-08-12 11:16:52,556] ERROR Controller 1 epoch 12 initiated state change for partition [t2,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-12 11:16:52,557] TRACE Controller 1 epoch 12 started leader election for partition [t7,0] (state.change.logger)
[2015-08-12 11:16:52,565] ERROR Controller 1 epoch 12 initiated state change for partition [t7,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t7,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-12 11:16:52,566] TRACE Controller 1 epoch 12 started leader election for partition [t3,0] (state.change.logger)
[2015-08-12 11:16:52,575] ERROR Controller 1 epoch 12 initiated state change for partition [t3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-12 11:16:52,576] TRACE Controller 1 epoch 12 started leader election for partition [t6,0] (state.change.logger)
[2015-08-12 11:16:52,589] ERROR Controller 1 epoch 12 initiated state change for partition [t6,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t6,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-12 11:16:52,590] TRACE Controller 1 epoch 12 started leader election for partition [t4,0] (state.change.logger)
[2015-08-12 11:16:52,599] ERROR Controller 1 epoch 12 initiated state change for partition [t4,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t4,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-12 11:16:52,686] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9) with correlationId 3 to broker 1 for partition [t3,0] (state.change.logger)
[2015-08-12 11:16:52,687] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11) with correlationId 3 to broker 1 for partition [t7,0] (state.change.logger)
[2015-08-12 11:16:52,687] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9) with correlationId 3 to broker 1 for partition [t1,0] (state.change.logger)
[2015-08-12 11:16:52,687] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11) with correlationId 3 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-12 11:16:52,687] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11) with correlationId 3 to broker 1 for partition [t6,0] (state.change.logger)
[2015-08-12 11:16:52,688] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11) with correlationId 3 to broker 1 for partition [t2,0] (state.change.logger)
[2015-08-12 11:16:52,700] TRACE Controller 1 epoch 12 changed state of replica 1 for partition [t2,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-12 11:16:52,700] TRACE Controller 1 epoch 12 changed state of replica 1 for partition [t7,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-12 11:16:52,701] TRACE Controller 1 epoch 12 changed state of replica 1 for partition [t6,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-12 11:16:52,701] TRACE Controller 1 epoch 12 changed state of replica 1 for partition [t4,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-12 11:16:52,704] TRACE Controller 1 epoch 12 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11) with correlationId 4 to broker 1 for partition [t7,0] (state.change.logger)
[2015-08-12 11:16:52,704] TRACE Controller 1 epoch 12 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11) with correlationId 4 to broker 1 for partition [t2,0] (state.change.logger)
[2015-08-12 11:16:52,704] TRACE Controller 1 epoch 12 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11) with correlationId 4 to broker 1 for partition [t6,0] (state.change.logger)
[2015-08-12 11:16:52,704] TRACE Controller 1 epoch 12 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11) with correlationId 4 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-12 11:16:52,705] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11) with correlationId 4 to broker 1 for partition [t7,0] (state.change.logger)
[2015-08-12 11:16:52,705] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11) with correlationId 4 to broker 1 for partition [t2,0] (state.change.logger)
[2015-08-12 11:16:52,705] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11) with correlationId 4 to broker 1 for partition [t6,0] (state.change.logger)
[2015-08-12 11:16:52,705] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11) with correlationId 4 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-12 11:16:52,705] TRACE Controller 1 epoch 12 started leader election for partition [t1,0] (state.change.logger)
[2015-08-12 11:16:52,713] ERROR Controller 1 epoch 12 initiated state change for partition [t1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-12 11:16:52,714] TRACE Controller 1 epoch 12 started leader election for partition [t2,0] (state.change.logger)
[2015-08-12 11:16:52,716] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) for partition [t3,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 3 (state.change.logger)
[2015-08-12 11:16:52,716] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition [t7,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 3 (state.change.logger)
[2015-08-12 11:16:52,716] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 3 (state.change.logger)
[2015-08-12 11:16:52,716] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 3 (state.change.logger)
[2015-08-12 11:16:52,717] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition [t6,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 3 (state.change.logger)
[2015-08-12 11:16:52,717] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition [t2,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 3 (state.change.logger)
[2015-08-12 11:16:52,727] TRACE Controller 1 epoch 12 elected leader 1 for Offline partition [t2,0] (state.change.logger)
[2015-08-12 11:16:52,729] TRACE Controller 1 epoch 12 changed partition [t2,0] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2015-08-12 11:16:52,730] TRACE Controller 1 epoch 12 started leader election for partition [t7,0] (state.change.logger)
[2015-08-12 11:16:52,732] TRACE Controller 1 epoch 12 received response UpdateMetadataResponse(3,0) for a request sent to broker id:1,host:fufuka,port:9092 (state.change.logger)
[2015-08-12 11:16:52,737] TRACE Controller 1 epoch 12 elected leader 1 for Offline partition [t7,0] (state.change.logger)
[2015-08-12 11:16:52,738] TRACE Controller 1 epoch 12 changed partition [t7,0] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2015-08-12 11:16:52,739] TRACE Controller 1 epoch 12 started leader election for partition [t3,0] (state.change.logger)
[2015-08-12 11:16:52,746] ERROR Controller 1 epoch 12 initiated state change for partition [t3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-12 11:16:52,747] TRACE Controller 1 epoch 12 started leader election for partition [t6,0] (state.change.logger)
[2015-08-12 11:16:52,755] TRACE Controller 1 epoch 12 elected leader 1 for Offline partition [t6,0] (state.change.logger)
[2015-08-12 11:16:52,756] TRACE Controller 1 epoch 12 changed partition [t6,0] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2015-08-12 11:16:52,756] TRACE Controller 1 epoch 12 started leader election for partition [t4,0] (state.change.logger)
[2015-08-12 11:16:52,765] TRACE Controller 1 epoch 12 elected leader 1 for Offline partition [t4,0] (state.change.logger)
[2015-08-12 11:16:52,766] TRACE Controller 1 epoch 12 changed partition [t4,0] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2015-08-12 11:16:52,766] TRACE Controller 1 epoch 12 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12) with correlationId 5 to broker 1 for partition [t7,0] (state.change.logger)
[2015-08-12 11:16:52,766] TRACE Controller 1 epoch 12 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12) with correlationId 5 to broker 1 for partition [t2,0] (state.change.logger)
[2015-08-12 11:16:52,766] TRACE Controller 1 epoch 12 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12) with correlationId 5 to broker 1 for partition [t6,0] (state.change.logger)
[2015-08-12 11:16:52,767] TRACE Controller 1 epoch 12 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12) with correlationId 5 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-12 11:16:52,767] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12) with correlationId 5 to broker 1 for partition [t7,0] (state.change.logger)
[2015-08-12 11:16:52,767] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12) with correlationId 5 to broker 1 for partition [t2,0] (state.change.logger)
[2015-08-12 11:16:52,767] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12) with correlationId 5 to broker 1 for partition [t6,0] (state.change.logger)
[2015-08-12 11:16:52,767] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12) with correlationId 5 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-12 11:16:52,771] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) correlation id 4 from controller 1 epoch 12 for partition [t2,0] (state.change.logger)
[2015-08-12 11:16:52,771] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) correlation id 4 from controller 1 epoch 12 for partition [t7,0] (state.change.logger)
[2015-08-12 11:16:52,771] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) correlation id 4 from controller 1 epoch 12 for partition [t6,0] (state.change.logger)
[2015-08-12 11:16:52,771] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) correlation id 4 from controller 1 epoch 12 for partition [t4,0] (state.change.logger)
[2015-08-12 11:16:52,778] TRACE Broker 1 handling LeaderAndIsr request correlationId 4 from controller 1 epoch 12 starting the become-leader transition for partition [t6,0] (state.change.logger)
[2015-08-12 11:16:52,778] TRACE Broker 1 handling LeaderAndIsr request correlationId 4 from controller 1 epoch 12 starting the become-leader transition for partition [t2,0] (state.change.logger)
[2015-08-12 11:16:52,778] TRACE Broker 1 handling LeaderAndIsr request correlationId 4 from controller 1 epoch 12 starting the become-leader transition for partition [t7,0] (state.change.logger)
[2015-08-12 11:16:52,779] TRACE Broker 1 handling LeaderAndIsr request correlationId 4 from controller 1 epoch 12 starting the become-leader transition for partition [t4,0] (state.change.logger)
[2015-08-12 11:16:52,783] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 1 epoch 12 with correlation id 4 for partition [t6,0] (state.change.logger)
[2015-08-12 11:16:52,783] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 1 epoch 12 with correlation id 4 for partition [t2,0] (state.change.logger)
[2015-08-12 11:16:52,783] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 1 epoch 12 with correlation id 4 for partition [t7,0] (state.change.logger)
[2015-08-12 11:16:52,783] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 1 epoch 12 with correlation id 4 for partition [t4,0] (state.change.logger)
[2015-08-12 11:16:52,806] TRACE Broker 1 completed LeaderAndIsr request correlationId 4 from controller 1 epoch 12 for the become-leader transition for partition [t6,0] (state.change.logger)
[2015-08-12 11:16:52,806] TRACE Broker 1 completed LeaderAndIsr request correlationId 4 from controller 1 epoch 12 for the become-leader transition for partition [t2,0] (state.change.logger)
[2015-08-12 11:16:52,806] TRACE Broker 1 completed LeaderAndIsr request correlationId 4 from controller 1 epoch 12 for the become-leader transition for partition [t7,0] (state.change.logger)
[2015-08-12 11:16:52,806] TRACE Broker 1 completed LeaderAndIsr request correlationId 4 from controller 1 epoch 12 for the become-leader transition for partition [t4,0] (state.change.logger)
[2015-08-12 11:16:52,810] TRACE Controller 1 epoch 12 received response LeaderAndIsrResponse(4,Map((t2,0) -> 0, (t7,0) -> 0, (t6,0) -> 0, (t4,0) -> 0),0) for a request sent to broker id:1,host:fufuka,port:9092 (state.change.logger)
[2015-08-12 11:16:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition [t2,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 4 (state.change.logger)
[2015-08-12 11:16:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition [t7,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 4 (state.change.logger)
[2015-08-12 11:16:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition [t6,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 4 (state.change.logger)
[2015-08-12 11:16:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11),ReplicationFactor:1),AllReplicas:1) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 4 (state.change.logger)
[2015-08-12 11:16:52,813] TRACE Controller 1 epoch 12 received response UpdateMetadataResponse(4,0) for a request sent to broker id:1,host:fufuka,port:9092 (state.change.logger)
[2015-08-12 11:16:52,814] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:1) correlation id 5 from controller 1 epoch 12 for partition [t2,0] (state.change.logger)
[2015-08-12 11:16:52,814] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:1) correlation id 5 from controller 1 epoch 12 for partition [t7,0] (state.change.logger)
[2015-08-12 11:16:52,814] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:1) correlation id 5 from controller 1 epoch 12 for partition [t6,0] (state.change.logger)
[2015-08-12 11:16:52,814] TRACE Broker 1 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:1) correlation id 5 from controller 1 epoch 12 for partition [t4,0] (state.change.logger)
[2015-08-12 11:16:52,814] TRACE Broker 1 handling LeaderAndIsr request correlationId 5 from controller 1 epoch 12 starting the become-leader transition for partition [t6,0] (state.change.logger)
[2015-08-12 11:16:52,815] TRACE Broker 1 handling LeaderAndIsr request correlationId 5 from controller 1 epoch 12 starting the become-leader transition for partition [t2,0] (state.change.logger)
[2015-08-12 11:16:52,815] TRACE Broker 1 handling LeaderAndIsr request correlationId 5 from controller 1 epoch 12 starting the become-leader transition for partition [t7,0] (state.change.logger)
[2015-08-12 11:16:52,815] TRACE Broker 1 handling LeaderAndIsr request correlationId 5 from controller 1 epoch 12 starting the become-leader transition for partition [t4,0] (state.change.logger)
[2015-08-12 11:16:52,815] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 1 epoch 12 with correlation id 5 for partition [t6,0] (state.change.logger)
[2015-08-12 11:16:52,816] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 1 epoch 12 with correlation id 5 for partition [t2,0] (state.change.logger)
[2015-08-12 11:16:52,816] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 1 epoch 12 with correlation id 5 for partition [t7,0] (state.change.logger)
[2015-08-12 11:16:52,816] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 1 epoch 12 with correlation id 5 for partition [t4,0] (state.change.logger)
[2015-08-12 11:16:52,817] TRACE Broker 1 completed LeaderAndIsr request correlationId 5 from controller 1 epoch 12 for the become-leader transition for partition [t6,0] (state.change.logger)
[2015-08-12 11:16:52,817] TRACE Broker 1 completed LeaderAndIsr request correlationId 5 from controller 1 epoch 12 for the become-leader transition for partition [t2,0] (state.change.logger)
[2015-08-12 11:16:52,817] TRACE Broker 1 completed LeaderAndIsr request correlationId 5 from controller 1 epoch 12 for the become-leader transition for partition [t7,0] (state.change.logger)
[2015-08-12 11:16:52,817] TRACE Broker 1 completed LeaderAndIsr request correlationId 5 from controller 1 epoch 12 for the become-leader transition for partition [t4,0] (state.change.logger)
[2015-08-12 11:16:52,818] TRACE Controller 1 epoch 12 received response LeaderAndIsrResponse(5,Map((t2,0) -> 0, (t7,0) -> 0, (t6,0) -> 0, (t4,0) -> 0),0) for a request sent to broker id:1,host:fufuka,port:9092 (state.change.logger)
[2015-08-12 11:16:52,820] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:1) for partition [t2,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 5 (state.change.logger)
[2015-08-12 11:16:52,820] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:1) for partition [t7,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 5 (state.change.logger)
[2015-08-12 11:16:52,820] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:1) for partition [t6,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 5 (state.change.logger)
[2015-08-12 11:16:52,820] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:1) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 5 (state.change.logger)
[2015-08-12 11:16:52,821] TRACE Controller 1 epoch 12 received response UpdateMetadataResponse(5,0) for a request sent to broker id:1,host:fufuka,port:9092 (state.change.logger)
[2015-08-12 11:16:57,331] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9) with correlationId 6 to broker 2 for partition [t3,0] (state.change.logger)
[2015-08-12 11:16:57,332] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12) with correlationId 6 to broker 2 for partition [t7,0] (state.change.logger)
[2015-08-12 11:16:57,332] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9) with correlationId 6 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-12 11:16:57,332] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12) with correlationId 6 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-12 11:16:57,332] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12) with correlationId 6 to broker 2 for partition [t6,0] (state.change.logger)
[2015-08-12 11:16:57,332] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12) with correlationId 6 to broker 2 for partition [t2,0] (state.change.logger)
[2015-08-12 11:16:57,333] TRACE Controller 1 epoch 12 changed state of replica 2 for partition [t1,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-12 11:16:57,333] TRACE Controller 1 epoch 12 changed state of replica 2 for partition [t3,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-12 11:16:57,333] TRACE Controller 1 epoch 12 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9) with correlationId 7 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-12 11:16:57,334] TRACE Controller 1 epoch 12 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9) with correlationId 7 to broker 2 for partition [t3,0] (state.change.logger)
[2015-08-12 11:16:57,334] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9) with correlationId 7 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-12 11:16:57,334] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9) with correlationId 7 to broker 2 for partition [t3,0] (state.change.logger)
[2015-08-12 11:16:57,334] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9) with correlationId 7 to broker 1 for partition [t1,0] (state.change.logger)
[2015-08-12 11:16:57,334] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9) with correlationId 7 to broker 1 for partition [t3,0] (state.change.logger)
[2015-08-12 11:16:57,334] TRACE Controller 1 epoch 12 started leader election for partition [t1,0] (state.change.logger)
[2015-08-12 11:16:57,337] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 7 (state.change.logger)
[2015-08-12 11:16:57,337] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) for partition [t3,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 7 (state.change.logger)
[2015-08-12 11:16:57,343] TRACE Controller 1 epoch 12 received response UpdateMetadataResponse(7,0) for a request sent to broker id:1,host:fufuka,port:9092 (state.change.logger)
[2015-08-12 11:16:57,349] TRACE Controller 1 epoch 12 elected leader 2 for Offline partition [t1,0] (state.change.logger)
[2015-08-12 11:16:57,350] TRACE Controller 1 epoch 12 changed partition [t1,0] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2015-08-12 11:16:57,350] TRACE Controller 1 epoch 12 started leader election for partition [t3,0] (state.change.logger)
[2015-08-12 11:16:57,367] TRACE Controller 1 epoch 12 elected leader 2 for Offline partition [t3,0] (state.change.logger)
[2015-08-12 11:16:57,368] TRACE Controller 1 epoch 12 changed partition [t3,0] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2015-08-12 11:16:57,368] TRACE Controller 1 epoch 12 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12) with correlationId 8 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-12 11:16:57,368] TRACE Controller 1 epoch 12 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12) with correlationId 8 to broker 2 for partition [t3,0] (state.change.logger)
[2015-08-12 11:16:57,368] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12) with correlationId 8 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-12 11:16:57,369] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12) with correlationId 8 to broker 2 for partition [t3,0] (state.change.logger)
[2015-08-12 11:16:57,369] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12) with correlationId 8 to broker 1 for partition [t1,0] (state.change.logger)
[2015-08-12 11:16:57,369] TRACE Controller 1 epoch 12 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12) with correlationId 8 to broker 1 for partition [t3,0] (state.change.logger)
[2015-08-12 11:16:57,371] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 8 (state.change.logger)
[2015-08-12 11:16:57,371] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:2) for partition [t3,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 8 (state.change.logger)
[2015-08-12 11:16:57,372] TRACE Controller 1 epoch 12 received response UpdateMetadataResponse(8,0) for a request sent to broker id:1,host:fufuka,port:9092 (state.change.logger)
[2015-08-12 11:16:57,386] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) for partition [t3,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 6 (state.change.logger)
[2015-08-12 11:16:57,386] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:1) for partition [t7,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 6 (state.change.logger)
[2015-08-12 11:16:57,387] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 6 (state.change.logger)
[2015-08-12 11:16:57,387] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:1) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 6 (state.change.logger)
[2015-08-12 11:16:57,388] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:1) for partition [t6,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 6 (state.change.logger)
[2015-08-12 11:16:57,388] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:1) for partition [t2,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 6 (state.change.logger)
[2015-08-12 11:16:57,408] TRACE Controller 1 epoch 12 received response UpdateMetadataResponse(6,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-12 11:16:57,466] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) correlation id 7 from controller 1 epoch 12 for partition [t1,0] (state.change.logger)
[2015-08-12 11:16:57,466] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) correlation id 7 from controller 1 epoch 12 for partition [t3,0] (state.change.logger)
[2015-08-12 11:16:57,475] TRACE Broker 2 handling LeaderAndIsr request correlationId 7 from controller 1 epoch 12 starting the become-leader transition for partition [t1,0] (state.change.logger)
[2015-08-12 11:16:57,475] TRACE Broker 2 handling LeaderAndIsr request correlationId 7 from controller 1 epoch 12 starting the become-leader transition for partition [t3,0] (state.change.logger)
[2015-08-12 11:16:57,478] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 12 with correlation id 7 for partition [t1,0] (state.change.logger)
[2015-08-12 11:16:57,479] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 12 with correlation id 7 for partition [t3,0] (state.change.logger)
[2015-08-12 11:16:57,505] TRACE Broker 2 completed LeaderAndIsr request correlationId 7 from controller 1 epoch 12 for the become-leader transition for partition [t1,0] (state.change.logger)
[2015-08-12 11:16:57,505] TRACE Broker 2 completed LeaderAndIsr request correlationId 7 from controller 1 epoch 12 for the become-leader transition for partition [t3,0] (state.change.logger)
[2015-08-12 11:16:57,511] TRACE Controller 1 epoch 12 received response LeaderAndIsrResponse(7,Map((t1,0) -> 0, (t3,0) -> 0),0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-12 11:16:57,513] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 7 (state.change.logger)
[2015-08-12 11:16:57,513] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) for partition [t3,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 7 (state.change.logger)
[2015-08-12 11:16:57,514] TRACE Controller 1 epoch 12 received response UpdateMetadataResponse(7,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-12 11:16:57,515] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:2) correlation id 8 from controller 1 epoch 12 for partition [t1,0] (state.change.logger)
[2015-08-12 11:16:57,515] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:2) correlation id 8 from controller 1 epoch 12 for partition [t3,0] (state.change.logger)
[2015-08-12 11:16:57,515] TRACE Broker 2 handling LeaderAndIsr request correlationId 8 from controller 1 epoch 12 starting the become-leader transition for partition [t1,0] (state.change.logger)
[2015-08-12 11:16:57,516] TRACE Broker 2 handling LeaderAndIsr request correlationId 8 from controller 1 epoch 12 starting the become-leader transition for partition [t3,0] (state.change.logger)
[2015-08-12 11:16:57,516] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 12 with correlation id 8 for partition [t1,0] (state.change.logger)
[2015-08-12 11:16:57,516] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 12 with correlation id 8 for partition [t3,0] (state.change.logger)
[2015-08-12 11:16:57,517] TRACE Broker 2 completed LeaderAndIsr request correlationId 8 from controller 1 epoch 12 for the become-leader transition for partition [t1,0] (state.change.logger)
[2015-08-12 11:16:57,517] TRACE Broker 2 completed LeaderAndIsr request correlationId 8 from controller 1 epoch 12 for the become-leader transition for partition [t3,0] (state.change.logger)
[2015-08-12 11:16:57,518] TRACE Controller 1 epoch 12 received response LeaderAndIsrResponse(8,Map((t1,0) -> 0, (t3,0) -> 0),0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-12 11:16:57,520] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 8 (state.change.logger)
[2015-08-12 11:16:57,520] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:2) for partition [t3,0] in response to UpdateMetadata request sent by controller 1 epoch 12 with correlation id 8 (state.change.logger)
[2015-08-12 11:16:57,521] TRACE Controller 1 epoch 12 received response UpdateMetadataResponse(8,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-12 11:54:30,476] TRACE Controller 2 epoch 13 changed state of replica 2 for partition [t1,0] from OnlineReplica to OnlineReplica (state.change.logger)
[2015-08-12 11:54:30,476] TRACE Controller 2 epoch 13 changed state of replica 2 for partition [t3,0] from OnlineReplica to OnlineReplica (state.change.logger)
[2015-08-12 11:54:30,478] TRACE Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12) with correlationId 0 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-12 11:54:30,478] TRACE Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12) with correlationId 0 to broker 2 for partition [t3,0] (state.change.logger)
[2015-08-12 11:54:30,486] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:2) correlation id 0 from controller 2 epoch 13 for partition [t1,0] (state.change.logger)
[2015-08-12 11:54:30,486] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:2) correlation id 0 from controller 2 epoch 13 for partition [t3,0] (state.change.logger)
[2015-08-12 11:54:30,487] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 13 for partition [t1,0] since its associated leader epoch 6 is old. Current leader epoch is 6 (state.change.logger)
[2015-08-12 11:54:30,487] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 13 for partition [t3,0] since its associated leader epoch 6 is old. Current leader epoch is 6 (state.change.logger)
[2015-08-12 11:54:30,490] TRACE Controller 2 epoch 13 received response LeaderAndIsrResponse(0,Map((t1,0) -> 13, (t3,0) -> 13),0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-12 11:54:30,492] TRACE Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12) with correlationId 0 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-12 11:54:30,492] TRACE Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12) with correlationId 0 to broker 2 for partition [t3,0] (state.change.logger)
[2015-08-12 11:54:30,495] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 0 (state.change.logger)
[2015-08-12 11:54:30,495] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:2) for partition [t3,0] in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 0 (state.change.logger)
[2015-08-12 11:54:30,495] TRACE Controller 2 epoch 13 received response UpdateMetadataResponse(0,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-12 11:54:30,497] TRACE Controller 2 epoch 13 started leader election for partition [t2,0] (state.change.logger)
[2015-08-12 11:54:30,506] ERROR Controller 2 epoch 13 initiated state change for partition [t2,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:139)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:134)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:549)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-12 11:54:30,507] TRACE Controller 2 epoch 13 started leader election for partition [t7,0] (state.change.logger)
[2015-08-12 11:54:30,513] ERROR Controller 2 epoch 13 initiated state change for partition [t7,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t7,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:139)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:134)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:549)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-12 11:54:30,514] TRACE Controller 2 epoch 13 started leader election for partition [t6,0] (state.change.logger)
[2015-08-12 11:54:30,520] ERROR Controller 2 epoch 13 initiated state change for partition [t6,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t6,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:139)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:134)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:549)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-12 11:54:30,521] TRACE Controller 2 epoch 13 started leader election for partition [t4,0] (state.change.logger)
[2015-08-12 11:54:30,527] ERROR Controller 2 epoch 13 initiated state change for partition [t4,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t4,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:139)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:134)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:549)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-12 11:54:30,541] TRACE Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12) with correlationId 3 to broker 2 for partition [t3,0] (state.change.logger)
[2015-08-12 11:54:30,541] TRACE Controller 2 epoch 13 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12) with correlationId 3 to broker 2 for partition [t7,0] (state.change.logger)
[2015-08-12 11:54:30,541] TRACE Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12) with correlationId 3 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-12 11:54:30,541] TRACE Controller 2 epoch 13 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12) with correlationId 3 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-12 11:54:30,541] TRACE Controller 2 epoch 13 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12) with correlationId 3 to broker 2 for partition [t6,0] (state.change.logger)
[2015-08-12 11:54:30,541] TRACE Controller 2 epoch 13 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12) with correlationId 3 to broker 2 for partition [t2,0] (state.change.logger)
[2015-08-12 11:54:30,542] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:2) for partition [t3,0] in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 3 (state.change.logger)
[2015-08-12 11:54:30,542] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:1) for partition [t7,0] in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 3 (state.change.logger)
[2015-08-12 11:54:30,542] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 3 (state.change.logger)
[2015-08-12 11:54:30,542] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:1) for partition [t4,0] in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 3 (state.change.logger)
[2015-08-12 11:54:30,543] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:1) for partition [t6,0] in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 3 (state.change.logger)
[2015-08-12 11:54:30,543] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:1) for partition [t2,0] in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 3 (state.change.logger)
[2015-08-12 11:54:30,543] TRACE Controller 2 epoch 13 received response UpdateMetadataResponse(3,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-12 11:54:39,036] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
