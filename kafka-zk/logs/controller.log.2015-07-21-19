[2015-07-21 19:00:44,149] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-07-21 19:00:44,151] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([t1,2] -> List(0), [t1,0] -> List(0), [t1,1] -> List(0))) (kafka.controller.KafkaController)
[2015-07-21 19:00:44,151] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-07-21 19:00:44,151] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-07-21 19:05:44,147] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-07-21 19:05:44,148] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([t1,2] -> List(0), [t1,0] -> List(0), [t1,1] -> List(0))) (kafka.controller.KafkaController)
[2015-07-21 19:05:44,148] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-07-21 19:05:44,148] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-07-21 19:06:29,037] INFO [Controller 0]: Shutting down broker 0 (kafka.controller.KafkaController)
[2015-07-21 19:06:29,038] DEBUG [Controller 0]: All shutting down brokers: 0 (kafka.controller.KafkaController)
[2015-07-21 19:06:29,039] DEBUG [Controller 0]: Live brokers:  (kafka.controller.KafkaController)
[2015-07-21 19:06:29,041] TRACE [Controller 0]: All leaders = [t1,2] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111),[t1,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111),[t1,1] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111) (kafka.controller.KafkaController)
[2015-07-21 19:06:36,502] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-07-21 19:06:38,228] INFO [Controller 3]: Controller starting up (kafka.controller.KafkaController)
[2015-07-21 19:06:38,238] INFO [Controller 2]: Controller starting up (kafka.controller.KafkaController)
[2015-07-21 19:06:38,271] INFO [Controller 2]: Controller startup complete (kafka.controller.KafkaController)
[2015-07-21 19:06:38,282] INFO [Controller 3]: Controller startup complete (kafka.controller.KafkaController)
[2015-07-21 19:06:38,478] INFO [Controller 1]: Controller starting up (kafka.controller.KafkaController)
[2015-07-21 19:06:38,496] INFO [Controller 1]: Controller startup complete (kafka.controller.KafkaController)
[2015-07-21 19:06:45,030] INFO [Controller 2]: Broker 2 starting become controller state transition (kafka.controller.KafkaController)
[2015-07-21 19:06:45,039] INFO [Controller 2]: Initialized controller epoch to 115 and zk version 114 (kafka.controller.KafkaController)
[2015-07-21 19:06:45,050] INFO [Controller 2]: Controller 2 incremented epoch to 116 (kafka.controller.KafkaController)
[2015-07-21 19:06:45,168] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2015-07-21 19:06:45,174] INFO [Controller-2-to-broker-1-send-thread], Controller 2 connected to id:1,host:10.15.104.47,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-07-21 19:06:45,175] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2015-07-21 19:06:45,176] INFO [Controller-2-to-broker-2-send-thread], Controller 2 connected to id:2,host:10.15.104.47,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-07-21 19:06:45,176] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2015-07-21 19:06:45,177] INFO [Controller-2-to-broker-3-send-thread], Controller 2 connected to id:3,host:10.15.104.47,port:9094 for sending state change requests (kafka.controller.RequestSendThread)
[2015-07-21 19:06:45,178] INFO [Controller-2-to-broker-2-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-07-21 19:06:45,180] INFO [Controller-2-to-broker-1-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-07-21 19:06:45,180] INFO [Controller-2-to-broker-3-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-07-21 19:06:45,183] INFO [Controller 2]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-07-21 19:06:45,184] INFO [Controller 2]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-07-21 19:06:45,184] INFO [Controller 2]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-07-21 19:06:45,190] INFO [Controller 2]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-07-21 19:06:45,191] INFO [Controller 2]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-07-21 19:06:45,192] INFO [Controller 2]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-07-21 19:06:45,199] INFO [Controller 2]: List of topics to be deleted: t2,t3 (kafka.controller.KafkaController)
[2015-07-21 19:06:45,199] INFO [Controller 2]: List of topics ineligible for deletion: t1 (kafka.controller.KafkaController)
[2015-07-21 19:06:45,210] INFO [Controller 2]: Currently active brokers in the cluster: Set(1, 2, 3) (kafka.controller.KafkaController)
[2015-07-21 19:06:45,219] INFO [Controller 2]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-07-21 19:06:45,219] INFO [Controller 2]: Current list of topics in the cluster: Set(t1) (kafka.controller.KafkaController)
[2015-07-21 19:06:45,227] INFO [Replica state machine on controller 2]: Started replica state machine with initial state -> Map([Topic=t1,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=t1,Partition=2,Replica=0] -> ReplicaDeletionIneligible, [Topic=t1,Partition=1,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:06:45,248] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-07-21 19:06:45,265] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-07-21 19:06:45,275] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-07-21 19:06:45,283] INFO [Partition state machine on Controller 2]: Started partition state machine with initial state -> Map([t1,2] -> OfflinePartition, [t1,0] -> OfflinePartition, [t1,1] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:06:45,288] INFO [Controller 2]: Broker 2 is ready to serve as the new controller with epoch 116 (kafka.controller.KafkaController)
[2015-07-21 19:06:45,290] INFO [Controller 2]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-07-21 19:06:45,293] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-07-21 19:06:45,324] INFO [Controller 2]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-07-21 19:06:45,488] INFO [delete-topics-thread-2], Starting  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-07-21 19:06:45,490] INFO [delete-topics-thread-2], Handling deletion for topics t2,t3 (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-07-21 19:06:45,492] DEBUG [Replica state machine on controller 2]: Are all replicas for topic t2 deleted Map() (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:06:45,494] ERROR [delete-topics-thread-2], Error due to  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
java.util.NoSuchElementException: key not found: t2
	at scala.collection.MapLike$class.default(MapLike.scala:228)
	at scala.collection.AbstractMap.default(Map.scala:59)
	at scala.collection.mutable.HashMap.apply(HashMap.scala:65)
	at kafka.controller.PartitionStateMachine.deregisterPartitionChangeListener(PartitionStateMachine.scala:399)
	at kafka.controller.TopicDeletionManager.kafka$controller$TopicDeletionManager$$completeDeleteTopic(TopicDeletionManager.scala:276)
	at kafka.controller.TopicDeletionManager$DeleteTopicsThread$$anonfun$doWork$1$$anonfun$apply$mcV$sp$4.apply(TopicDeletionManager.scala:400)
	at kafka.controller.TopicDeletionManager$DeleteTopicsThread$$anonfun$doWork$1$$anonfun$apply$mcV$sp$4.apply(TopicDeletionManager.scala:396)
	at scala.collection.immutable.Set$Set2.foreach(Set.scala:111)
	at kafka.controller.TopicDeletionManager$DeleteTopicsThread$$anonfun$doWork$1.apply$mcV$sp(TopicDeletionManager.scala:396)
	at kafka.controller.TopicDeletionManager$DeleteTopicsThread$$anonfun$doWork$1.apply(TopicDeletionManager.scala:390)
	at kafka.controller.TopicDeletionManager$DeleteTopicsThread$$anonfun$doWork$1.apply(TopicDeletionManager.scala:390)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.TopicDeletionManager$DeleteTopicsThread.doWork(TopicDeletionManager.scala:390)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-07-21 19:06:45,494] INFO [delete-topics-thread-2], Stopped  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-07-21 19:06:50,488] TRACE [Controller 2]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-07-21 19:06:50,492] DEBUG [Controller 2]: preferred replicas by broker Map(0 -> Map([t1,2] -> List(0), [t1,0] -> List(0), [t1,1] -> List(0))) (kafka.controller.KafkaController)
[2015-07-21 19:06:50,493] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-07-21 19:06:50,494] TRACE [Controller 2]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-07-21 19:07:12,433] INFO [Controller 2]: Shutting down broker 3 (kafka.controller.KafkaController)
[2015-07-21 19:07:12,434] DEBUG [Controller 2]: All shutting down brokers: 3 (kafka.controller.KafkaController)
[2015-07-21 19:07:12,435] DEBUG [Controller 2]: Live brokers: 1,2 (kafka.controller.KafkaController)
[2015-07-21 19:07:12,442] TRACE [Controller 2]: All leaders = [t1,2] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111),[t1,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111),[t1,1] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111) (kafka.controller.KafkaController)
[2015-07-21 19:07:12,443] INFO [Controller 2]: Shutting down broker 1 (kafka.controller.KafkaController)
[2015-07-21 19:07:12,444] DEBUG [Controller 2]: All shutting down brokers: 1,3 (kafka.controller.KafkaController)
[2015-07-21 19:07:12,444] DEBUG [Controller 2]: Live brokers: 2 (kafka.controller.KafkaController)
[2015-07-21 19:07:12,446] TRACE [Controller 2]: All leaders = [t1,2] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111),[t1,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111),[t1,1] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111) (kafka.controller.KafkaController)
[2015-07-21 19:07:12,451] INFO [Controller 2]: Shutting down broker 2 (kafka.controller.KafkaController)
[2015-07-21 19:07:12,451] DEBUG [Controller 2]: All shutting down brokers: 1,2,3 (kafka.controller.KafkaController)
[2015-07-21 19:07:12,451] DEBUG [Controller 2]: Live brokers:  (kafka.controller.KafkaController)
[2015-07-21 19:07:12,451] TRACE [Controller 2]: All leaders = [t1,2] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111),[t1,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111),[t1,1] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111) (kafka.controller.KafkaController)
[2015-07-21 19:07:40,079] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-07-21 19:07:41,914] INFO [Controller 2]: Controller starting up (kafka.controller.KafkaController)
[2015-07-21 19:07:41,917] INFO [Controller 1]: Controller starting up (kafka.controller.KafkaController)
[2015-07-21 19:07:41,942] INFO [Controller 2]: Controller startup complete (kafka.controller.KafkaController)
[2015-07-21 19:07:41,945] INFO [Controller 1]: Controller startup complete (kafka.controller.KafkaController)
[2015-07-21 19:07:41,975] INFO [Controller 3]: Controller starting up (kafka.controller.KafkaController)
[2015-07-21 19:07:42,013] INFO [Controller 3]: Controller startup complete (kafka.controller.KafkaController)
[2015-07-21 19:07:48,017] INFO [Controller 1]: Broker 1 starting become controller state transition (kafka.controller.KafkaController)
[2015-07-21 19:07:48,034] INFO [Controller 1]: Initialized controller epoch to 116 and zk version 115 (kafka.controller.KafkaController)
[2015-07-21 19:07:48,057] INFO [Controller 1]: Controller 1 incremented epoch to 117 (kafka.controller.KafkaController)
[2015-07-21 19:07:48,132] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2015-07-21 19:07:48,138] INFO [Controller-1-to-broker-1-send-thread], Controller 1 connected to id:1,host:10.15.104.47,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-07-21 19:07:48,140] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2015-07-21 19:07:48,140] INFO [Controller-1-to-broker-2-send-thread], Controller 1 connected to id:2,host:10.15.104.47,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-07-21 19:07:48,141] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2015-07-21 19:07:48,145] INFO [Controller-1-to-broker-3-send-thread], Controller 1 connected to id:3,host:10.15.104.47,port:9094 for sending state change requests (kafka.controller.RequestSendThread)
[2015-07-21 19:07:48,146] INFO [Controller-1-to-broker-2-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-07-21 19:07:48,147] INFO [Controller-1-to-broker-1-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-07-21 19:07:48,147] INFO [Controller-1-to-broker-3-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-07-21 19:07:48,149] INFO [Controller 1]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-07-21 19:07:48,149] INFO [Controller 1]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-07-21 19:07:48,150] INFO [Controller 1]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-07-21 19:07:48,154] INFO [Controller 1]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-07-21 19:07:48,154] INFO [Controller 1]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-07-21 19:07:48,155] INFO [Controller 1]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-07-21 19:07:48,160] INFO [Controller 1]: List of topics to be deleted: t2,t3 (kafka.controller.KafkaController)
[2015-07-21 19:07:48,161] INFO [Controller 1]: List of topics ineligible for deletion: t1 (kafka.controller.KafkaController)
[2015-07-21 19:07:48,164] INFO [Controller 1]: Currently active brokers in the cluster: Set(1, 2, 3) (kafka.controller.KafkaController)
[2015-07-21 19:07:48,164] INFO [Controller 1]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-07-21 19:07:48,164] INFO [Controller 1]: Current list of topics in the cluster: Set(t1) (kafka.controller.KafkaController)
[2015-07-21 19:07:48,170] INFO [Replica state machine on controller 1]: Started replica state machine with initial state -> Map([Topic=t1,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=t1,Partition=2,Replica=0] -> ReplicaDeletionIneligible, [Topic=t1,Partition=1,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:07:48,184] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-07-21 19:07:48,200] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-07-21 19:07:48,210] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-07-21 19:07:48,214] INFO [Partition state machine on Controller 1]: Started partition state machine with initial state -> Map([t1,2] -> OfflinePartition, [t1,0] -> OfflinePartition, [t1,1] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:07:48,218] INFO [Controller 1]: Broker 1 is ready to serve as the new controller with epoch 117 (kafka.controller.KafkaController)
[2015-07-21 19:07:48,220] INFO [Controller 1]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-07-21 19:07:48,255] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-07-21 19:07:48,285] INFO [Controller 1]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-07-21 19:07:48,291] INFO [delete-topics-thread-1], Starting  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-07-21 19:07:48,294] INFO [delete-topics-thread-1], Handling deletion for topics t2,t3 (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-07-21 19:07:48,296] DEBUG [Replica state machine on controller 1]: Are all replicas for topic t2 deleted Map() (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:07:48,298] ERROR [delete-topics-thread-1], Error due to  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
java.util.NoSuchElementException: key not found: t2
	at scala.collection.MapLike$class.default(MapLike.scala:228)
	at scala.collection.AbstractMap.default(Map.scala:59)
	at scala.collection.mutable.HashMap.apply(HashMap.scala:65)
	at kafka.controller.PartitionStateMachine.deregisterPartitionChangeListener(PartitionStateMachine.scala:399)
	at kafka.controller.TopicDeletionManager.kafka$controller$TopicDeletionManager$$completeDeleteTopic(TopicDeletionManager.scala:276)
	at kafka.controller.TopicDeletionManager$DeleteTopicsThread$$anonfun$doWork$1$$anonfun$apply$mcV$sp$4.apply(TopicDeletionManager.scala:400)
	at kafka.controller.TopicDeletionManager$DeleteTopicsThread$$anonfun$doWork$1$$anonfun$apply$mcV$sp$4.apply(TopicDeletionManager.scala:396)
	at scala.collection.immutable.Set$Set2.foreach(Set.scala:111)
	at kafka.controller.TopicDeletionManager$DeleteTopicsThread$$anonfun$doWork$1.apply$mcV$sp(TopicDeletionManager.scala:396)
	at kafka.controller.TopicDeletionManager$DeleteTopicsThread$$anonfun$doWork$1.apply(TopicDeletionManager.scala:390)
	at kafka.controller.TopicDeletionManager$DeleteTopicsThread$$anonfun$doWork$1.apply(TopicDeletionManager.scala:390)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.TopicDeletionManager$DeleteTopicsThread.doWork(TopicDeletionManager.scala:390)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-07-21 19:07:48,299] INFO [delete-topics-thread-1], Stopped  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-07-21 19:07:53,295] TRACE [Controller 1]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-07-21 19:07:53,300] DEBUG [Controller 1]: preferred replicas by broker Map(0 -> Map([t1,2] -> List(0), [t1,0] -> List(0), [t1,1] -> List(0))) (kafka.controller.KafkaController)
[2015-07-21 19:07:53,303] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-07-21 19:07:53,304] TRACE [Controller 1]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-07-21 19:09:42,497] DEBUG [TopicChangeListener on Controller 1]: Topic change listener fired for path /brokers/topics with children t1,t2 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2015-07-21 19:09:42,514] INFO [TopicChangeListener on Controller 1]: New topics: [Set(t2)], deleted topics: [Set()], new partition replica assignment [Map([t2,1] -> List(3, 2, 1), [t2,4] -> List(3, 1, 2), [t2,2] -> List(1, 3, 2), [t2,0] -> List(2, 1, 3), [t2,3] -> List(2, 3, 1), [t2,6] -> List(2, 1, 3), [t2,7] -> List(3, 2, 1), [t2,5] -> List(1, 2, 3))] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2015-07-21 19:09:42,515] INFO [Controller 1]: New topic creation callback for [t2,1],[t2,6],[t2,7],[t2,4],[t2,5],[t2,0],[t2,2],[t2,3] (kafka.controller.KafkaController)
[2015-07-21 19:09:42,519] INFO [Controller 1]: New partition creation callback for [t2,1],[t2,6],[t2,7],[t2,4],[t2,5],[t2,0],[t2,2],[t2,3] (kafka.controller.KafkaController)
[2015-07-21 19:09:42,519] INFO [Partition state machine on Controller 1]: Invoking state change to NewPartition for partitions [t2,1],[t2,6],[t2,7],[t2,4],[t2,5],[t2,0],[t2,2],[t2,3] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,617] INFO [Replica state machine on controller 1]: Invoking state change to NewReplica for replicas [Topic=t2,Partition=3,Replica=3],[Topic=t2,Partition=1,Replica=1],[Topic=t2,Partition=5,Replica=3],[Topic=t2,Partition=6,Replica=1],[Topic=t2,Partition=4,Replica=3],[Topic=t2,Partition=2,Replica=2],[Topic=t2,Partition=3,Replica=1],[Topic=t2,Partition=4,Replica=1],[Topic=t2,Partition=2,Replica=3],[Topic=t2,Partition=6,Replica=2],[Topic=t2,Partition=3,Replica=2],[Topic=t2,Partition=0,Replica=1],[Topic=t2,Partition=5,Replica=1],[Topic=t2,Partition=6,Replica=3],[Topic=t2,Partition=1,Replica=2],[Topic=t2,Partition=2,Replica=1],[Topic=t2,Partition=7,Replica=3],[Topic=t2,Partition=1,Replica=3],[Topic=t2,Partition=0,Replica=3],[Topic=t2,Partition=4,Replica=2],[Topic=t2,Partition=7,Replica=2],[Topic=t2,Partition=0,Replica=2],[Topic=t2,Partition=7,Replica=1],[Topic=t2,Partition=5,Replica=2] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:09:42,636] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t2,1],[t2,6],[t2,7],[t2,4],[t2,5],[t2,0],[t2,2],[t2,3] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,637] DEBUG [Partition state machine on Controller 1]: Live assigned replicas for partition [t2,1] are: [List(3, 2, 1)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,638] DEBUG [Partition state machine on Controller 1]: Initializing leader and isr for partition [t2,1] to (Leader:3,ISR:3,2,1,LeaderEpoch:0,ControllerEpoch:117) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,647] DEBUG [Partition state machine on Controller 1]: Live assigned replicas for partition [t2,6] are: [List(2, 1, 3)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,647] DEBUG [Partition state machine on Controller 1]: Initializing leader and isr for partition [t2,6] to (Leader:2,ISR:2,1,3,LeaderEpoch:0,ControllerEpoch:117) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,653] DEBUG [Partition state machine on Controller 1]: Live assigned replicas for partition [t2,7] are: [List(3, 2, 1)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,653] DEBUG [Partition state machine on Controller 1]: Initializing leader and isr for partition [t2,7] to (Leader:3,ISR:3,2,1,LeaderEpoch:0,ControllerEpoch:117) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,658] DEBUG [Partition state machine on Controller 1]: Live assigned replicas for partition [t2,4] are: [List(3, 1, 2)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,658] DEBUG [Partition state machine on Controller 1]: Initializing leader and isr for partition [t2,4] to (Leader:3,ISR:3,1,2,LeaderEpoch:0,ControllerEpoch:117) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,661] DEBUG [Partition state machine on Controller 1]: Live assigned replicas for partition [t2,5] are: [List(1, 2, 3)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,661] DEBUG [Partition state machine on Controller 1]: Initializing leader and isr for partition [t2,5] to (Leader:1,ISR:1,2,3,LeaderEpoch:0,ControllerEpoch:117) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,663] DEBUG [Partition state machine on Controller 1]: Live assigned replicas for partition [t2,0] are: [List(2, 1, 3)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,664] DEBUG [Partition state machine on Controller 1]: Initializing leader and isr for partition [t2,0] to (Leader:2,ISR:2,1,3,LeaderEpoch:0,ControllerEpoch:117) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,666] DEBUG [Partition state machine on Controller 1]: Live assigned replicas for partition [t2,2] are: [List(1, 3, 2)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,666] DEBUG [Partition state machine on Controller 1]: Initializing leader and isr for partition [t2,2] to (Leader:1,ISR:1,3,2,LeaderEpoch:0,ControllerEpoch:117) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,670] DEBUG [Partition state machine on Controller 1]: Live assigned replicas for partition [t2,3] are: [List(2, 3, 1)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,670] DEBUG [Partition state machine on Controller 1]: Initializing leader and isr for partition [t2,3] to (Leader:2,ISR:2,3,1,LeaderEpoch:0,ControllerEpoch:117) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,725] INFO [Replica state machine on controller 1]: Invoking state change to OnlineReplica for replicas [Topic=t2,Partition=3,Replica=3],[Topic=t2,Partition=1,Replica=1],[Topic=t2,Partition=5,Replica=3],[Topic=t2,Partition=6,Replica=1],[Topic=t2,Partition=4,Replica=3],[Topic=t2,Partition=2,Replica=2],[Topic=t2,Partition=3,Replica=1],[Topic=t2,Partition=4,Replica=1],[Topic=t2,Partition=2,Replica=3],[Topic=t2,Partition=6,Replica=2],[Topic=t2,Partition=3,Replica=2],[Topic=t2,Partition=0,Replica=1],[Topic=t2,Partition=5,Replica=1],[Topic=t2,Partition=6,Replica=3],[Topic=t2,Partition=1,Replica=2],[Topic=t2,Partition=2,Replica=1],[Topic=t2,Partition=7,Replica=3],[Topic=t2,Partition=1,Replica=3],[Topic=t2,Partition=0,Replica=3],[Topic=t2,Partition=4,Replica=2],[Topic=t2,Partition=7,Replica=2],[Topic=t2,Partition=0,Replica=2],[Topic=t2,Partition=7,Replica=1],[Topic=t2,Partition=5,Replica=2] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:09:42,754] DEBUG [TopicChangeListener on Controller 1]: Topic change listener fired for path /brokers/topics with children t1,t2,t3 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2015-07-21 19:09:42,794] INFO [TopicChangeListener on Controller 1]: New topics: [Set(t3)], deleted topics: [Set()], new partition replica assignment [Map([t3,6] -> List(3, 1, 2), [t3,5] -> List(2, 1, 3), [t3,1] -> List(1, 2, 3), [t3,4] -> List(1, 3, 2), [t3,3] -> List(3, 2, 1), [t3,2] -> List(2, 3, 1), [t3,7] -> List(1, 2, 3), [t3,0] -> List(3, 1, 2))] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2015-07-21 19:09:42,794] INFO [Controller 1]: New topic creation callback for [t3,0],[t3,1],[t3,2],[t3,4],[t3,5],[t3,7],[t3,6],[t3,3] (kafka.controller.KafkaController)
[2015-07-21 19:09:42,802] INFO [Controller 1]: New partition creation callback for [t3,0],[t3,1],[t3,2],[t3,4],[t3,5],[t3,7],[t3,6],[t3,3] (kafka.controller.KafkaController)
[2015-07-21 19:09:42,803] INFO [Partition state machine on Controller 1]: Invoking state change to NewPartition for partitions [t3,0],[t3,1],[t3,2],[t3,4],[t3,5],[t3,7],[t3,6],[t3,3] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,902] INFO [Replica state machine on controller 1]: Invoking state change to NewReplica for replicas [Topic=t3,Partition=1,Replica=2],[Topic=t3,Partition=3,Replica=3],[Topic=t3,Partition=4,Replica=1],[Topic=t3,Partition=1,Replica=3],[Topic=t3,Partition=2,Replica=3],[Topic=t3,Partition=2,Replica=2],[Topic=t3,Partition=7,Replica=2],[Topic=t3,Partition=3,Replica=1],[Topic=t3,Partition=5,Replica=1],[Topic=t3,Partition=0,Replica=2],[Topic=t3,Partition=6,Replica=3],[Topic=t3,Partition=7,Replica=3],[Topic=t3,Partition=5,Replica=2],[Topic=t3,Partition=2,Replica=1],[Topic=t3,Partition=3,Replica=2],[Topic=t3,Partition=4,Replica=3],[Topic=t3,Partition=4,Replica=2],[Topic=t3,Partition=7,Replica=1],[Topic=t3,Partition=6,Replica=1],[Topic=t3,Partition=0,Replica=3],[Topic=t3,Partition=1,Replica=1],[Topic=t3,Partition=6,Replica=2],[Topic=t3,Partition=0,Replica=1],[Topic=t3,Partition=5,Replica=3] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:09:42,925] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t3,0],[t3,1],[t3,2],[t3,4],[t3,5],[t3,7],[t3,6],[t3,3] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,925] DEBUG [Partition state machine on Controller 1]: Live assigned replicas for partition [t3,0] are: [List(3, 1, 2)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,925] DEBUG [Partition state machine on Controller 1]: Initializing leader and isr for partition [t3,0] to (Leader:3,ISR:3,1,2,LeaderEpoch:0,ControllerEpoch:117) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,950] DEBUG [Partition state machine on Controller 1]: Live assigned replicas for partition [t3,1] are: [List(1, 2, 3)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,951] DEBUG [Partition state machine on Controller 1]: Initializing leader and isr for partition [t3,1] to (Leader:1,ISR:1,2,3,LeaderEpoch:0,ControllerEpoch:117) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,968] DEBUG [Partition state machine on Controller 1]: Live assigned replicas for partition [t3,2] are: [List(2, 3, 1)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,968] DEBUG [Partition state machine on Controller 1]: Initializing leader and isr for partition [t3,2] to (Leader:2,ISR:2,3,1,LeaderEpoch:0,ControllerEpoch:117) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,986] DEBUG [Partition state machine on Controller 1]: Live assigned replicas for partition [t3,4] are: [List(1, 3, 2)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:42,986] DEBUG [Partition state machine on Controller 1]: Initializing leader and isr for partition [t3,4] to (Leader:1,ISR:1,3,2,LeaderEpoch:0,ControllerEpoch:117) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:43,020] DEBUG [Partition state machine on Controller 1]: Live assigned replicas for partition [t3,5] are: [List(2, 1, 3)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:43,020] DEBUG [Partition state machine on Controller 1]: Initializing leader and isr for partition [t3,5] to (Leader:2,ISR:2,1,3,LeaderEpoch:0,ControllerEpoch:117) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:43,052] DEBUG [Partition state machine on Controller 1]: Live assigned replicas for partition [t3,7] are: [List(1, 2, 3)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:43,052] DEBUG [Partition state machine on Controller 1]: Initializing leader and isr for partition [t3,7] to (Leader:1,ISR:1,2,3,LeaderEpoch:0,ControllerEpoch:117) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:43,060] DEBUG [Partition state machine on Controller 1]: Live assigned replicas for partition [t3,6] are: [List(3, 1, 2)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:43,060] DEBUG [Partition state machine on Controller 1]: Initializing leader and isr for partition [t3,6] to (Leader:3,ISR:3,1,2,LeaderEpoch:0,ControllerEpoch:117) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:43,074] DEBUG [Partition state machine on Controller 1]: Live assigned replicas for partition [t3,3] are: [List(3, 2, 1)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:43,074] DEBUG [Partition state machine on Controller 1]: Initializing leader and isr for partition [t3,3] to (Leader:3,ISR:3,2,1,LeaderEpoch:0,ControllerEpoch:117) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:09:43,112] INFO [Replica state machine on controller 1]: Invoking state change to OnlineReplica for replicas [Topic=t3,Partition=1,Replica=2],[Topic=t3,Partition=3,Replica=3],[Topic=t3,Partition=4,Replica=1],[Topic=t3,Partition=1,Replica=3],[Topic=t3,Partition=2,Replica=3],[Topic=t3,Partition=2,Replica=2],[Topic=t3,Partition=7,Replica=2],[Topic=t3,Partition=3,Replica=1],[Topic=t3,Partition=5,Replica=1],[Topic=t3,Partition=0,Replica=2],[Topic=t3,Partition=6,Replica=3],[Topic=t3,Partition=7,Replica=3],[Topic=t3,Partition=5,Replica=2],[Topic=t3,Partition=2,Replica=1],[Topic=t3,Partition=3,Replica=2],[Topic=t3,Partition=4,Replica=3],[Topic=t3,Partition=4,Replica=2],[Topic=t3,Partition=7,Replica=1],[Topic=t3,Partition=6,Replica=1],[Topic=t3,Partition=0,Replica=3],[Topic=t3,Partition=1,Replica=1],[Topic=t3,Partition=6,Replica=2],[Topic=t3,Partition=0,Replica=1],[Topic=t3,Partition=5,Replica=3] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:28,315] INFO [Controller 1]: Shutting down broker 1 (kafka.controller.KafkaController)
[2015-07-21 19:10:28,317] DEBUG [Controller 1]: All shutting down brokers: 1 (kafka.controller.KafkaController)
[2015-07-21 19:10:28,318] DEBUG [Controller 1]: Live brokers: 2,3 (kafka.controller.KafkaController)
[2015-07-21 19:10:28,322] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t3,4] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,327] DEBUG [ControlledShutdownLeaderSelector]: Partition [t3,4] : current leader = 1, new leader = 3 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-07-21 19:10:28,334] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t3,6] -> (Leader:3,ISR:3,1,2,LeaderEpoch:0,ControllerEpoch:117), [t3,5] -> (Leader:2,ISR:2,1,3,LeaderEpoch:0,ControllerEpoch:117), [t2,1] -> (Leader:3,ISR:3,2,1,LeaderEpoch:0,ControllerEpoch:117), [t1,2] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,4] -> (Leader:3,ISR:3,1,2,LeaderEpoch:0,ControllerEpoch:117), [t3,1] -> (Leader:1,ISR:1,2,3,LeaderEpoch:0,ControllerEpoch:117), [t3,4] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t1,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,2] -> (Leader:1,ISR:1,3,2,LeaderEpoch:0,ControllerEpoch:117), [t2,0] -> (Leader:2,ISR:2,1,3,LeaderEpoch:0,ControllerEpoch:117), [t3,3] -> (Leader:3,ISR:3,2,1,LeaderEpoch:0,ControllerEpoch:117), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t3,2] -> (Leader:2,ISR:2,3,1,LeaderEpoch:0,ControllerEpoch:117), [t2,3] -> (Leader:2,ISR:2,3,1,LeaderEpoch:0,ControllerEpoch:117), [t2,6] -> (Leader:2,ISR:2,1,3,LeaderEpoch:0,ControllerEpoch:117), [t2,7] -> (Leader:3,ISR:3,2,1,LeaderEpoch:0,ControllerEpoch:117), [t3,7] -> (Leader:1,ISR:1,2,3,LeaderEpoch:0,ControllerEpoch:117), [t3,0] -> (Leader:3,ISR:3,1,2,LeaderEpoch:0,ControllerEpoch:117), [t2,5] -> (Leader:1,ISR:1,2,3,LeaderEpoch:0,ControllerEpoch:117)) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,335] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t2,2] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,338] DEBUG [ControlledShutdownLeaderSelector]: Partition [t2,2] : current leader = 1, new leader = 3 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-07-21 19:10:28,340] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t3,6] -> (Leader:3,ISR:3,1,2,LeaderEpoch:0,ControllerEpoch:117), [t3,5] -> (Leader:2,ISR:2,1,3,LeaderEpoch:0,ControllerEpoch:117), [t2,1] -> (Leader:3,ISR:3,2,1,LeaderEpoch:0,ControllerEpoch:117), [t1,2] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,4] -> (Leader:3,ISR:3,1,2,LeaderEpoch:0,ControllerEpoch:117), [t3,1] -> (Leader:1,ISR:1,2,3,LeaderEpoch:0,ControllerEpoch:117), [t3,4] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t1,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,2] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t2,0] -> (Leader:2,ISR:2,1,3,LeaderEpoch:0,ControllerEpoch:117), [t3,3] -> (Leader:3,ISR:3,2,1,LeaderEpoch:0,ControllerEpoch:117), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t3,2] -> (Leader:2,ISR:2,3,1,LeaderEpoch:0,ControllerEpoch:117), [t2,3] -> (Leader:2,ISR:2,3,1,LeaderEpoch:0,ControllerEpoch:117), [t2,6] -> (Leader:2,ISR:2,1,3,LeaderEpoch:0,ControllerEpoch:117), [t2,7] -> (Leader:3,ISR:3,2,1,LeaderEpoch:0,ControllerEpoch:117), [t3,7] -> (Leader:1,ISR:1,2,3,LeaderEpoch:0,ControllerEpoch:117), [t3,0] -> (Leader:3,ISR:3,1,2,LeaderEpoch:0,ControllerEpoch:117), [t2,5] -> (Leader:1,ISR:1,2,3,LeaderEpoch:0,ControllerEpoch:117)) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,346] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,347] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=t2,Partition=3,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,349] INFO [Replica state machine on controller 1]: Invoking state change to OfflineReplica for replicas [Topic=t2,Partition=3,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:28,350] DEBUG [Controller 1]: Removing replica 1 from ISR 2,3,1 for partition [t2,3]. (kafka.controller.KafkaController)
[2015-07-21 19:10:28,355] INFO [Controller 1]: New leader and ISR for partition [t2,3] is {"leader":2,"leader_epoch":1,"isr":[2,3]} (kafka.controller.KafkaController)
[2015-07-21 19:10:28,356] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,357] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=t2,Partition=3,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,357] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,357] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=t3,Partition=0,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,357] INFO [Replica state machine on controller 1]: Invoking state change to OfflineReplica for replicas [Topic=t3,Partition=0,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:28,357] DEBUG [Controller 1]: Removing replica 1 from ISR 3,1,2 for partition [t3,0]. (kafka.controller.KafkaController)
[2015-07-21 19:10:28,362] INFO [Controller 1]: New leader and ISR for partition [t3,0] is {"leader":3,"leader_epoch":1,"isr":[3,2]} (kafka.controller.KafkaController)
[2015-07-21 19:10:28,363] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,363] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=t3,Partition=0,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,363] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,363] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=t2,Partition=0,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,363] INFO [Replica state machine on controller 1]: Invoking state change to OfflineReplica for replicas [Topic=t2,Partition=0,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:28,363] DEBUG [Controller 1]: Removing replica 1 from ISR 2,1,3 for partition [t2,0]. (kafka.controller.KafkaController)
[2015-07-21 19:10:28,369] INFO [Controller 1]: New leader and ISR for partition [t2,0] is {"leader":2,"leader_epoch":1,"isr":[2,3]} (kafka.controller.KafkaController)
[2015-07-21 19:10:28,370] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,370] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=t2,Partition=0,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,370] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,370] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=t3,Partition=5,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,370] INFO [Replica state machine on controller 1]: Invoking state change to OfflineReplica for replicas [Topic=t3,Partition=5,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:28,370] DEBUG [Controller 1]: Removing replica 1 from ISR 2,1,3 for partition [t3,5]. (kafka.controller.KafkaController)
[2015-07-21 19:10:28,377] INFO [Controller 1]: New leader and ISR for partition [t3,5] is {"leader":2,"leader_epoch":1,"isr":[2,3]} (kafka.controller.KafkaController)
[2015-07-21 19:10:28,378] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,378] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=t3,Partition=5,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,378] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,378] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=t2,Partition=6,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,378] INFO [Replica state machine on controller 1]: Invoking state change to OfflineReplica for replicas [Topic=t2,Partition=6,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:28,378] DEBUG [Controller 1]: Removing replica 1 from ISR 2,1,3 for partition [t2,6]. (kafka.controller.KafkaController)
[2015-07-21 19:10:28,383] INFO [Controller 1]: New leader and ISR for partition [t2,6] is {"leader":2,"leader_epoch":1,"isr":[2,3]} (kafka.controller.KafkaController)
[2015-07-21 19:10:28,384] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,384] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=t2,Partition=6,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,384] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,385] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=t3,Partition=2,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,385] INFO [Replica state machine on controller 1]: Invoking state change to OfflineReplica for replicas [Topic=t3,Partition=2,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:28,385] DEBUG [Controller 1]: Removing replica 1 from ISR 2,3,1 for partition [t3,2]. (kafka.controller.KafkaController)
[2015-07-21 19:10:28,392] INFO [Controller 1]: New leader and ISR for partition [t3,2] is {"leader":2,"leader_epoch":1,"isr":[2,3]} (kafka.controller.KafkaController)
[2015-07-21 19:10:28,393] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,393] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=t3,Partition=2,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,393] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,393] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=t2,Partition=1,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,393] INFO [Replica state machine on controller 1]: Invoking state change to OfflineReplica for replicas [Topic=t2,Partition=1,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:28,394] DEBUG [Controller 1]: Removing replica 1 from ISR 3,2,1 for partition [t2,1]. (kafka.controller.KafkaController)
[2015-07-21 19:10:28,399] INFO [Controller 1]: New leader and ISR for partition [t2,1] is {"leader":3,"leader_epoch":1,"isr":[3,2]} (kafka.controller.KafkaController)
[2015-07-21 19:10:28,399] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,400] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=t2,Partition=1,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,400] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,400] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=t2,Partition=7,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,400] INFO [Replica state machine on controller 1]: Invoking state change to OfflineReplica for replicas [Topic=t2,Partition=7,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:28,400] DEBUG [Controller 1]: Removing replica 1 from ISR 3,2,1 for partition [t2,7]. (kafka.controller.KafkaController)
[2015-07-21 19:10:28,405] INFO [Controller 1]: New leader and ISR for partition [t2,7] is {"leader":3,"leader_epoch":1,"isr":[3,2]} (kafka.controller.KafkaController)
[2015-07-21 19:10:28,406] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,406] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=t2,Partition=7,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,406] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t2,5] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,411] DEBUG [ControlledShutdownLeaderSelector]: Partition [t2,5] : current leader = 1, new leader = 2 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-07-21 19:10:28,412] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t3,6] -> (Leader:3,ISR:3,1,2,LeaderEpoch:0,ControllerEpoch:117), [t3,5] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t2,1] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t1,2] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,4] -> (Leader:3,ISR:3,1,2,LeaderEpoch:0,ControllerEpoch:117), [t3,1] -> (Leader:1,ISR:1,2,3,LeaderEpoch:0,ControllerEpoch:117), [t3,4] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t1,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,2] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t2,0] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t3,3] -> (Leader:3,ISR:3,2,1,LeaderEpoch:0,ControllerEpoch:117), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t3,2] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t2,3] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t2,6] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t2,7] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t3,7] -> (Leader:1,ISR:1,2,3,LeaderEpoch:0,ControllerEpoch:117), [t3,0] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t2,5] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117)) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,413] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t3,7] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,416] DEBUG [ControlledShutdownLeaderSelector]: Partition [t3,7] : current leader = 1, new leader = 2 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-07-21 19:10:28,418] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t3,6] -> (Leader:3,ISR:3,1,2,LeaderEpoch:0,ControllerEpoch:117), [t3,5] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t2,1] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t1,2] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,4] -> (Leader:3,ISR:3,1,2,LeaderEpoch:0,ControllerEpoch:117), [t3,1] -> (Leader:1,ISR:1,2,3,LeaderEpoch:0,ControllerEpoch:117), [t3,4] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t1,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,2] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t2,0] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t3,3] -> (Leader:3,ISR:3,2,1,LeaderEpoch:0,ControllerEpoch:117), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t3,2] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t2,3] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t2,6] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t2,7] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t3,7] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t3,0] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t2,5] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117)) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,419] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,419] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=t2,Partition=4,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,419] INFO [Replica state machine on controller 1]: Invoking state change to OfflineReplica for replicas [Topic=t2,Partition=4,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:28,419] DEBUG [Controller 1]: Removing replica 1 from ISR 3,1,2 for partition [t2,4]. (kafka.controller.KafkaController)
[2015-07-21 19:10:28,423] INFO [Controller 1]: New leader and ISR for partition [t2,4] is {"leader":3,"leader_epoch":1,"isr":[3,2]} (kafka.controller.KafkaController)
[2015-07-21 19:10:28,424] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,424] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=t2,Partition=4,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,424] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,424] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=t3,Partition=3,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,424] INFO [Replica state machine on controller 1]: Invoking state change to OfflineReplica for replicas [Topic=t3,Partition=3,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:28,424] DEBUG [Controller 1]: Removing replica 1 from ISR 3,2,1 for partition [t3,3]. (kafka.controller.KafkaController)
[2015-07-21 19:10:28,429] INFO [Controller 1]: New leader and ISR for partition [t3,3] is {"leader":3,"leader_epoch":1,"isr":[3,2]} (kafka.controller.KafkaController)
[2015-07-21 19:10:28,430] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,430] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=t3,Partition=3,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,430] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,430] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=t3,Partition=6,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,430] INFO [Replica state machine on controller 1]: Invoking state change to OfflineReplica for replicas [Topic=t3,Partition=6,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:28,430] DEBUG [Controller 1]: Removing replica 1 from ISR 3,1,2 for partition [t3,6]. (kafka.controller.KafkaController)
[2015-07-21 19:10:28,434] INFO [Controller 1]: New leader and ISR for partition [t3,6] is {"leader":3,"leader_epoch":1,"isr":[3,2]} (kafka.controller.KafkaController)
[2015-07-21 19:10:28,436] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,436] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=t3,Partition=6,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,436] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t3,1] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,439] DEBUG [ControlledShutdownLeaderSelector]: Partition [t3,1] : current leader = 1, new leader = 2 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-07-21 19:10:28,440] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t3,6] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t3,5] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t2,1] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t1,2] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,4] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t3,1] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t3,4] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t1,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,2] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t2,0] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t3,3] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t3,2] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t2,3] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t2,6] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t2,7] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t3,7] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t3,0] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t2,5] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117)) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,443] TRACE [Controller 1]: All leaders = [t3,6] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117),[t3,5] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117),[t2,1] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117),[t1,2] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111),[t2,4] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117),[t3,1] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117),[t3,4] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117),[t1,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111),[t2,2] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117),[t2,0] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117),[t3,3] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117),[t1,1] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111),[t3,2] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117),[t2,3] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117),[t2,6] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117),[t3,7] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117),[t2,7] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117),[t3,0] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117),[t2,5] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117) (kafka.controller.KafkaController)
[2015-07-21 19:10:28,445] INFO [Controller 1]: Shutting down broker 3 (kafka.controller.KafkaController)
[2015-07-21 19:10:28,445] DEBUG [Controller 1]: All shutting down brokers: 1,3 (kafka.controller.KafkaController)
[2015-07-21 19:10:28,445] DEBUG [Controller 1]: Live brokers: 2 (kafka.controller.KafkaController)
[2015-07-21 19:10:28,446] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t3,4] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,448] DEBUG [ControlledShutdownLeaderSelector]: Partition [t3,4] : current leader = 3, new leader = 2 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-07-21 19:10:28,451] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t3,6] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t3,5] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t2,1] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t1,2] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,4] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t3,1] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t3,4] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t1,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,2] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t2,0] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t3,3] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t3,2] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t2,3] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t2,6] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t2,7] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t3,7] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t3,0] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t2,5] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117)) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,451] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t2,2] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,454] DEBUG [ControlledShutdownLeaderSelector]: Partition [t2,2] : current leader = 3, new leader = 2 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-07-21 19:10:28,456] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t3,6] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t3,5] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t2,1] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t1,2] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,4] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t3,1] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t3,4] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t1,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,2] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,0] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t3,3] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t3,2] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t2,3] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t2,6] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t2,7] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t3,7] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t3,0] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t2,5] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117)) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,456] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,457] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=t2,Partition=3,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,457] INFO [Replica state machine on controller 1]: Invoking state change to OfflineReplica for replicas [Topic=t2,Partition=3,Replica=3] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:28,457] DEBUG [Controller 1]: Removing replica 3 from ISR 2,3 for partition [t2,3]. (kafka.controller.KafkaController)
[2015-07-21 19:10:28,462] INFO [Controller 1]: New leader and ISR for partition [t2,3] is {"leader":2,"leader_epoch":2,"isr":[2]} (kafka.controller.KafkaController)
[2015-07-21 19:10:28,462] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,462] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=t2,Partition=3,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,463] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t3,0] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,465] WARN [Controller-1-to-broker-1-send-thread], Controller 1 epoch 117 fails to send request Name: StopReplicaRequest; Version: 0; CorrelationId: 24; ClientId: ; DeletePartitions: false; ControllerId: 1; ControllerEpoch: 117; Partitions: [t3,2] to broker id:1,host:10.15.104.47,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.EOFException: Received -1 when reading from channel, socket has likely been closed.
	at kafka.utils.Utils$.read(Utils.scala:381)
	at kafka.network.BoundedByteBufferReceive.readFrom(BoundedByteBufferReceive.scala:54)
	at kafka.network.Receive$class.readCompletely(Transmission.scala:56)
	at kafka.network.BoundedByteBufferReceive.readCompletely(BoundedByteBufferReceive.scala:29)
	at kafka.network.BlockingChannel.receive(BlockingChannel.scala:111)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:133)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-07-21 19:10:28,468] DEBUG [ControlledShutdownLeaderSelector]: Partition [t3,0] : current leader = 3, new leader = 2 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-07-21 19:10:28,470] INFO [Controller-1-to-broker-1-send-thread], Controller 1 connected to id:1,host:10.15.104.47,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-07-21 19:10:28,471] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t3,6] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t3,5] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t2,1] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t1,2] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,4] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t3,1] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t3,4] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t1,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,2] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,0] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t3,3] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t3,2] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t2,3] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,6] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t2,7] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t3,7] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t3,0] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,5] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117)) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,472] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,472] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=t2,Partition=0,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,472] INFO [Replica state machine on controller 1]: Invoking state change to OfflineReplica for replicas [Topic=t2,Partition=0,Replica=3] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:28,472] DEBUG [Controller 1]: Removing replica 3 from ISR 2,3 for partition [t2,0]. (kafka.controller.KafkaController)
[2015-07-21 19:10:28,478] INFO [Controller 1]: New leader and ISR for partition [t2,0] is {"leader":2,"leader_epoch":2,"isr":[2]} (kafka.controller.KafkaController)
[2015-07-21 19:10:28,478] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,478] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=t2,Partition=0,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,479] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,479] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=t3,Partition=5,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,479] INFO [Replica state machine on controller 1]: Invoking state change to OfflineReplica for replicas [Topic=t3,Partition=5,Replica=3] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:28,479] DEBUG [Controller 1]: Removing replica 3 from ISR 2,3 for partition [t3,5]. (kafka.controller.KafkaController)
[2015-07-21 19:10:28,494] INFO [Controller 1]: New leader and ISR for partition [t3,5] is {"leader":2,"leader_epoch":2,"isr":[2]} (kafka.controller.KafkaController)
[2015-07-21 19:10:28,495] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,495] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=t3,Partition=5,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,495] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,495] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=t2,Partition=6,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,495] INFO [Replica state machine on controller 1]: Invoking state change to OfflineReplica for replicas [Topic=t2,Partition=6,Replica=3] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:28,495] DEBUG [Controller 1]: Removing replica 3 from ISR 2,3 for partition [t2,6]. (kafka.controller.KafkaController)
[2015-07-21 19:10:28,499] INFO [Controller 1]: New leader and ISR for partition [t2,6] is {"leader":2,"leader_epoch":2,"isr":[2]} (kafka.controller.KafkaController)
[2015-07-21 19:10:28,500] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,500] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=t2,Partition=6,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,500] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,500] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=t3,Partition=2,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,500] INFO [Replica state machine on controller 1]: Invoking state change to OfflineReplica for replicas [Topic=t3,Partition=2,Replica=3] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:28,500] DEBUG [Controller 1]: Removing replica 3 from ISR 2,3 for partition [t3,2]. (kafka.controller.KafkaController)
[2015-07-21 19:10:28,505] INFO [Controller 1]: New leader and ISR for partition [t3,2] is {"leader":2,"leader_epoch":2,"isr":[2]} (kafka.controller.KafkaController)
[2015-07-21 19:10:28,506] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,506] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=t3,Partition=2,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,506] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t2,1] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,509] DEBUG [ControlledShutdownLeaderSelector]: Partition [t2,1] : current leader = 3, new leader = 2 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-07-21 19:10:28,512] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t3,6] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t3,5] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,1] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t1,2] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,4] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t3,1] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t3,4] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t1,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,2] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,0] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t3,3] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t3,2] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,3] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,6] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,7] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t3,7] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t3,0] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,5] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117)) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,512] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t2,7] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,517] DEBUG [ControlledShutdownLeaderSelector]: Partition [t2,7] : current leader = 3, new leader = 2 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-07-21 19:10:28,519] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t3,6] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t3,5] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,1] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t1,2] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,4] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t3,1] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t3,4] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t1,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,2] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,0] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t3,3] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t3,2] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,3] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,6] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,7] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t3,7] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t3,0] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,5] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117)) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,520] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,520] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=t2,Partition=5,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,520] INFO [Replica state machine on controller 1]: Invoking state change to OfflineReplica for replicas [Topic=t2,Partition=5,Replica=3] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:28,520] DEBUG [Controller 1]: Removing replica 3 from ISR 2,3 for partition [t2,5]. (kafka.controller.KafkaController)
[2015-07-21 19:10:28,524] INFO [Controller 1]: New leader and ISR for partition [t2,5] is {"leader":2,"leader_epoch":2,"isr":[2]} (kafka.controller.KafkaController)
[2015-07-21 19:10:28,525] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,525] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=t2,Partition=5,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,525] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,525] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=t3,Partition=7,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,525] INFO [Replica state machine on controller 1]: Invoking state change to OfflineReplica for replicas [Topic=t3,Partition=7,Replica=3] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:28,525] DEBUG [Controller 1]: Removing replica 3 from ISR 2,3 for partition [t3,7]. (kafka.controller.KafkaController)
[2015-07-21 19:10:28,530] INFO [Controller 1]: New leader and ISR for partition [t3,7] is {"leader":2,"leader_epoch":2,"isr":[2]} (kafka.controller.KafkaController)
[2015-07-21 19:10:28,531] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,531] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=t3,Partition=7,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,531] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t2,4] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,534] DEBUG [ControlledShutdownLeaderSelector]: Partition [t2,4] : current leader = 3, new leader = 2 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-07-21 19:10:28,535] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t3,6] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t3,5] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,1] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t1,2] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,4] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t3,1] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t3,4] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t1,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,2] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,0] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t3,3] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t3,2] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,3] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,6] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,7] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t3,7] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t3,0] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,5] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117)) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,536] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t3,3] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,539] DEBUG [ControlledShutdownLeaderSelector]: Partition [t3,3] : current leader = 3, new leader = 2 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-07-21 19:10:28,542] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t3,6] -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:117), [t3,5] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,1] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t1,2] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,4] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t3,1] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t3,4] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t1,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,2] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,0] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t3,3] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t3,2] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,3] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,6] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,7] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t3,7] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t3,0] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,5] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117)) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,542] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t3,6] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,546] DEBUG [ControlledShutdownLeaderSelector]: Partition [t3,6] : current leader = 3, new leader = 2 (kafka.controller.ControlledShutdownLeaderSelector)
[2015-07-21 19:10:28,547] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t3,6] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t3,5] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,1] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t1,2] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,4] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t3,1] -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:117), [t3,4] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t1,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t2,2] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,0] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t3,3] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111), [t3,2] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,3] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,6] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,7] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t3,7] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t3,0] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117), [t2,5] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117)) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,548] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,548] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=t3,Partition=1,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,548] INFO [Replica state machine on controller 1]: Invoking state change to OfflineReplica for replicas [Topic=t3,Partition=1,Replica=3] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:28,548] DEBUG [Controller 1]: Removing replica 3 from ISR 2,3 for partition [t3,1]. (kafka.controller.KafkaController)
[2015-07-21 19:10:28,552] INFO [Controller 1]: New leader and ISR for partition [t3,1] is {"leader":2,"leader_epoch":2,"isr":[2]} (kafka.controller.KafkaController)
[2015-07-21 19:10:28,553] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,553] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=t3,Partition=1,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:28,554] TRACE [Controller 1]: All leaders = [t3,6] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t3,5] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t2,1] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t1,2] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111),[t2,4] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t3,1] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t3,4] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t1,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111),[t2,2] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t2,0] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t3,3] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t1,1] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111),[t3,2] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t2,3] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t2,6] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t3,7] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t2,7] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t3,0] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t2,5] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117) (kafka.controller.KafkaController)
[2015-07-21 19:10:28,554] INFO [Controller 1]: Shutting down broker 2 (kafka.controller.KafkaController)
[2015-07-21 19:10:28,554] DEBUG [Controller 1]: All shutting down brokers: 1,2,3 (kafka.controller.KafkaController)
[2015-07-21 19:10:28,554] DEBUG [Controller 1]: Live brokers:  (kafka.controller.KafkaController)
[2015-07-21 19:10:28,555] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t3,4] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,560] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t2,2] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,564] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t2,3] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,567] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t3,0] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,571] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t2,0] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,574] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t3,5] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,578] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t2,6] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,582] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t3,2] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,586] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t2,1] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,590] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t2,7] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,594] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t2,5] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,597] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t3,7] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,601] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t2,4] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,605] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t3,3] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,609] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t3,6] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,612] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions [t3,1] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:28,617] TRACE [Controller 1]: All leaders = [t3,6] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t3,5] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t2,1] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t1,2] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111),[t2,4] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t3,1] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t3,4] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t1,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111),[t2,2] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t2,0] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t3,3] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t1,1] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111),[t3,2] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t2,3] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t2,6] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t3,7] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t2,7] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t3,0] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117),[t2,5] -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:117) (kafka.controller.KafkaController)
[2015-07-21 19:10:28,775] WARN [Controller-1-to-broker-1-send-thread], Controller 1 epoch 117 fails to send request Name: StopReplicaRequest; Version: 0; CorrelationId: 24; ClientId: ; DeletePartitions: false; ControllerId: 1; ControllerEpoch: 117; Partitions: [t3,2] to broker id:1,host:10.15.104.47,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.nio.channels.ClosedChannelException
	at kafka.network.BlockingChannel.send(BlockingChannel.scala:100)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:132)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-07-21 19:10:28,776] INFO [Controller-1-to-broker-1-send-thread], Controller 1 connected to id:1,host:10.15.104.47,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-07-21 19:10:29,079] WARN [Controller-1-to-broker-1-send-thread], Controller 1 epoch 117 fails to send request Name: StopReplicaRequest; Version: 0; CorrelationId: 24; ClientId: ; DeletePartitions: false; ControllerId: 1; ControllerEpoch: 117; Partitions: [t3,2] to broker id:1,host:10.15.104.47,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.nio.channels.ClosedChannelException
	at kafka.network.BlockingChannel.send(BlockingChannel.scala:100)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:132)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-07-21 19:10:29,080] INFO [Controller-1-to-broker-1-send-thread], Controller 1 connected to id:1,host:10.15.104.47,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-07-21 19:10:29,123] INFO [delete-topics-thread-1], Shutting down (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-07-21 19:10:29,134] INFO [delete-topics-thread-1], Shutdown completed (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-07-21 19:10:29,136] INFO [Partition state machine on Controller 1]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:29,137] INFO [Replica state machine on controller 1]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:29,137] INFO [Controller-1-to-broker-2-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-07-21 19:10:29,138] INFO [Controller-1-to-broker-2-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-07-21 19:10:29,138] INFO [Controller-1-to-broker-2-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-07-21 19:10:29,148] INFO [Controller-1-to-broker-1-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-07-21 19:10:29,150] ERROR [Controller-1-to-broker-1-send-thread], Controller 1 fails to send a request to broker id:1,host:10.15.104.47,port:9092 (kafka.controller.RequestSendThread)
java.lang.NullPointerException
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:152)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-07-21 19:10:29,150] INFO [Controller-1-to-broker-1-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-07-21 19:10:29,150] INFO [Controller-1-to-broker-1-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-07-21 19:10:29,150] INFO [Controller-1-to-broker-3-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-07-21 19:10:29,150] INFO [Controller-1-to-broker-3-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-07-21 19:10:29,150] INFO [Controller-1-to-broker-3-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-07-21 19:10:29,160] INFO [Controller 3]: Broker 3 starting become controller state transition (kafka.controller.KafkaController)
[2015-07-21 19:10:42,156] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-07-21 19:10:47,869] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2015-07-21 19:10:47,883] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2015-07-21 19:10:51,026] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2015-07-21 19:10:51,029] INFO [Controller 0]: Initialized controller epoch to 117 and zk version 116 (kafka.controller.KafkaController)
[2015-07-21 19:10:51,037] INFO [Controller 0]: Controller 0 incremented epoch to 118 (kafka.controller.KafkaController)
[2015-07-21 19:10:51,215] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,220] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:10.15.104.47,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-07-21 19:10:51,222] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-07-21 19:10:51,225] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-07-21 19:10:51,236] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-07-21 19:10:51,240] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-07-21 19:10:51,244] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,244] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,246] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,253] INFO [Controller 0]: List of topics to be deleted: t2,t3 (kafka.controller.KafkaController)
[2015-07-21 19:10:51,254] INFO [Controller 0]: List of topics ineligible for deletion: t3,t2 (kafka.controller.KafkaController)
[2015-07-21 19:10:51,258] INFO [Controller 0]: Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2015-07-21 19:10:51,258] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,259] INFO [Controller 0]: Current list of topics in the cluster: Set(t1, t2, t3) (kafka.controller.KafkaController)
[2015-07-21 19:10:51,266] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=t1,Partition=2,Replica=0],[Topic=t1,Partition=0,Replica=0],[Topic=t1,Partition=1,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:51,310] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=t3,Partition=6,Replica=2] -> ReplicaDeletionIneligible, [Topic=t1,Partition=0,Replica=0] -> OnlineReplica, [Topic=t2,Partition=5,Replica=2] -> ReplicaDeletionIneligible, [Topic=t3,Partition=1,Replica=2] -> ReplicaDeletionIneligible, [Topic=t3,Partition=1,Replica=3] -> ReplicaDeletionIneligible, [Topic=t2,Partition=2,Replica=2] -> ReplicaDeletionIneligible, [Topic=t2,Partition=1,Replica=3] -> ReplicaDeletionIneligible, [Topic=t2,Partition=1,Replica=2] -> ReplicaDeletionIneligible, [Topic=t1,Partition=2,Replica=0] -> OnlineReplica, [Topic=t2,Partition=6,Replica=2] -> ReplicaDeletionIneligible, [Topic=t2,Partition=6,Replica=1] -> ReplicaDeletionIneligible, [Topic=t2,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=t2,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=t2,Partition=2,Replica=3] -> ReplicaDeletionIneligible, [Topic=t3,Partition=1,Replica=1] -> ReplicaDeletionIneligible, [Topic=t2,Partition=0,Replica=3] -> ReplicaDeletionIneligible, [Topic=t2,Partition=2,Replica=1] -> ReplicaDeletionIneligible, [Topic=t2,Partition=3,Replica=2] -> ReplicaDeletionIneligible, [Topic=t2,Partition=6,Replica=3] -> ReplicaDeletionIneligible, [Topic=t2,Partition=7,Replica=3] -> ReplicaDeletionIneligible, [Topic=t3,Partition=2,Replica=2] -> ReplicaDeletionIneligible, [Topic=t3,Partition=4,Replica=3] -> ReplicaDeletionIneligible, [Topic=t3,Partition=4,Replica=1] -> ReplicaDeletionIneligible, [Topic=t2,Partition=4,Replica=3] -> ReplicaDeletionIneligible, [Topic=t2,Partition=5,Replica=3] -> ReplicaDeletionIneligible, [Topic=t3,Partition=5,Replica=2] -> ReplicaDeletionIneligible, [Topic=t2,Partition=4,Replica=1] -> ReplicaDeletionIneligible, [Topic=t3,Partition=6,Replica=1] -> ReplicaDeletionIneligible, [Topic=t3,Partition=2,Replica=3] -> ReplicaDeletionIneligible, [Topic=t3,Partition=4,Replica=2] -> ReplicaDeletionIneligible, [Topic=t1,Partition=1,Replica=0] -> OnlineReplica, [Topic=t3,Partition=2,Replica=1] -> ReplicaDeletionIneligible, [Topic=t3,Partition=6,Replica=3] -> ReplicaDeletionIneligible, [Topic=t3,Partition=5,Replica=1] -> ReplicaDeletionIneligible, [Topic=t3,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=t3,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=t2,Partition=7,Replica=2] -> ReplicaDeletionIneligible, [Topic=t2,Partition=5,Replica=1] -> ReplicaDeletionIneligible, [Topic=t2,Partition=3,Replica=1] -> ReplicaDeletionIneligible, [Topic=t3,Partition=0,Replica=3] -> ReplicaDeletionIneligible, [Topic=t3,Partition=3,Replica=2] -> ReplicaDeletionIneligible, [Topic=t3,Partition=7,Replica=3] -> ReplicaDeletionIneligible, [Topic=t3,Partition=3,Replica=1] -> ReplicaDeletionIneligible, [Topic=t2,Partition=4,Replica=2] -> ReplicaDeletionIneligible, [Topic=t3,Partition=5,Replica=3] -> ReplicaDeletionIneligible, [Topic=t2,Partition=7,Replica=1] -> ReplicaDeletionIneligible, [Topic=t3,Partition=7,Replica=2] -> ReplicaDeletionIneligible, [Topic=t2,Partition=1,Replica=1] -> ReplicaDeletionIneligible, [Topic=t2,Partition=3,Replica=3] -> ReplicaDeletionIneligible, [Topic=t3,Partition=7,Replica=1] -> ReplicaDeletionIneligible, [Topic=t3,Partition=3,Replica=3] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:51,322] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([t3,6] -> OfflinePartition, [t2,1] -> OfflinePartition, [t3,5] -> OfflinePartition, [t1,2] -> OnlinePartition, [t3,1] -> OfflinePartition, [t2,4] -> OfflinePartition, [t1,0] -> OnlinePartition, [t3,4] -> OfflinePartition, [t2,2] -> OfflinePartition, [t2,0] -> OfflinePartition, [t3,3] -> OfflinePartition, [t1,1] -> OnlinePartition, [t3,2] -> OfflinePartition, [t2,3] -> OfflinePartition, [t2,6] -> OfflinePartition, [t2,7] -> OfflinePartition, [t3,7] -> OfflinePartition, [t3,0] -> OfflinePartition, [t2,5] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:51,326] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 118 (kafka.controller.KafkaController)
[2015-07-21 19:10:51,328] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-07-21 19:10:51,329] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-07-21 19:10:51,346] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-07-21 19:10:51,350] INFO [delete-topics-thread-0], Starting  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-07-21 19:10:51,351] INFO [delete-topics-thread-0], Handling deletion for topics t2,t3 (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-07-21 19:10:51,357] DEBUG [Replica state machine on controller 0]: Are all replicas for topic t2 deleted Map([Topic=t2,Partition=3,Replica=3] -> ReplicaDeletionIneligible, [Topic=t2,Partition=1,Replica=1] -> ReplicaDeletionIneligible, [Topic=t2,Partition=5,Replica=3] -> ReplicaDeletionIneligible, [Topic=t2,Partition=6,Replica=1] -> ReplicaDeletionIneligible, [Topic=t2,Partition=4,Replica=3] -> ReplicaDeletionIneligible, [Topic=t2,Partition=2,Replica=2] -> ReplicaDeletionIneligible, [Topic=t2,Partition=3,Replica=1] -> ReplicaDeletionIneligible, [Topic=t2,Partition=4,Replica=1] -> ReplicaDeletionIneligible, [Topic=t2,Partition=2,Replica=3] -> ReplicaDeletionIneligible, [Topic=t2,Partition=6,Replica=2] -> ReplicaDeletionIneligible, [Topic=t2,Partition=3,Replica=2] -> ReplicaDeletionIneligible, [Topic=t2,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=t2,Partition=5,Replica=1] -> ReplicaDeletionIneligible, [Topic=t2,Partition=6,Replica=3] -> ReplicaDeletionIneligible, [Topic=t2,Partition=1,Replica=2] -> ReplicaDeletionIneligible, [Topic=t2,Partition=2,Replica=1] -> ReplicaDeletionIneligible, [Topic=t2,Partition=7,Replica=3] -> ReplicaDeletionIneligible, [Topic=t2,Partition=1,Replica=3] -> ReplicaDeletionIneligible, [Topic=t2,Partition=0,Replica=3] -> ReplicaDeletionIneligible, [Topic=t2,Partition=4,Replica=2] -> ReplicaDeletionIneligible, [Topic=t2,Partition=7,Replica=2] -> ReplicaDeletionIneligible, [Topic=t2,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=t2,Partition=7,Replica=1] -> ReplicaDeletionIneligible, [Topic=t2,Partition=5,Replica=2] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:51,364] INFO [Topic Deletion Manager 0], Retrying delete topic for topic t2 since replicas [Topic=t2,Partition=5,Replica=2],[Topic=t2,Partition=2,Replica=2],[Topic=t2,Partition=1,Replica=3],[Topic=t2,Partition=1,Replica=2],[Topic=t2,Partition=6,Replica=2],[Topic=t2,Partition=6,Replica=1],[Topic=t2,Partition=0,Replica=1],[Topic=t2,Partition=0,Replica=2],[Topic=t2,Partition=2,Replica=3],[Topic=t2,Partition=0,Replica=3],[Topic=t2,Partition=2,Replica=1],[Topic=t2,Partition=3,Replica=2],[Topic=t2,Partition=6,Replica=3],[Topic=t2,Partition=7,Replica=3],[Topic=t2,Partition=4,Replica=3],[Topic=t2,Partition=4,Replica=1],[Topic=t2,Partition=5,Replica=3],[Topic=t2,Partition=3,Replica=1],[Topic=t2,Partition=5,Replica=1],[Topic=t2,Partition=7,Replica=2],[Topic=t2,Partition=4,Replica=2],[Topic=t2,Partition=7,Replica=1],[Topic=t2,Partition=1,Replica=1],[Topic=t2,Partition=3,Replica=3] were not successfully deleted (kafka.controller.TopicDeletionManager)
[2015-07-21 19:10:51,365] INFO [Replica state machine on controller 0]: Invoking state change to OfflineReplica for replicas [Topic=t2,Partition=5,Replica=2],[Topic=t2,Partition=2,Replica=2],[Topic=t2,Partition=1,Replica=3],[Topic=t2,Partition=1,Replica=2],[Topic=t2,Partition=6,Replica=2],[Topic=t2,Partition=6,Replica=1],[Topic=t2,Partition=0,Replica=1],[Topic=t2,Partition=0,Replica=2],[Topic=t2,Partition=2,Replica=3],[Topic=t2,Partition=0,Replica=3],[Topic=t2,Partition=2,Replica=1],[Topic=t2,Partition=3,Replica=2],[Topic=t2,Partition=6,Replica=3],[Topic=t2,Partition=7,Replica=3],[Topic=t2,Partition=4,Replica=3],[Topic=t2,Partition=4,Replica=1],[Topic=t2,Partition=5,Replica=3],[Topic=t2,Partition=3,Replica=1],[Topic=t2,Partition=5,Replica=1],[Topic=t2,Partition=7,Replica=2],[Topic=t2,Partition=4,Replica=2],[Topic=t2,Partition=7,Replica=1],[Topic=t2,Partition=1,Replica=1],[Topic=t2,Partition=3,Replica=3] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:51,371] DEBUG [Controller 0]: Removing replica 2 from ISR 2 for partition [t2,5]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,384] INFO [Controller 0]: New leader and ISR for partition [t2,5] is {"leader":-1,"leader_epoch":3,"isr":[]} (kafka.controller.KafkaController)
[2015-07-21 19:10:51,385] DEBUG [Controller 0]: Removing replica 2 from ISR 2 for partition [t2,2]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,395] INFO [Controller 0]: New leader and ISR for partition [t2,2] is {"leader":-1,"leader_epoch":3,"isr":[]} (kafka.controller.KafkaController)
[2015-07-21 19:10:51,395] DEBUG [Controller 0]: Removing replica 3 from ISR 2 for partition [t2,1]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,400] WARN [Controller 0]: Cannot remove replica 3 from ISR of partition [t2,1] since it is not in the ISR. Leader = 2 ; ISR = List(2) (kafka.controller.KafkaController)
[2015-07-21 19:10:51,400] DEBUG [Controller 0]: Removing replica 2 from ISR 2 for partition [t2,1]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,410] INFO [Controller 0]: New leader and ISR for partition [t2,1] is {"leader":-1,"leader_epoch":3,"isr":[]} (kafka.controller.KafkaController)
[2015-07-21 19:10:51,410] DEBUG [Controller 0]: Removing replica 2 from ISR 2 for partition [t2,6]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,419] INFO [Controller 0]: New leader and ISR for partition [t2,6] is {"leader":-1,"leader_epoch":3,"isr":[]} (kafka.controller.KafkaController)
[2015-07-21 19:10:51,419] DEBUG [Controller 0]: Removing replica 1 from ISR  for partition [t2,6]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,423] WARN [Controller 0]: Cannot remove replica 1 from ISR of partition [t2,6] since it is not in the ISR. Leader = -1 ; ISR = List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,424] DEBUG [Controller 0]: Removing replica 1 from ISR 2 for partition [t2,0]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,428] WARN [Controller 0]: Cannot remove replica 1 from ISR of partition [t2,0] since it is not in the ISR. Leader = 2 ; ISR = List(2) (kafka.controller.KafkaController)
[2015-07-21 19:10:51,428] DEBUG [Controller 0]: Removing replica 2 from ISR 2 for partition [t2,0]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,435] INFO [Controller 0]: New leader and ISR for partition [t2,0] is {"leader":-1,"leader_epoch":3,"isr":[]} (kafka.controller.KafkaController)
[2015-07-21 19:10:51,436] DEBUG [Controller 0]: Removing replica 3 from ISR  for partition [t2,2]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,440] WARN [Controller 0]: Cannot remove replica 3 from ISR of partition [t2,2] since it is not in the ISR. Leader = -1 ; ISR = List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,440] DEBUG [Controller 0]: Removing replica 3 from ISR  for partition [t2,0]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,444] WARN [Controller 0]: Cannot remove replica 3 from ISR of partition [t2,0] since it is not in the ISR. Leader = -1 ; ISR = List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,445] DEBUG [Controller 0]: Removing replica 1 from ISR  for partition [t2,2]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,448] WARN [Controller 0]: Cannot remove replica 1 from ISR of partition [t2,2] since it is not in the ISR. Leader = -1 ; ISR = List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,449] DEBUG [Controller 0]: Removing replica 2 from ISR 2 for partition [t2,3]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,456] INFO [Controller 0]: New leader and ISR for partition [t2,3] is {"leader":-1,"leader_epoch":3,"isr":[]} (kafka.controller.KafkaController)
[2015-07-21 19:10:51,457] DEBUG [Controller 0]: Removing replica 3 from ISR  for partition [t2,6]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,460] WARN [Controller 0]: Cannot remove replica 3 from ISR of partition [t2,6] since it is not in the ISR. Leader = -1 ; ISR = List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,460] DEBUG [Controller 0]: Removing replica 3 from ISR 2 for partition [t2,7]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,464] WARN [Controller 0]: Cannot remove replica 3 from ISR of partition [t2,7] since it is not in the ISR. Leader = 2 ; ISR = List(2) (kafka.controller.KafkaController)
[2015-07-21 19:10:51,465] DEBUG [Controller 0]: Removing replica 3 from ISR 2 for partition [t2,4]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,469] WARN [Controller 0]: Cannot remove replica 3 from ISR of partition [t2,4] since it is not in the ISR. Leader = 2 ; ISR = List(2) (kafka.controller.KafkaController)
[2015-07-21 19:10:51,470] DEBUG [Controller 0]: Removing replica 1 from ISR 2 for partition [t2,4]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,473] WARN [Controller 0]: Cannot remove replica 1 from ISR of partition [t2,4] since it is not in the ISR. Leader = 2 ; ISR = List(2) (kafka.controller.KafkaController)
[2015-07-21 19:10:51,473] DEBUG [Controller 0]: Removing replica 3 from ISR  for partition [t2,5]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,476] WARN [Controller 0]: Cannot remove replica 3 from ISR of partition [t2,5] since it is not in the ISR. Leader = -1 ; ISR = List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,476] DEBUG [Controller 0]: Removing replica 1 from ISR  for partition [t2,3]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,480] WARN [Controller 0]: Cannot remove replica 1 from ISR of partition [t2,3] since it is not in the ISR. Leader = -1 ; ISR = List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,480] DEBUG [Controller 0]: Removing replica 1 from ISR  for partition [t2,5]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,484] WARN [Controller 0]: Cannot remove replica 1 from ISR of partition [t2,5] since it is not in the ISR. Leader = -1 ; ISR = List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,484] DEBUG [Controller 0]: Removing replica 2 from ISR 2 for partition [t2,7]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,494] INFO [Controller 0]: New leader and ISR for partition [t2,7] is {"leader":-1,"leader_epoch":3,"isr":[]} (kafka.controller.KafkaController)
[2015-07-21 19:10:51,494] DEBUG [Controller 0]: Removing replica 2 from ISR 2 for partition [t2,4]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,508] INFO [Controller 0]: New leader and ISR for partition [t2,4] is {"leader":-1,"leader_epoch":3,"isr":[]} (kafka.controller.KafkaController)
[2015-07-21 19:10:51,508] DEBUG [Controller 0]: Removing replica 1 from ISR  for partition [t2,7]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,513] WARN [Controller 0]: Cannot remove replica 1 from ISR of partition [t2,7] since it is not in the ISR. Leader = -1 ; ISR = List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,513] DEBUG [Controller 0]: Removing replica 1 from ISR  for partition [t2,1]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,516] WARN [Controller 0]: Cannot remove replica 1 from ISR of partition [t2,1] since it is not in the ISR. Leader = -1 ; ISR = List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,517] DEBUG [Controller 0]: Removing replica 3 from ISR  for partition [t2,3]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,520] WARN [Controller 0]: Cannot remove replica 3 from ISR of partition [t2,3] since it is not in the ISR. Leader = -1 ; ISR = List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,523] DEBUG The stop replica request (delete = true) sent to broker 2 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:51,524] DEBUG The stop replica request (delete = false) sent to broker 2 is [Topic=t2,Partition=2,Replica=2],[Topic=t2,Partition=6,Replica=2],[Topic=t2,Partition=3,Replica=2],[Topic=t2,Partition=1,Replica=2],[Topic=t2,Partition=4,Replica=2],[Topic=t2,Partition=7,Replica=2],[Topic=t2,Partition=0,Replica=2],[Topic=t2,Partition=5,Replica=2] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:51,526] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 4; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t2,5] to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,527] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 4; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t2,2] to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,527] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 4; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t2,1] to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,527] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 4; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t2,6] to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,527] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 4; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t2,0] to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,527] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 4; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t2,3] to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,527] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 4; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t2,7] to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,528] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 4; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t2,4] to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,528] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:51,528] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=t2,Partition=1,Replica=1],[Topic=t2,Partition=6,Replica=1],[Topic=t2,Partition=3,Replica=1],[Topic=t2,Partition=4,Replica=1],[Topic=t2,Partition=0,Replica=1],[Topic=t2,Partition=5,Replica=1],[Topic=t2,Partition=2,Replica=1],[Topic=t2,Partition=7,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:51,528] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 4; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t2,6] to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,528] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 4; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t2,0] to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,528] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 4; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t2,2] to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,529] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 4; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t2,4] to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,529] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 4; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t2,3] to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,529] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 4; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t2,5] to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,529] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 4; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t2,7] to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,529] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 4; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t2,1] to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,529] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:51,529] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=t2,Partition=3,Replica=3],[Topic=t2,Partition=5,Replica=3],[Topic=t2,Partition=4,Replica=3],[Topic=t2,Partition=2,Replica=3],[Topic=t2,Partition=6,Replica=3],[Topic=t2,Partition=7,Replica=3],[Topic=t2,Partition=1,Replica=3],[Topic=t2,Partition=0,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:51,529] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 4; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t2,1] to broker 3, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,529] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 4; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t2,2] to broker 3, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,530] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 4; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t2,0] to broker 3, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,530] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 4; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t2,6] to broker 3, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,530] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 4; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t2,7] to broker 3, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,530] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 4; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t2,4] to broker 3, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,530] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 4; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t2,5] to broker 3, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,530] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 4; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t2,3] to broker 3, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,532] INFO [delete-topics-thread-0], Not retrying deletion of topic t2 at this time since it is marked ineligible for deletion (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-07-21 19:10:51,533] DEBUG [Replica state machine on controller 0]: Are all replicas for topic t3 deleted Map([Topic=t3,Partition=1,Replica=2] -> ReplicaDeletionIneligible, [Topic=t3,Partition=3,Replica=3] -> ReplicaDeletionIneligible, [Topic=t3,Partition=4,Replica=1] -> ReplicaDeletionIneligible, [Topic=t3,Partition=1,Replica=3] -> ReplicaDeletionIneligible, [Topic=t3,Partition=2,Replica=3] -> ReplicaDeletionIneligible, [Topic=t3,Partition=2,Replica=2] -> ReplicaDeletionIneligible, [Topic=t3,Partition=7,Replica=2] -> ReplicaDeletionIneligible, [Topic=t3,Partition=3,Replica=1] -> ReplicaDeletionIneligible, [Topic=t3,Partition=5,Replica=1] -> ReplicaDeletionIneligible, [Topic=t3,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=t3,Partition=6,Replica=3] -> ReplicaDeletionIneligible, [Topic=t3,Partition=7,Replica=3] -> ReplicaDeletionIneligible, [Topic=t3,Partition=5,Replica=2] -> ReplicaDeletionIneligible, [Topic=t3,Partition=2,Replica=1] -> ReplicaDeletionIneligible, [Topic=t3,Partition=3,Replica=2] -> ReplicaDeletionIneligible, [Topic=t3,Partition=4,Replica=3] -> ReplicaDeletionIneligible, [Topic=t3,Partition=4,Replica=2] -> ReplicaDeletionIneligible, [Topic=t3,Partition=7,Replica=1] -> ReplicaDeletionIneligible, [Topic=t3,Partition=6,Replica=1] -> ReplicaDeletionIneligible, [Topic=t3,Partition=0,Replica=3] -> ReplicaDeletionIneligible, [Topic=t3,Partition=1,Replica=1] -> ReplicaDeletionIneligible, [Topic=t3,Partition=6,Replica=2] -> ReplicaDeletionIneligible, [Topic=t3,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=t3,Partition=5,Replica=3] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:51,535] INFO [Topic Deletion Manager 0], Retrying delete topic for topic t3 since replicas [Topic=t3,Partition=6,Replica=2],[Topic=t3,Partition=1,Replica=2],[Topic=t3,Partition=1,Replica=3],[Topic=t3,Partition=1,Replica=1],[Topic=t3,Partition=2,Replica=2],[Topic=t3,Partition=4,Replica=3],[Topic=t3,Partition=4,Replica=1],[Topic=t3,Partition=5,Replica=2],[Topic=t3,Partition=6,Replica=1],[Topic=t3,Partition=2,Replica=3],[Topic=t3,Partition=4,Replica=2],[Topic=t3,Partition=2,Replica=1],[Topic=t3,Partition=6,Replica=3],[Topic=t3,Partition=5,Replica=1],[Topic=t3,Partition=0,Replica=2],[Topic=t3,Partition=0,Replica=1],[Topic=t3,Partition=3,Replica=2],[Topic=t3,Partition=0,Replica=3],[Topic=t3,Partition=7,Replica=3],[Topic=t3,Partition=3,Replica=1],[Topic=t3,Partition=5,Replica=3],[Topic=t3,Partition=7,Replica=2],[Topic=t3,Partition=7,Replica=1],[Topic=t3,Partition=3,Replica=3] were not successfully deleted (kafka.controller.TopicDeletionManager)
[2015-07-21 19:10:51,536] INFO [Replica state machine on controller 0]: Invoking state change to OfflineReplica for replicas [Topic=t3,Partition=6,Replica=2],[Topic=t3,Partition=1,Replica=2],[Topic=t3,Partition=1,Replica=3],[Topic=t3,Partition=1,Replica=1],[Topic=t3,Partition=2,Replica=2],[Topic=t3,Partition=4,Replica=3],[Topic=t3,Partition=4,Replica=1],[Topic=t3,Partition=5,Replica=2],[Topic=t3,Partition=6,Replica=1],[Topic=t3,Partition=2,Replica=3],[Topic=t3,Partition=4,Replica=2],[Topic=t3,Partition=2,Replica=1],[Topic=t3,Partition=6,Replica=3],[Topic=t3,Partition=5,Replica=1],[Topic=t3,Partition=0,Replica=2],[Topic=t3,Partition=0,Replica=1],[Topic=t3,Partition=3,Replica=2],[Topic=t3,Partition=0,Replica=3],[Topic=t3,Partition=7,Replica=3],[Topic=t3,Partition=3,Replica=1],[Topic=t3,Partition=5,Replica=3],[Topic=t3,Partition=7,Replica=2],[Topic=t3,Partition=7,Replica=1],[Topic=t3,Partition=3,Replica=3] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:10:51,536] DEBUG [Controller 0]: Removing replica 2 from ISR 2 for partition [t3,6]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,543] INFO [Controller 0]: New leader and ISR for partition [t3,6] is {"leader":-1,"leader_epoch":3,"isr":[]} (kafka.controller.KafkaController)
[2015-07-21 19:10:51,544] DEBUG [Controller 0]: Removing replica 2 from ISR 2 for partition [t3,1]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,552] INFO [Controller 0]: New leader and ISR for partition [t3,1] is {"leader":-1,"leader_epoch":3,"isr":[]} (kafka.controller.KafkaController)
[2015-07-21 19:10:51,553] DEBUG [Controller 0]: Removing replica 3 from ISR  for partition [t3,1]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,556] WARN [Controller 0]: Cannot remove replica 3 from ISR of partition [t3,1] since it is not in the ISR. Leader = -1 ; ISR = List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,556] DEBUG [Controller 0]: Removing replica 1 from ISR  for partition [t3,1]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,558] WARN [Controller 0]: Cannot remove replica 1 from ISR of partition [t3,1] since it is not in the ISR. Leader = -1 ; ISR = List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,559] DEBUG [Controller 0]: Removing replica 2 from ISR 2 for partition [t3,2]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,564] INFO [Controller 0]: New leader and ISR for partition [t3,2] is {"leader":-1,"leader_epoch":3,"isr":[]} (kafka.controller.KafkaController)
[2015-07-21 19:10:51,564] DEBUG [Controller 0]: Removing replica 3 from ISR 2 for partition [t3,4]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,568] WARN [Controller 0]: Cannot remove replica 3 from ISR of partition [t3,4] since it is not in the ISR. Leader = 2 ; ISR = List(2) (kafka.controller.KafkaController)
[2015-07-21 19:10:51,568] DEBUG [Controller 0]: Removing replica 1 from ISR 2 for partition [t3,4]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,572] WARN [Controller 0]: Cannot remove replica 1 from ISR of partition [t3,4] since it is not in the ISR. Leader = 2 ; ISR = List(2) (kafka.controller.KafkaController)
[2015-07-21 19:10:51,572] DEBUG [Controller 0]: Removing replica 2 from ISR 2 for partition [t3,5]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,579] INFO [Controller 0]: New leader and ISR for partition [t3,5] is {"leader":-1,"leader_epoch":3,"isr":[]} (kafka.controller.KafkaController)
[2015-07-21 19:10:51,579] DEBUG [Controller 0]: Removing replica 1 from ISR  for partition [t3,6]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,583] WARN [Controller 0]: Cannot remove replica 1 from ISR of partition [t3,6] since it is not in the ISR. Leader = -1 ; ISR = List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,583] DEBUG [Controller 0]: Removing replica 3 from ISR  for partition [t3,2]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,586] WARN [Controller 0]: Cannot remove replica 3 from ISR of partition [t3,2] since it is not in the ISR. Leader = -1 ; ISR = List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,586] DEBUG [Controller 0]: Removing replica 2 from ISR 2 for partition [t3,4]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,593] INFO [Controller 0]: New leader and ISR for partition [t3,4] is {"leader":-1,"leader_epoch":3,"isr":[]} (kafka.controller.KafkaController)
[2015-07-21 19:10:51,593] DEBUG [Controller 0]: Removing replica 1 from ISR  for partition [t3,2]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,596] WARN [Controller 0]: Cannot remove replica 1 from ISR of partition [t3,2] since it is not in the ISR. Leader = -1 ; ISR = List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,597] DEBUG [Controller 0]: Removing replica 3 from ISR  for partition [t3,6]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,600] WARN [Controller 0]: Cannot remove replica 3 from ISR of partition [t3,6] since it is not in the ISR. Leader = -1 ; ISR = List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,600] DEBUG [Controller 0]: Removing replica 1 from ISR  for partition [t3,5]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,603] WARN [Controller 0]: Cannot remove replica 1 from ISR of partition [t3,5] since it is not in the ISR. Leader = -1 ; ISR = List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,603] DEBUG [Controller 0]: Removing replica 2 from ISR 2 for partition [t3,0]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,609] INFO [Controller 0]: New leader and ISR for partition [t3,0] is {"leader":-1,"leader_epoch":3,"isr":[]} (kafka.controller.KafkaController)
[2015-07-21 19:10:51,610] DEBUG [Controller 0]: Removing replica 1 from ISR  for partition [t3,0]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,613] WARN [Controller 0]: Cannot remove replica 1 from ISR of partition [t3,0] since it is not in the ISR. Leader = -1 ; ISR = List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,613] DEBUG [Controller 0]: Removing replica 2 from ISR 2 for partition [t3,3]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,618] INFO [Controller 0]: New leader and ISR for partition [t3,3] is {"leader":-1,"leader_epoch":3,"isr":[]} (kafka.controller.KafkaController)
[2015-07-21 19:10:51,619] DEBUG [Controller 0]: Removing replica 3 from ISR  for partition [t3,0]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,622] WARN [Controller 0]: Cannot remove replica 3 from ISR of partition [t3,0] since it is not in the ISR. Leader = -1 ; ISR = List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,622] DEBUG [Controller 0]: Removing replica 3 from ISR 2 for partition [t3,7]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,625] WARN [Controller 0]: Cannot remove replica 3 from ISR of partition [t3,7] since it is not in the ISR. Leader = 2 ; ISR = List(2) (kafka.controller.KafkaController)
[2015-07-21 19:10:51,625] DEBUG [Controller 0]: Removing replica 1 from ISR  for partition [t3,3]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,627] WARN [Controller 0]: Cannot remove replica 1 from ISR of partition [t3,3] since it is not in the ISR. Leader = -1 ; ISR = List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,627] DEBUG [Controller 0]: Removing replica 3 from ISR  for partition [t3,5]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,630] WARN [Controller 0]: Cannot remove replica 3 from ISR of partition [t3,5] since it is not in the ISR. Leader = -1 ; ISR = List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,630] DEBUG [Controller 0]: Removing replica 2 from ISR 2 for partition [t3,7]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,635] INFO [Controller 0]: New leader and ISR for partition [t3,7] is {"leader":-1,"leader_epoch":3,"isr":[]} (kafka.controller.KafkaController)
[2015-07-21 19:10:51,635] DEBUG [Controller 0]: Removing replica 1 from ISR  for partition [t3,7]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,637] WARN [Controller 0]: Cannot remove replica 1 from ISR of partition [t3,7] since it is not in the ISR. Leader = -1 ; ISR = List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,637] DEBUG [Controller 0]: Removing replica 3 from ISR  for partition [t3,3]. (kafka.controller.KafkaController)
[2015-07-21 19:10:51,640] WARN [Controller 0]: Cannot remove replica 3 from ISR of partition [t3,3] since it is not in the ISR. Leader = -1 ; ISR = List() (kafka.controller.KafkaController)
[2015-07-21 19:10:51,640] DEBUG The stop replica request (delete = true) sent to broker 2 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:51,640] DEBUG The stop replica request (delete = false) sent to broker 2 is [Topic=t3,Partition=1,Replica=2],[Topic=t3,Partition=2,Replica=2],[Topic=t3,Partition=7,Replica=2],[Topic=t3,Partition=0,Replica=2],[Topic=t3,Partition=5,Replica=2],[Topic=t3,Partition=3,Replica=2],[Topic=t3,Partition=4,Replica=2],[Topic=t3,Partition=6,Replica=2] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:51,640] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 5; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t3,6] to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,640] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 5; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t3,1] to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,640] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 5; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t3,2] to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,641] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 5; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t3,5] to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,641] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 5; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t3,4] to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,641] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 5; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t3,0] to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,641] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 5; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t3,3] to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,641] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 5; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t3,7] to broker 2, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,641] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:51,641] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=t3,Partition=4,Replica=1],[Topic=t3,Partition=3,Replica=1],[Topic=t3,Partition=5,Replica=1],[Topic=t3,Partition=2,Replica=1],[Topic=t3,Partition=7,Replica=1],[Topic=t3,Partition=6,Replica=1],[Topic=t3,Partition=1,Replica=1],[Topic=t3,Partition=0,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:51,642] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 5; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t3,1] to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,642] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 5; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t3,4] to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,642] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 5; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t3,6] to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,642] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 5; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t3,2] to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,642] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 5; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t3,5] to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,642] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 5; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t3,0] to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,642] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 5; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t3,3] to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,642] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 5; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t3,7] to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,643] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:51,643] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=t3,Partition=3,Replica=3],[Topic=t3,Partition=1,Replica=3],[Topic=t3,Partition=2,Replica=3],[Topic=t3,Partition=6,Replica=3],[Topic=t3,Partition=7,Replica=3],[Topic=t3,Partition=4,Replica=3],[Topic=t3,Partition=0,Replica=3],[Topic=t3,Partition=5,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2015-07-21 19:10:51,643] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 5; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t3,1] to broker 3, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,643] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 5; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t3,4] to broker 3, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,643] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 5; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t3,2] to broker 3, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,643] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 5; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t3,6] to broker 3, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,643] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 5; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t3,0] to broker 3, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,644] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 5; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t3,7] to broker 3, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,644] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 5; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t3,5] to broker 3, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,644] WARN [Channel manager on controller 0]: Not sending request Name: StopReplicaRequest; Version: 0; CorrelationId: 5; ClientId: ; DeletePartitions: false; ControllerId: 0; ControllerEpoch: 118; Partitions: [t3,3] to broker 3, since it is offline. (kafka.controller.ControllerChannelManager)
[2015-07-21 19:10:51,645] INFO [delete-topics-thread-0], Not retrying deletion of topic t3 at this time since it is marked ineligible for deletion (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-07-21 19:10:51,645] DEBUG [Topic Deletion Manager 0], Waiting for signal to start or continue topic deletion (kafka.controller.TopicDeletionManager)
[2015-07-21 19:10:56,351] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-07-21 19:10:56,357] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([t1,2] -> List(0), [t1,0] -> List(0), [t1,1] -> List(0))) (kafka.controller.KafkaController)
[2015-07-21 19:10:56,360] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-07-21 19:10:56,361] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-07-21 19:12:46,354] INFO [Controller 0]: Shutting down broker 0 (kafka.controller.KafkaController)
[2015-07-21 19:12:46,355] DEBUG [Controller 0]: All shutting down brokers: 0 (kafka.controller.KafkaController)
[2015-07-21 19:12:46,356] DEBUG [Controller 0]: Live brokers:  (kafka.controller.KafkaController)
[2015-07-21 19:12:46,360] TRACE [Controller 0]: All leaders = [t3,6] -> (Leader:-1,ISR:,LeaderEpoch:3,ControllerEpoch:118),[t2,1] -> (Leader:-1,ISR:,LeaderEpoch:3,ControllerEpoch:118),[t3,5] -> (Leader:-1,ISR:,LeaderEpoch:3,ControllerEpoch:118),[t1,2] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111),[t3,1] -> (Leader:-1,ISR:,LeaderEpoch:3,ControllerEpoch:118),[t2,4] -> (Leader:-1,ISR:,LeaderEpoch:3,ControllerEpoch:118),[t1,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111),[t3,4] -> (Leader:-1,ISR:,LeaderEpoch:3,ControllerEpoch:118),[t2,2] -> (Leader:-1,ISR:,LeaderEpoch:3,ControllerEpoch:118),[t2,0] -> (Leader:-1,ISR:,LeaderEpoch:3,ControllerEpoch:118),[t3,3] -> (Leader:-1,ISR:,LeaderEpoch:3,ControllerEpoch:118),[t1,1] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:111),[t3,2] -> (Leader:-1,ISR:,LeaderEpoch:3,ControllerEpoch:118),[t2,3] -> (Leader:-1,ISR:,LeaderEpoch:3,ControllerEpoch:118),[t2,6] -> (Leader:-1,ISR:,LeaderEpoch:3,ControllerEpoch:118),[t3,7] -> (Leader:-1,ISR:,LeaderEpoch:3,ControllerEpoch:118),[t2,7] -> (Leader:-1,ISR:,LeaderEpoch:3,ControllerEpoch:118),[t3,0] -> (Leader:-1,ISR:,LeaderEpoch:3,ControllerEpoch:118),[t2,5] -> (Leader:-1,ISR:,LeaderEpoch:3,ControllerEpoch:118) (kafka.controller.KafkaController)
[2015-07-21 19:12:46,556] INFO [delete-topics-thread-0], Shutting down (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-07-21 19:12:46,557] INFO [delete-topics-thread-0], Stopped  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-07-21 19:12:46,557] INFO [delete-topics-thread-0], Shutdown completed (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-07-21 19:12:46,558] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-07-21 19:12:46,559] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:12:46,559] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-07-21 19:12:46,559] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-07-21 19:12:46,559] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-07-21 19:14:11,181] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2015-07-21 19:14:11,213] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2015-07-21 19:14:11,220] INFO [Controller 0]: Initialized controller epoch to 118 and zk version 117 (kafka.controller.KafkaController)
[2015-07-21 19:14:11,223] INFO [Controller 0]: Controller 0 incremented epoch to 119 (kafka.controller.KafkaController)
[2015-07-21 19:14:11,240] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-07-21 19:14:11,241] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-07-21 19:14:11,242] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-07-21 19:14:11,244] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-07-21 19:14:11,245] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-07-21 19:14:11,246] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-07-21 19:14:11,249] INFO [Controller 0]: List of topics to be deleted: t2,t3 (kafka.controller.KafkaController)
[2015-07-21 19:14:11,250] INFO [Controller 0]: List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2015-07-21 19:14:11,253] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-07-21 19:14:11,253] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-07-21 19:14:11,254] INFO [Controller 0]: Current list of topics in the cluster: Set() (kafka.controller.KafkaController)
[2015-07-21 19:14:11,256] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map() (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:14:11,259] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map() (kafka.controller.PartitionStateMachine)
[2015-07-21 19:14:11,260] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 119 (kafka.controller.KafkaController)
[2015-07-21 19:14:11,261] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-07-21 19:14:11,262] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-07-21 19:14:11,266] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-07-21 19:14:11,267] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2015-07-21 19:14:11,267] INFO [delete-topics-thread-0], Starting  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-07-21 19:14:11,335] INFO [delete-topics-thread-0], Handling deletion for topics t2,t3 (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-07-21 19:14:11,336] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-07-21 19:14:11,337] DEBUG [Replica state machine on controller 0]: Are all replicas for topic t2 deleted Map() (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:14:11,338] ERROR [delete-topics-thread-0], Error due to  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
java.util.NoSuchElementException: key not found: t2
	at scala.collection.MapLike$class.default(MapLike.scala:228)
	at scala.collection.AbstractMap.default(Map.scala:59)
	at scala.collection.mutable.HashMap.apply(HashMap.scala:65)
	at kafka.controller.PartitionStateMachine.deregisterPartitionChangeListener(PartitionStateMachine.scala:399)
	at kafka.controller.TopicDeletionManager.kafka$controller$TopicDeletionManager$$completeDeleteTopic(TopicDeletionManager.scala:276)
	at kafka.controller.TopicDeletionManager$DeleteTopicsThread$$anonfun$doWork$1$$anonfun$apply$mcV$sp$4.apply(TopicDeletionManager.scala:400)
	at kafka.controller.TopicDeletionManager$DeleteTopicsThread$$anonfun$doWork$1$$anonfun$apply$mcV$sp$4.apply(TopicDeletionManager.scala:396)
	at scala.collection.immutable.Set$Set2.foreach(Set.scala:111)
	at kafka.controller.TopicDeletionManager$DeleteTopicsThread$$anonfun$doWork$1.apply$mcV$sp(TopicDeletionManager.scala:396)
	at kafka.controller.TopicDeletionManager$DeleteTopicsThread$$anonfun$doWork$1.apply(TopicDeletionManager.scala:390)
	at kafka.controller.TopicDeletionManager$DeleteTopicsThread$$anonfun$doWork$1.apply(TopicDeletionManager.scala:390)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.TopicDeletionManager$DeleteTopicsThread.doWork(TopicDeletionManager.scala:390)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-07-21 19:14:11,342] INFO [delete-topics-thread-0], Stopped  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-07-21 19:14:11,366] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-07-21 19:14:11,368] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-07-21 19:14:11,378] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:10.15.104.47,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-07-21 19:14:11,379] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-07-21 19:14:11,380] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2015-07-21 19:14:16,271] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-07-21 19:14:16,273] DEBUG [Controller 0]: preferred replicas by broker Map() (kafka.controller.KafkaController)
[2015-07-21 19:19:16,266] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-07-21 19:19:16,266] DEBUG [Controller 0]: preferred replicas by broker Map() (kafka.controller.KafkaController)
[2015-07-21 19:22:56,754] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children t1 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2015-07-21 19:22:56,768] INFO [TopicChangeListener on Controller 0]: New topics: [Set(t1)], deleted topics: [Set()], new partition replica assignment [Map([t1,2] -> List(0), [t1,0] -> List(0), [t1,1] -> List(0))] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2015-07-21 19:22:56,769] INFO [Controller 0]: New topic creation callback for [t1,2],[t1,0],[t1,1] (kafka.controller.KafkaController)
[2015-07-21 19:22:56,771] INFO [Controller 0]: New partition creation callback for [t1,2],[t1,0],[t1,1] (kafka.controller.KafkaController)
[2015-07-21 19:22:56,772] INFO [Partition state machine on Controller 0]: Invoking state change to NewPartition for partitions [t1,2],[t1,0],[t1,1] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:22:56,799] INFO [Replica state machine on controller 0]: Invoking state change to NewReplica for replicas [Topic=t1,Partition=2,Replica=0],[Topic=t1,Partition=0,Replica=0],[Topic=t1,Partition=1,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:22:56,808] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [t1,2],[t1,0],[t1,1] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:22:56,809] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [t1,2] are: [List(0)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:22:56,812] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [t1,2] to (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:119) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:22:56,825] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [t1,0] are: [List(0)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:22:56,825] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [t1,0] to (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:119) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:22:56,829] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [t1,1] are: [List(0)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:22:56,829] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [t1,1] to (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:119) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:22:56,843] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=t1,Partition=2,Replica=0],[Topic=t1,Partition=0,Replica=0],[Topic=t1,Partition=1,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:22:56,848] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children t1,t2,t3 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2015-07-21 19:22:56,862] INFO [TopicChangeListener on Controller 0]: New topics: [Set(t2, t3)], deleted topics: [Set()], new partition replica assignment [Map([t2,1] -> List(0), [t3,1] -> List(0), [t2,0] -> List(0), [t2,2] -> List(0), [t3,2] -> List(0), [t3,0] -> List(0))] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2015-07-21 19:22:56,863] INFO [Controller 0]: New topic creation callback for [t3,0],[t2,1],[t3,1],[t3,2],[t2,0],[t2,2] (kafka.controller.KafkaController)
[2015-07-21 19:22:56,865] INFO [Controller 0]: New partition creation callback for [t3,0],[t2,1],[t3,1],[t3,2],[t2,0],[t2,2] (kafka.controller.KafkaController)
[2015-07-21 19:22:56,865] INFO [Partition state machine on Controller 0]: Invoking state change to NewPartition for partitions [t3,0],[t2,1],[t3,1],[t3,2],[t2,0],[t2,2] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:22:56,937] INFO [Replica state machine on controller 0]: Invoking state change to NewReplica for replicas [Topic=t3,Partition=0,Replica=0],[Topic=t3,Partition=2,Replica=0],[Topic=t3,Partition=1,Replica=0],[Topic=t2,Partition=1,Replica=0],[Topic=t2,Partition=2,Replica=0],[Topic=t2,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:22:56,951] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [t3,0],[t2,1],[t3,1],[t3,2],[t2,0],[t2,2] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:22:56,951] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [t3,0] are: [List(0)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:22:56,952] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [t3,0] to (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:119) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:22:56,964] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [t2,1] are: [List(0)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:22:56,964] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [t2,1] to (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:119) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:22:56,994] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [t3,1] are: [List(0)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:22:56,994] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [t3,1] to (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:119) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:22:56,999] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [t3,2] are: [List(0)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:22:56,999] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [t3,2] to (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:119) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:22:57,003] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [t2,0] are: [List(0)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:22:57,003] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [t2,0] to (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:119) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:22:57,013] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [t2,2] are: [List(0)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:22:57,013] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [t2,2] to (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:119) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:22:57,022] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=t3,Partition=0,Replica=0],[Topic=t3,Partition=2,Replica=0],[Topic=t3,Partition=1,Replica=0],[Topic=t2,Partition=1,Replica=0],[Topic=t2,Partition=2,Replica=0],[Topic=t2,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:24:16,259] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-07-21 19:24:16,260] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([t1,2] -> List(0), [t1,0] -> List(0), [t1,1] -> List(0))) (kafka.controller.KafkaController)
[2015-07-21 19:24:16,262] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-07-21 19:24:16,263] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-07-21 19:24:44,144] INFO [Controller 0]: Shutting down broker 0 (kafka.controller.KafkaController)
[2015-07-21 19:24:44,145] DEBUG [Controller 0]: All shutting down brokers: 0 (kafka.controller.KafkaController)
[2015-07-21 19:24:44,146] DEBUG [Controller 0]: Live brokers:  (kafka.controller.KafkaController)
[2015-07-21 19:24:44,151] TRACE [Controller 0]: All leaders = [t2,1] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:119),[t1,2] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:119),[t3,1] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:119),[t1,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:119),[t2,2] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:119),[t2,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:119),[t1,1] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:119),[t3,2] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:119),[t3,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:119) (kafka.controller.KafkaController)
[2015-07-21 19:24:44,290] INFO [delete-topics-thread-0], Shutting down (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-07-21 19:24:44,290] INFO [delete-topics-thread-0], Shutdown completed (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-07-21 19:24:44,292] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-07-21 19:24:44,293] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:24:44,293] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-07-21 19:24:44,293] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-07-21 19:24:44,293] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-07-21 19:25:20,910] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-07-21 19:25:48,183] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2015-07-21 19:25:48,215] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2015-07-21 19:25:48,229] INFO [Controller 0]: Initialized controller epoch to 119 and zk version 118 (kafka.controller.KafkaController)
[2015-07-21 19:25:48,237] INFO [Controller 0]: Controller 0 incremented epoch to 120 (kafka.controller.KafkaController)
[2015-07-21 19:25:48,255] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-07-21 19:25:48,255] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-07-21 19:25:48,255] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-07-21 19:25:48,258] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-07-21 19:25:48,259] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-07-21 19:25:48,260] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-07-21 19:25:48,263] INFO [Controller 0]: List of topics to be deleted: t2,t3 (kafka.controller.KafkaController)
[2015-07-21 19:25:48,263] INFO [Controller 0]: List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2015-07-21 19:25:48,266] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-07-21 19:25:48,266] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-07-21 19:25:48,267] INFO [Controller 0]: Current list of topics in the cluster: Set() (kafka.controller.KafkaController)
[2015-07-21 19:25:48,269] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map() (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:25:48,272] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map() (kafka.controller.PartitionStateMachine)
[2015-07-21 19:25:48,273] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 120 (kafka.controller.KafkaController)
[2015-07-21 19:25:48,274] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-07-21 19:25:48,275] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-07-21 19:25:48,284] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-07-21 19:25:48,286] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2015-07-21 19:25:48,286] INFO [delete-topics-thread-0], Starting  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-07-21 19:25:48,356] INFO [delete-topics-thread-0], Handling deletion for topics t2,t3 (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-07-21 19:25:48,357] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-07-21 19:25:48,359] DEBUG [Replica state machine on controller 0]: Are all replicas for topic t2 deleted Map() (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:25:48,360] ERROR [delete-topics-thread-0], Error due to  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
java.util.NoSuchElementException: key not found: t2
	at scala.collection.MapLike$class.default(MapLike.scala:228)
	at scala.collection.AbstractMap.default(Map.scala:59)
	at scala.collection.mutable.HashMap.apply(HashMap.scala:65)
	at kafka.controller.PartitionStateMachine.deregisterPartitionChangeListener(PartitionStateMachine.scala:399)
	at kafka.controller.TopicDeletionManager.kafka$controller$TopicDeletionManager$$completeDeleteTopic(TopicDeletionManager.scala:276)
	at kafka.controller.TopicDeletionManager$DeleteTopicsThread$$anonfun$doWork$1$$anonfun$apply$mcV$sp$4.apply(TopicDeletionManager.scala:400)
	at kafka.controller.TopicDeletionManager$DeleteTopicsThread$$anonfun$doWork$1$$anonfun$apply$mcV$sp$4.apply(TopicDeletionManager.scala:396)
	at scala.collection.immutable.Set$Set2.foreach(Set.scala:111)
	at kafka.controller.TopicDeletionManager$DeleteTopicsThread$$anonfun$doWork$1.apply$mcV$sp(TopicDeletionManager.scala:396)
	at kafka.controller.TopicDeletionManager$DeleteTopicsThread$$anonfun$doWork$1.apply(TopicDeletionManager.scala:390)
	at kafka.controller.TopicDeletionManager$DeleteTopicsThread$$anonfun$doWork$1.apply(TopicDeletionManager.scala:390)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.TopicDeletionManager$DeleteTopicsThread.doWork(TopicDeletionManager.scala:390)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-07-21 19:25:48,365] INFO [delete-topics-thread-0], Stopped  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-07-21 19:25:48,391] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-07-21 19:25:48,393] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-07-21 19:25:48,399] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:10.15.104.47,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-07-21 19:25:48,400] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-07-21 19:25:48,401] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2015-07-21 19:25:53,096] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children t1 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2015-07-21 19:25:53,113] INFO [TopicChangeListener on Controller 0]: New topics: [Set(t1)], deleted topics: [Set()], new partition replica assignment [Map([t1,2] -> List(0), [t1,0] -> List(0), [t1,1] -> List(0))] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2015-07-21 19:25:53,114] INFO [Controller 0]: New topic creation callback for [t1,2],[t1,0],[t1,1] (kafka.controller.KafkaController)
[2015-07-21 19:25:53,117] INFO [Controller 0]: New partition creation callback for [t1,2],[t1,0],[t1,1] (kafka.controller.KafkaController)
[2015-07-21 19:25:53,118] INFO [Partition state machine on Controller 0]: Invoking state change to NewPartition for partitions [t1,2],[t1,0],[t1,1] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:25:53,143] INFO [Replica state machine on controller 0]: Invoking state change to NewReplica for replicas [Topic=t1,Partition=2,Replica=0],[Topic=t1,Partition=0,Replica=0],[Topic=t1,Partition=1,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:25:53,155] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [t1,2],[t1,0],[t1,1] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:25:53,157] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [t1,2] are: [List(0)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:25:53,159] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [t1,2] to (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:120) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:25:53,172] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [t1,0] are: [List(0)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:25:53,172] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [t1,0] to (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:120) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:25:53,180] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [t1,1] are: [List(0)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:25:53,180] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [t1,1] to (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:120) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:25:53,195] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=t1,Partition=2,Replica=0],[Topic=t1,Partition=0,Replica=0],[Topic=t1,Partition=1,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:25:53,205] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children t1,t2,t3 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2015-07-21 19:25:53,218] INFO [TopicChangeListener on Controller 0]: New topics: [Set(t2, t3)], deleted topics: [Set()], new partition replica assignment [Map([t2,1] -> List(0), [t3,1] -> List(0), [t2,0] -> List(0), [t2,2] -> List(0), [t3,2] -> List(0), [t3,0] -> List(0))] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2015-07-21 19:25:53,218] INFO [Controller 0]: New topic creation callback for [t3,0],[t2,1],[t3,1],[t3,2],[t2,0],[t2,2] (kafka.controller.KafkaController)
[2015-07-21 19:25:53,222] INFO [Controller 0]: New partition creation callback for [t3,0],[t2,1],[t3,1],[t3,2],[t2,0],[t2,2] (kafka.controller.KafkaController)
[2015-07-21 19:25:53,223] INFO [Partition state machine on Controller 0]: Invoking state change to NewPartition for partitions [t3,0],[t2,1],[t3,1],[t3,2],[t2,0],[t2,2] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:25:53,265] INFO [Replica state machine on controller 0]: Invoking state change to NewReplica for replicas [Topic=t3,Partition=0,Replica=0],[Topic=t3,Partition=2,Replica=0],[Topic=t3,Partition=1,Replica=0],[Topic=t2,Partition=1,Replica=0],[Topic=t2,Partition=2,Replica=0],[Topic=t2,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:25:53,310] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [t3,0],[t2,1],[t3,1],[t3,2],[t2,0],[t2,2] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:25:53,311] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [t3,0] are: [List(0)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:25:53,311] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [t3,0] to (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:120) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:25:53,328] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [t2,1] are: [List(0)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:25:53,328] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [t2,1] to (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:120) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:25:53,338] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [t3,1] are: [List(0)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:25:53,338] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [t3,1] to (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:120) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:25:53,345] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [t3,2] are: [List(0)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:25:53,345] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [t3,2] to (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:120) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:25:53,350] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [t2,0] are: [List(0)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:25:53,350] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [t2,0] to (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:120) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:25:53,358] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [t2,2] are: [List(0)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:25:53,358] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [t2,2] to (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:120) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:25:53,367] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=t3,Partition=0,Replica=0],[Topic=t3,Partition=2,Replica=0],[Topic=t3,Partition=1,Replica=0],[Topic=t2,Partition=1,Replica=0],[Topic=t2,Partition=2,Replica=0],[Topic=t2,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:25:53,369] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-07-21 19:25:53,380] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([t1,2] -> List(0), [t1,0] -> List(0), [t1,1] -> List(0))) (kafka.controller.KafkaController)
[2015-07-21 19:25:53,385] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-07-21 19:25:53,387] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-07-21 19:30:53,283] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-07-21 19:30:53,284] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([t1,2] -> List(0), [t1,0] -> List(0), [t1,1] -> List(0))) (kafka.controller.KafkaController)
[2015-07-21 19:30:53,284] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-07-21 19:30:53,284] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-07-21 19:35:53,279] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-07-21 19:35:53,280] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([t1,2] -> List(0), [t1,0] -> List(0), [t1,1] -> List(0))) (kafka.controller.KafkaController)
[2015-07-21 19:35:53,280] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-07-21 19:35:53,280] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-07-21 19:40:53,272] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-07-21 19:40:53,273] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([t1,2] -> List(0), [t1,0] -> List(0), [t1,1] -> List(0))) (kafka.controller.KafkaController)
[2015-07-21 19:40:53,273] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-07-21 19:40:53,273] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-07-21 19:45:53,263] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-07-21 19:45:53,264] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([t1,2] -> List(0), [t1,0] -> List(0), [t1,1] -> List(0))) (kafka.controller.KafkaController)
[2015-07-21 19:45:53,264] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-07-21 19:45:53,264] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-07-21 19:50:53,260] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-07-21 19:50:53,260] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([t1,2] -> List(0), [t1,0] -> List(0), [t1,1] -> List(0))) (kafka.controller.KafkaController)
[2015-07-21 19:50:53,261] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-07-21 19:50:53,261] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-07-21 19:53:08,178] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children t1,group-test-topic,t2,t3 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2015-07-21 19:53:08,183] INFO [TopicChangeListener on Controller 0]: New topics: [Set(group-test-topic)], deleted topics: [Set()], new partition replica assignment [Map([group-test-topic,1] -> List(0), [group-test-topic,2] -> List(0), [group-test-topic,0] -> List(0))] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2015-07-21 19:53:08,183] INFO [Controller 0]: New topic creation callback for [group-test-topic,1],[group-test-topic,2],[group-test-topic,0] (kafka.controller.KafkaController)
[2015-07-21 19:53:08,187] INFO [Controller 0]: New partition creation callback for [group-test-topic,1],[group-test-topic,2],[group-test-topic,0] (kafka.controller.KafkaController)
[2015-07-21 19:53:08,187] INFO [Partition state machine on Controller 0]: Invoking state change to NewPartition for partitions [group-test-topic,1],[group-test-topic,2],[group-test-topic,0] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:53:08,209] INFO [Replica state machine on controller 0]: Invoking state change to NewReplica for replicas [Topic=group-test-topic,Partition=1,Replica=0],[Topic=group-test-topic,Partition=2,Replica=0],[Topic=group-test-topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:53:08,216] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [group-test-topic,1],[group-test-topic,2],[group-test-topic,0] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:53:08,217] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [group-test-topic,1] are: [List(0)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:53:08,217] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [group-test-topic,1] to (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:120) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:53:08,231] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [group-test-topic,2] are: [List(0)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:53:08,231] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [group-test-topic,2] to (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:120) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:53:08,239] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [group-test-topic,0] are: [List(0)] (kafka.controller.PartitionStateMachine)
[2015-07-21 19:53:08,239] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [group-test-topic,0] to (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:120) (kafka.controller.PartitionStateMachine)
[2015-07-21 19:53:08,242] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=group-test-topic,Partition=1,Replica=0],[Topic=group-test-topic,Partition=2,Replica=0],[Topic=group-test-topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-07-21 19:53:08,244] WARN [Controller-0-to-broker-0-send-thread], Controller 0 epoch 120 fails to send request Name:LeaderAndIsrRequest;Version:0;Controller:0;ControllerEpoch:120;CorrelationId:15;ClientId:id_0-host_null-port_9092;Leaders:id:0,host:10.15.104.47,port:9092;PartitionState:(group-test-topic,2) -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:120),ReplicationFactor:1),AllReplicas:0),(group-test-topic,1) -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:120),ReplicationFactor:1),AllReplicas:0),(group-test-topic,0) -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:120),ReplicationFactor:1),AllReplicas:0) to broker id:0,host:10.15.104.47,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:197)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:197)
	at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	at kafka.utils.Utils$.read(Utils.scala:380)
	at kafka.network.BoundedByteBufferReceive.readFrom(BoundedByteBufferReceive.scala:54)
	at kafka.network.Receive$class.readCompletely(Transmission.scala:56)
	at kafka.network.BoundedByteBufferReceive.readCompletely(BoundedByteBufferReceive.scala:29)
	at kafka.network.BlockingChannel.receive(BlockingChannel.scala:111)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:133)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-07-21 19:53:08,245] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:10.15.104.47,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-07-21 19:55:53,254] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-07-21 19:55:53,255] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([t1,2] -> List(0), [group-test-topic,1] -> List(0), [group-test-topic,2] -> List(0), [t1,0] -> List(0), [group-test-topic,0] -> List(0), [t1,1] -> List(0))) (kafka.controller.KafkaController)
[2015-07-21 19:55:53,255] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-07-21 19:55:53,255] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
