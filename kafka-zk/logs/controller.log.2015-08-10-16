[2015-08-10 16:00:42,110] INFO [Controller 2]: Broker 2 starting become controller state transition (kafka.controller.KafkaController)
[2015-08-10 16:00:42,112] INFO [Controller 2]: Initialized controller epoch to 54 and zk version 53 (kafka.controller.KafkaController)
[2015-08-10 16:00:42,118] INFO [Controller 2]: Controller 2 incremented epoch to 55 (kafka.controller.KafkaController)
[2015-08-10 16:00:42,205] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2015-08-10 16:00:42,213] INFO [Controller-2-to-broker-2-send-thread], Controller 2 connected to id:2,host:fufuka,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 16:00:42,215] INFO [Controller-2-to-broker-2-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 16:00:42,217] INFO [Controller 2]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 16:00:42,217] INFO [Controller 2]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 16:00:42,217] INFO [Controller 2]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-08-10 16:00:42,220] INFO [Controller 2]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-08-10 16:00:42,221] INFO [Controller 2]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-08-10 16:00:42,222] INFO [Controller 2]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-08-10 16:00:42,226] INFO [Controller 2]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-08-10 16:00:42,227] INFO [Controller 2]: List of topics ineligible for deletion: t3,t6,t2,t7,t1 (kafka.controller.KafkaController)
[2015-08-10 16:00:42,230] INFO [Controller 2]: Currently active brokers in the cluster: Set(2) (kafka.controller.KafkaController)
[2015-08-10 16:00:42,231] INFO [Controller 2]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 16:00:42,231] INFO [Controller 2]: Current list of topics in the cluster: Set(t4, t3, t6, t2, t7, t1) (kafka.controller.KafkaController)
[2015-08-10 16:00:42,237] INFO [Replica state machine on controller 2]: Invoking state change to OnlineReplica for replicas [Topic=t3,Partition=1,Replica=2],[Topic=t2,Partition=1,Replica=2],[Topic=t4,Partition=0,Replica=2],[Topic=t1,Partition=2,Replica=2],[Topic=t1,Partition=0,Replica=2] (kafka.controller.ReplicaStateMachine)
[2015-08-10 16:00:42,249] INFO [Replica state machine on controller 2]: Started replica state machine with initial state -> Map([Topic=t3,Partition=1,Replica=2] -> OnlineReplica, [Topic=t6,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=t2,Partition=1,Replica=2] -> OnlineReplica, [Topic=t2,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=t1,Partition=0,Replica=2] -> OnlineReplica, [Topic=t2,Partition=2,Replica=0] -> ReplicaDeletionIneligible, [Topic=t1,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=t7,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=t3,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=t4,Partition=0,Replica=2] -> OnlineReplica, [Topic=t1,Partition=2,Replica=2] -> OnlineReplica, [Topic=t3,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-08-10 16:00:42,265] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:00:42,272] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:00:42,278] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t7,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:00:42,283] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:00:42,288] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:00:42,293] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:00:42,299] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t6,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:00:42,300] INFO [Partition state machine on Controller 2]: Started partition state machine with initial state -> Map([t2,1] -> OnlinePartition, [t1,2] -> OnlinePartition, [t3,1] -> OnlinePartition, [t1,0] -> OnlinePartition, [t2,2] -> OfflinePartition, [t2,0] -> OfflinePartition, [t7,0] -> OfflinePartition, [t1,1] -> OfflinePartition, [t3,2] -> OfflinePartition, [t3,0] -> OfflinePartition, [t6,0] -> OfflinePartition, [t4,0] -> OnlinePartition) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:00:42,303] INFO [Controller 2]: Broker 2 is ready to serve as the new controller with epoch 55 (kafka.controller.KafkaController)
[2015-08-10 16:00:42,304] INFO [Controller 2]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-08-10 16:00:42,305] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-10 16:00:42,310] INFO [Controller 2]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-08-10 16:00:42,313] INFO [delete-topics-thread-2], Starting  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-10 16:00:42,314] DEBUG [Topic Deletion Manager 2], Waiting for signal to start or continue topic deletion (kafka.controller.TopicDeletionManager)
[2015-08-10 16:00:43,287] INFO [Controller 2]: Shutting down broker 2 (kafka.controller.KafkaController)
[2015-08-10 16:00:43,288] DEBUG [Controller 2]: All shutting down brokers: 2 (kafka.controller.KafkaController)
[2015-08-10 16:00:43,289] DEBUG [Controller 2]: Live brokers:  (kafka.controller.KafkaController)
[2015-08-10 16:00:43,292] TRACE [Controller 2]: All leaders = [t2,1] -> (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),[t1,2] -> (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),[t1,0] -> (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),[t3,1] -> (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),[t7,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),[t2,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),[t2,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),[t1,1] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),[t3,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),[t3,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),[t6,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),[t4,0] -> (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) (kafka.controller.KafkaController)
[2015-08-10 16:00:43,584] INFO [delete-topics-thread-2], Shutting down (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-10 16:00:43,584] INFO [delete-topics-thread-2], Shutdown completed (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-10 16:00:43,584] INFO [delete-topics-thread-2], Stopped  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-10 16:00:43,586] INFO [Partition state machine on Controller 2]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-08-10 16:00:43,586] INFO [Replica state machine on controller 2]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-08-10 16:00:43,587] INFO [Controller-2-to-broker-2-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 16:00:43,587] INFO [Controller-2-to-broker-2-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 16:00:43,587] INFO [Controller-2-to-broker-2-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 16:19:17,680] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-08-10 16:20:58,410] INFO [Controller 1]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 16:20:58,461] INFO [Controller 1]: Broker 1 starting become controller state transition (kafka.controller.KafkaController)
[2015-08-10 16:20:58,470] INFO [Controller 1]: Initialized controller epoch to 55 and zk version 54 (kafka.controller.KafkaController)
[2015-08-10 16:20:58,477] INFO [Controller 1]: Controller 1 incremented epoch to 56 (kafka.controller.KafkaController)
[2015-08-10 16:20:58,641] INFO [Controller 1]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 16:20:58,642] INFO [Controller 1]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 16:20:58,644] INFO [Controller 1]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-08-10 16:20:58,648] INFO [Controller 1]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-08-10 16:20:58,649] INFO [Controller 1]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-08-10 16:20:58,650] INFO [Controller 1]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-08-10 16:20:58,656] INFO [Controller 1]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-08-10 16:20:58,656] INFO [Controller 1]: List of topics ineligible for deletion: t4,t3,t6,t2,t7,t1 (kafka.controller.KafkaController)
[2015-08-10 16:20:58,659] INFO [Controller 1]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 16:20:58,660] INFO [Controller 1]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 16:20:58,660] INFO [Controller 1]: Current list of topics in the cluster: Set(t4, t3, t6, t2, t7, t1) (kafka.controller.KafkaController)
[2015-08-10 16:20:58,665] INFO [Replica state machine on controller 1]: Started replica state machine with initial state -> Map([Topic=t3,Partition=1,Replica=2] -> ReplicaDeletionIneligible, [Topic=t6,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=t2,Partition=1,Replica=2] -> ReplicaDeletionIneligible, [Topic=t2,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=t1,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=t2,Partition=2,Replica=0] -> ReplicaDeletionIneligible, [Topic=t1,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=t7,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=t3,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=t4,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=t1,Partition=2,Replica=2] -> ReplicaDeletionIneligible, [Topic=t3,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-08-10 16:20:58,681] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:20:58,693] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:20:58,702] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:20:58,712] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:20:58,721] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:20:58,730] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:20:58,738] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t7,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:20:58,746] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:20:58,754] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:20:58,765] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:20:58,772] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t6,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:20:58,780] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t4,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:20:58,785] INFO [Partition state machine on Controller 1]: Started partition state machine with initial state -> Map([t2,1] -> OfflinePartition, [t1,2] -> OfflinePartition, [t3,1] -> OfflinePartition, [t1,0] -> OfflinePartition, [t2,2] -> OfflinePartition, [t2,0] -> OfflinePartition, [t7,0] -> OfflinePartition, [t1,1] -> OfflinePartition, [t3,2] -> OfflinePartition, [t3,0] -> OfflinePartition, [t6,0] -> OfflinePartition, [t4,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:20:58,793] INFO [Controller 1]: Broker 1 is ready to serve as the new controller with epoch 56 (kafka.controller.KafkaController)
[2015-08-10 16:20:58,795] INFO [Controller 1]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-08-10 16:20:58,796] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-10 16:20:58,805] INFO [Controller 1]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-08-10 16:20:58,807] INFO [Controller 1]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 16:20:58,807] INFO [delete-topics-thread-1], Starting  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-10 16:20:58,808] DEBUG [Topic Deletion Manager 1], Waiting for signal to start or continue topic deletion (kafka.controller.TopicDeletionManager)
[2015-08-10 16:20:58,820] INFO [BrokerChangeListener on Controller 1]: Broker change listener fired for path /brokers/ids with children 1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 16:20:58,842] INFO [BrokerChangeListener on Controller 1]: Newly added brokers: 1, deleted brokers: , all live brokers: 1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 16:20:58,843] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2015-08-10 16:20:58,849] INFO [Controller-1-to-broker-1-send-thread], Controller 1 connected to id:1,host:fufuka,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 16:20:58,850] INFO [Controller-1-to-broker-1-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 16:20:58,851] INFO [Controller 1]: New broker startup callback for 1 (kafka.controller.KafkaController)
[2015-08-10 16:20:58,868] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:20:58,875] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:20:58,883] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:20:58,892] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:20:58,901] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:20:58,908] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:20:58,915] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t7,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:20:58,923] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:20:58,931] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:20:58,938] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:20:58,945] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t6,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:20:58,951] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t4,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:21:03,808] TRACE [Controller 1]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 16:21:03,814] DEBUG [Controller 1]: preferred replicas by broker Map(2 -> Map([t2,1] -> List(2), [t1,2] -> List(2), [t3,1] -> List(2), [t1,0] -> List(2), [t4,0] -> List(2)), 0 -> Map([t2,2] -> List(0), [t2,0] -> List(0), [t7,0] -> List(0), [t1,1] -> List(0), [t3,2] -> List(0), [t3,0] -> List(0), [t6,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 16:21:03,816] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 16:21:03,818] TRACE [Controller 1]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 16:21:03,818] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 16:21:03,818] TRACE [Controller 1]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 16:21:26,549] INFO [Controller 2]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 16:21:26,578] INFO [Controller 2]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 16:21:26,605] INFO [BrokerChangeListener on Controller 1]: Broker change listener fired for path /brokers/ids with children 1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 16:21:26,616] INFO [BrokerChangeListener on Controller 1]: Newly added brokers: 2, deleted brokers: , all live brokers: 1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 16:21:26,616] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2015-08-10 16:21:26,616] INFO [Controller-1-to-broker-2-send-thread], Controller 1 connected to id:2,host:fufuka,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 16:21:26,617] INFO [Controller 1]: New broker startup callback for 2 (kafka.controller.KafkaController)
[2015-08-10 16:21:26,617] INFO [Controller-1-to-broker-2-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 16:21:26,621] INFO [Replica state machine on controller 1]: Invoking state change to OnlineReplica for replicas [Topic=t3,Partition=1,Replica=2],[Topic=t2,Partition=1,Replica=2],[Topic=t4,Partition=0,Replica=2],[Topic=t1,Partition=2,Replica=2],[Topic=t1,Partition=0,Replica=2] (kafka.controller.ReplicaStateMachine)
[2015-08-10 16:21:26,646] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t2,1]. Select 2 from ISR 2 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:21:26,647] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":47,"isr":[2]} for offline partition [t2,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:21:26,655] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t2,1] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56), [t1,2] -> (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54), [t3,1] -> (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54), [t1,0] -> (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54), [t2,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t2,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t7,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t6,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t4,0] -> (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54)) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:21:26,659] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t1,2]. Select 2 from ISR 2 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:21:26,659] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":47,"isr":[2]} for offline partition [t1,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:21:26,662] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t2,1] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56), [t1,2] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56), [t3,1] -> (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54), [t1,0] -> (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54), [t2,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t2,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t7,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t6,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t4,0] -> (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54)) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:21:26,666] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t3,1]. Select 2 from ISR 2 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:21:26,666] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":47,"isr":[2]} for offline partition [t3,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:21:26,669] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t2,1] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56), [t1,2] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56), [t3,1] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56), [t1,0] -> (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54), [t2,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t2,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t7,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t6,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t4,0] -> (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54)) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:21:26,672] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t1,0]. Select 2 from ISR 2 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:21:26,672] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":47,"isr":[2]} for offline partition [t1,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:21:26,675] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t2,1] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56), [t1,2] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56), [t3,1] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56), [t1,0] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56), [t2,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t2,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t7,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t6,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t4,0] -> (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54)) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:21:26,681] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:21:26,687] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:21:26,695] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t7,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:21:26,702] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:21:26,708] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:21:26,716] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:21:26,724] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t6,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:21:26,728] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t4,0]. Select 2 from ISR 2 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:21:26,728] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":47,"isr":[2]} for offline partition [t4,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:21:26,730] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t2,1] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56), [t1,2] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56), [t3,1] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56), [t1,0] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56), [t2,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t2,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t7,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t6,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t4,0] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56)) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:24:04,867] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-08-10 16:24:33,990] INFO [Controller 1]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 16:24:34,016] INFO [Controller 1]: Broker 1 starting become controller state transition (kafka.controller.KafkaController)
[2015-08-10 16:24:34,022] INFO [Controller 1]: Initialized controller epoch to 56 and zk version 55 (kafka.controller.KafkaController)
[2015-08-10 16:24:34,028] INFO [Controller 1]: Controller 1 incremented epoch to 57 (kafka.controller.KafkaController)
[2015-08-10 16:24:34,160] INFO [Controller 1]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 16:24:34,160] INFO [Controller 1]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 16:24:34,161] INFO [Controller 1]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-08-10 16:24:34,165] INFO [Controller 1]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-08-10 16:24:34,165] INFO [Controller 1]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-08-10 16:24:34,167] INFO [Controller 1]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-08-10 16:24:34,172] INFO [Controller 1]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-08-10 16:24:34,173] INFO [Controller 1]: List of topics ineligible for deletion: t4,t3,t6,t2,t7,t1 (kafka.controller.KafkaController)
[2015-08-10 16:24:34,176] INFO [Controller 1]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 16:24:34,177] INFO [Controller 1]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 16:24:34,177] INFO [Controller 1]: Current list of topics in the cluster: Set(t4, t3, t6, t2, t7, t1) (kafka.controller.KafkaController)
[2015-08-10 16:24:34,185] INFO [Replica state machine on controller 1]: Started replica state machine with initial state -> Map([Topic=t3,Partition=1,Replica=2] -> ReplicaDeletionIneligible, [Topic=t6,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=t2,Partition=1,Replica=2] -> ReplicaDeletionIneligible, [Topic=t2,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=t1,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=t2,Partition=2,Replica=0] -> ReplicaDeletionIneligible, [Topic=t1,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=t7,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=t3,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=t4,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=t1,Partition=2,Replica=2] -> ReplicaDeletionIneligible, [Topic=t3,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-08-10 16:24:34,204] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:24:34,223] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:24:34,238] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:24:34,249] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:24:34,262] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:24:34,272] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:24:34,282] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t7,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:24:34,292] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:24:34,301] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:24:34,313] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:24:34,322] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t6,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:24:34,333] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t4,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:24:34,339] INFO [Partition state machine on Controller 1]: Started partition state machine with initial state -> Map([t2,1] -> OfflinePartition, [t1,2] -> OfflinePartition, [t3,1] -> OfflinePartition, [t1,0] -> OfflinePartition, [t2,2] -> OfflinePartition, [t2,0] -> OfflinePartition, [t7,0] -> OfflinePartition, [t1,1] -> OfflinePartition, [t3,2] -> OfflinePartition, [t3,0] -> OfflinePartition, [t6,0] -> OfflinePartition, [t4,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:24:34,347] INFO [Controller 1]: Broker 1 is ready to serve as the new controller with epoch 57 (kafka.controller.KafkaController)
[2015-08-10 16:24:34,349] INFO [Controller 1]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-08-10 16:24:34,350] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-10 16:24:34,363] INFO [Controller 1]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-08-10 16:24:34,365] INFO [Controller 1]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 16:24:34,367] INFO [delete-topics-thread-1], Starting  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-10 16:24:34,370] DEBUG [Topic Deletion Manager 1], Waiting for signal to start or continue topic deletion (kafka.controller.TopicDeletionManager)
[2015-08-10 16:24:34,394] INFO [BrokerChangeListener on Controller 1]: Broker change listener fired for path /brokers/ids with children 1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 16:24:34,440] INFO [BrokerChangeListener on Controller 1]: Newly added brokers: 1, deleted brokers: , all live brokers: 1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 16:24:34,442] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2015-08-10 16:24:34,448] INFO [Controller-1-to-broker-1-send-thread], Controller 1 connected to id:1,host:fufuka,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 16:24:34,449] INFO [Controller-1-to-broker-1-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 16:24:34,450] INFO [Controller 1]: New broker startup callback for 1 (kafka.controller.KafkaController)
[2015-08-10 16:24:34,476] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:24:34,486] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:24:34,496] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:24:34,512] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:24:34,524] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:24:34,550] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:24:34,558] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t7,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:24:34,566] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:24:34,573] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:24:34,581] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:24:34,588] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t6,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:24:34,596] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t4,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:24:39,368] TRACE [Controller 1]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 16:24:39,377] DEBUG [Controller 1]: preferred replicas by broker Map(2 -> Map([t2,1] -> List(2), [t1,2] -> List(2), [t3,1] -> List(2), [t1,0] -> List(2), [t4,0] -> List(2)), 0 -> Map([t2,2] -> List(0), [t2,0] -> List(0), [t7,0] -> List(0), [t1,1] -> List(0), [t3,2] -> List(0), [t3,0] -> List(0), [t6,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 16:24:39,380] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 16:24:39,382] TRACE [Controller 1]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 16:24:39,382] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 16:24:39,382] TRACE [Controller 1]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 16:25:09,957] INFO [Controller 2]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 16:25:09,975] INFO [Controller 2]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 16:25:09,993] INFO [BrokerChangeListener on Controller 1]: Broker change listener fired for path /brokers/ids with children 1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 16:25:10,002] INFO [BrokerChangeListener on Controller 1]: Newly added brokers: 2, deleted brokers: , all live brokers: 1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 16:25:10,002] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2015-08-10 16:25:10,008] INFO [Controller-1-to-broker-2-send-thread], Controller 1 connected to id:2,host:fufuka,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 16:25:10,008] INFO [Controller 1]: New broker startup callback for 2 (kafka.controller.KafkaController)
[2015-08-10 16:25:10,008] INFO [Controller-1-to-broker-2-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 16:25:10,011] INFO [Replica state machine on controller 1]: Invoking state change to OnlineReplica for replicas [Topic=t3,Partition=1,Replica=2],[Topic=t2,Partition=1,Replica=2],[Topic=t4,Partition=0,Replica=2],[Topic=t1,Partition=2,Replica=2],[Topic=t1,Partition=0,Replica=2] (kafka.controller.ReplicaStateMachine)
[2015-08-10 16:25:10,057] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t2,1]. Select 2 from ISR 2 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:25:10,058] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":48,"isr":[2]} for offline partition [t2,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:25:10,065] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t2,1] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57), [t1,2] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56), [t3,1] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56), [t1,0] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56), [t2,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t2,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t7,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t6,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t4,0] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56)) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:25:10,069] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t1,2]. Select 2 from ISR 2 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:25:10,069] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":48,"isr":[2]} for offline partition [t1,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:25:10,074] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t2,1] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57), [t1,2] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57), [t3,1] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56), [t1,0] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56), [t2,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t2,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t7,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t6,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t4,0] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56)) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:25:10,081] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t3,1]. Select 2 from ISR 2 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:25:10,081] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":48,"isr":[2]} for offline partition [t3,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:25:10,084] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t2,1] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57), [t1,2] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57), [t3,1] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57), [t1,0] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56), [t2,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t2,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t7,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t6,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t4,0] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56)) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:25:10,088] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t1,0]. Select 2 from ISR 2 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:25:10,089] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":48,"isr":[2]} for offline partition [t1,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:25:10,091] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t2,1] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57), [t1,2] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57), [t3,1] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57), [t1,0] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57), [t2,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t2,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t7,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t6,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t4,0] -> (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56)) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:25:10,100] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:25:10,108] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:25:10,121] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t7,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:25:10,127] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:25:10,133] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:25:10,139] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:25:10,149] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t6,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:25:10,153] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t4,0]. Select 2 from ISR 2 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:25:10,153] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":48,"isr":[2]} for offline partition [t4,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:25:10,155] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t2,1] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57), [t1,2] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57), [t3,1] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57), [t1,0] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57), [t2,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t2,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t7,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t6,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t4,0] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57)) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:29:39,362] TRACE [Controller 1]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 16:29:39,363] DEBUG [Controller 1]: preferred replicas by broker Map(2 -> Map([t2,1] -> List(2), [t1,2] -> List(2), [t3,1] -> List(2), [t1,0] -> List(2), [t4,0] -> List(2)), 0 -> Map([t2,2] -> List(0), [t2,0] -> List(0), [t7,0] -> List(0), [t1,1] -> List(0), [t3,2] -> List(0), [t3,0] -> List(0), [t6,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 16:29:39,363] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 16:29:39,363] TRACE [Controller 1]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 16:29:39,363] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 16:29:39,363] TRACE [Controller 1]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 16:34:39,354] TRACE [Controller 1]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 16:34:39,355] DEBUG [Controller 1]: preferred replicas by broker Map(2 -> Map([t2,1] -> List(2), [t1,2] -> List(2), [t3,1] -> List(2), [t1,0] -> List(2), [t4,0] -> List(2)), 0 -> Map([t2,2] -> List(0), [t2,0] -> List(0), [t7,0] -> List(0), [t1,1] -> List(0), [t3,2] -> List(0), [t3,0] -> List(0), [t6,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 16:34:39,355] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 16:34:39,355] TRACE [Controller 1]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 16:34:39,355] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 16:34:39,355] TRACE [Controller 1]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 16:35:18,250] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-08-10 16:38:16,961] INFO [Controller 2]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 16:38:16,994] INFO [Controller 2]: Broker 2 starting become controller state transition (kafka.controller.KafkaController)
[2015-08-10 16:38:17,004] INFO [Controller 2]: Initialized controller epoch to 57 and zk version 56 (kafka.controller.KafkaController)
[2015-08-10 16:38:17,011] INFO [Controller 2]: Controller 2 incremented epoch to 58 (kafka.controller.KafkaController)
[2015-08-10 16:38:17,141] INFO [Controller 2]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 16:38:17,142] INFO [Controller 2]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 16:38:17,142] INFO [Controller 2]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-08-10 16:38:17,147] INFO [Controller 2]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-08-10 16:38:17,148] INFO [Controller 2]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-08-10 16:38:17,149] INFO [Controller 2]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-08-10 16:38:17,155] INFO [Controller 2]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-08-10 16:38:17,156] INFO [Controller 2]: List of topics ineligible for deletion: t4,t3,t6,t2,t7,t1 (kafka.controller.KafkaController)
[2015-08-10 16:38:17,159] INFO [Controller 2]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 16:38:17,160] INFO [Controller 2]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 16:38:17,160] INFO [Controller 2]: Current list of topics in the cluster: Set(t4, t3, t6, t2, t7, t1) (kafka.controller.KafkaController)
[2015-08-10 16:38:17,167] INFO [Replica state machine on controller 2]: Started replica state machine with initial state -> Map([Topic=t3,Partition=1,Replica=2] -> ReplicaDeletionIneligible, [Topic=t6,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=t2,Partition=1,Replica=2] -> ReplicaDeletionIneligible, [Topic=t2,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=t1,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=t2,Partition=2,Replica=0] -> ReplicaDeletionIneligible, [Topic=t1,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=t7,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=t3,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=t4,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=t1,Partition=2,Replica=2] -> ReplicaDeletionIneligible, [Topic=t3,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-08-10 16:38:17,182] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,195] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,206] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,215] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,225] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,234] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,243] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t7,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,253] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,262] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,270] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,278] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t6,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,286] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t4,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,291] INFO [Partition state machine on Controller 2]: Started partition state machine with initial state -> Map([t2,1] -> OfflinePartition, [t1,2] -> OfflinePartition, [t3,1] -> OfflinePartition, [t1,0] -> OfflinePartition, [t2,2] -> OfflinePartition, [t2,0] -> OfflinePartition, [t7,0] -> OfflinePartition, [t1,1] -> OfflinePartition, [t3,2] -> OfflinePartition, [t3,0] -> OfflinePartition, [t6,0] -> OfflinePartition, [t4,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:38:17,297] INFO [Controller 2]: Broker 2 is ready to serve as the new controller with epoch 58 (kafka.controller.KafkaController)
[2015-08-10 16:38:17,298] INFO [Controller 2]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-08-10 16:38:17,299] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-10 16:38:17,306] INFO [Controller 2]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-08-10 16:38:17,307] INFO [Controller 2]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 16:38:17,307] INFO [delete-topics-thread-2], Starting  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-10 16:38:17,308] DEBUG [Topic Deletion Manager 2], Waiting for signal to start or continue topic deletion (kafka.controller.TopicDeletionManager)
[2015-08-10 16:38:17,326] INFO [BrokerChangeListener on Controller 2]: Broker change listener fired for path /brokers/ids with children 2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 16:38:17,351] INFO [BrokerChangeListener on Controller 2]: Newly added brokers: 2, deleted brokers: , all live brokers: 2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 16:38:17,352] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2015-08-10 16:38:17,359] INFO [Controller-2-to-broker-2-send-thread], Controller 2 connected to id:2,host:fufuka,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 16:38:17,360] INFO [Controller-2-to-broker-2-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 16:38:17,361] INFO [Controller 2]: New broker startup callback for 2 (kafka.controller.KafkaController)
[2015-08-10 16:38:17,372] INFO [Replica state machine on controller 2]: Invoking state change to OnlineReplica for replicas [Topic=t3,Partition=1,Replica=2],[Topic=t2,Partition=1,Replica=2],[Topic=t4,Partition=0,Replica=2],[Topic=t1,Partition=2,Replica=2],[Topic=t1,Partition=0,Replica=2] (kafka.controller.ReplicaStateMachine)
[2015-08-10 16:38:17,393] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t2,1]. Select 2 from ISR 2 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,394] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":49,"isr":[2]} for offline partition [t2,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,401] DEBUG [Partition state machine on Controller 2]: After leader election, leader cache is updated to Map([t2,1] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58), [t1,2] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57), [t3,1] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57), [t1,0] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57), [t2,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t2,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t7,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t6,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t4,0] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57)) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:38:17,407] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t1,2]. Select 2 from ISR 2 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,407] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":49,"isr":[2]} for offline partition [t1,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,410] DEBUG [Partition state machine on Controller 2]: After leader election, leader cache is updated to Map([t2,1] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58), [t1,2] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58), [t3,1] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57), [t1,0] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57), [t2,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t2,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t7,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t6,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t4,0] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57)) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:38:17,414] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t3,1]. Select 2 from ISR 2 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,414] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":49,"isr":[2]} for offline partition [t3,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,419] DEBUG [Partition state machine on Controller 2]: After leader election, leader cache is updated to Map([t2,1] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58), [t1,2] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58), [t3,1] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58), [t1,0] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57), [t2,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t2,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t7,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t6,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t4,0] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57)) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:38:17,424] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t1,0]. Select 2 from ISR 2 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,424] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":49,"isr":[2]} for offline partition [t1,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,429] DEBUG [Partition state machine on Controller 2]: After leader election, leader cache is updated to Map([t2,1] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58), [t1,2] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58), [t3,1] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58), [t1,0] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58), [t2,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t2,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t7,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t6,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t4,0] -> (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57)) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:38:17,436] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,444] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,451] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t7,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,458] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,465] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,473] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,480] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t6,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,486] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t4,0]. Select 2 from ISR 2 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,486] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":49,"isr":[2]} for offline partition [t4,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:17,489] DEBUG [Partition state machine on Controller 2]: After leader election, leader cache is updated to Map([t2,1] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58), [t1,2] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58), [t3,1] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58), [t1,0] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58), [t2,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t2,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t7,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t6,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t4,0] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58)) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:38:22,308] TRACE [Controller 2]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 16:38:22,313] DEBUG [Controller 2]: preferred replicas by broker Map(2 -> Map([t2,1] -> List(2), [t1,2] -> List(2), [t3,1] -> List(2), [t1,0] -> List(2), [t4,0] -> List(2)), 0 -> Map([t2,2] -> List(0), [t2,0] -> List(0), [t7,0] -> List(0), [t1,1] -> List(0), [t3,2] -> List(0), [t3,0] -> List(0), [t6,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 16:38:22,315] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 16:38:22,316] TRACE [Controller 2]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 16:38:22,316] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 16:38:22,316] TRACE [Controller 2]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 16:38:38,334] INFO [Controller 1]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 16:38:38,348] INFO [Controller 1]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 16:38:38,361] INFO [BrokerChangeListener on Controller 2]: Broker change listener fired for path /brokers/ids with children 1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 16:38:38,369] INFO [BrokerChangeListener on Controller 2]: Newly added brokers: 1, deleted brokers: , all live brokers: 1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 16:38:38,369] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2015-08-10 16:38:38,370] INFO [Controller-2-to-broker-1-send-thread], Controller 2 connected to id:1,host:fufuka,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 16:38:38,370] INFO [Controller 2]: New broker startup callback for 1 (kafka.controller.KafkaController)
[2015-08-10 16:38:38,373] INFO [Controller-2-to-broker-1-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 16:38:38,382] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:38,389] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:38,394] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t7,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:38,402] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:38,409] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:38,416] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:38:38,430] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t6,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:42:34,230] INFO [Controller 2]: Shutting down broker 1 (kafka.controller.KafkaController)
[2015-08-10 16:42:34,230] DEBUG [Controller 2]: All shutting down brokers: 1 (kafka.controller.KafkaController)
[2015-08-10 16:42:34,231] DEBUG [Controller 2]: Live brokers: 2 (kafka.controller.KafkaController)
[2015-08-10 16:42:34,234] TRACE [Controller 2]: All leaders = [t2,1] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58),[t1,2] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58),[t1,0] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58),[t3,1] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58),[t7,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),[t2,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),[t2,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),[t1,1] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),[t3,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),[t3,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),[t6,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),[t4,0] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58) (kafka.controller.KafkaController)
[2015-08-10 16:42:34,572] INFO [BrokerChangeListener on Controller 2]: Broker change listener fired for path /brokers/ids with children 2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 16:42:34,574] INFO [BrokerChangeListener on Controller 2]: Newly added brokers: , deleted brokers: 1, all live brokers: 2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 16:42:34,575] INFO [Controller-2-to-broker-1-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 16:42:34,576] INFO [Controller-2-to-broker-1-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 16:42:34,576] INFO [Controller-2-to-broker-1-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 16:42:34,577] INFO [Controller 2]: Broker failure callback for 1 (kafka.controller.KafkaController)
[2015-08-10 16:42:34,577] INFO [Controller 2]: Removed ArrayBuffer(1) from list of shutting down brokers. (kafka.controller.KafkaController)
[2015-08-10 16:42:34,578] INFO [Partition state machine on Controller 2]: Invoking state change to OfflinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-10 16:42:34,581] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:42:34,586] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:42:34,592] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t7,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:42:34,604] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:42:34,608] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:42:34,611] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:42:34,614] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t6,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:42:35,982] INFO [Controller 2]: Shutting down broker 2 (kafka.controller.KafkaController)
[2015-08-10 16:42:35,982] DEBUG [Controller 2]: All shutting down brokers: 2 (kafka.controller.KafkaController)
[2015-08-10 16:42:35,982] DEBUG [Controller 2]: Live brokers:  (kafka.controller.KafkaController)
[2015-08-10 16:42:35,983] TRACE [Controller 2]: All leaders = [t2,1] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58),[t1,2] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58),[t1,0] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58),[t3,1] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58),[t7,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),[t2,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),[t2,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),[t1,1] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),[t3,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),[t3,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),[t6,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),[t4,0] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58) (kafka.controller.KafkaController)
[2015-08-10 16:42:36,195] INFO [delete-topics-thread-2], Shutting down (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-10 16:42:36,195] INFO [delete-topics-thread-2], Stopped  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-10 16:42:36,195] INFO [delete-topics-thread-2], Shutdown completed (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-10 16:42:36,197] INFO [Partition state machine on Controller 2]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-08-10 16:42:36,197] INFO [Replica state machine on controller 2]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-08-10 16:42:36,197] INFO [Controller-2-to-broker-2-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-10 16:42:36,197] INFO [Controller-2-to-broker-2-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-10 16:42:36,197] INFO [Controller-2-to-broker-2-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-10 16:53:40,509] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-08-10 16:53:56,864] INFO [Controller 1]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 16:53:56,888] INFO [Controller 1]: Broker 1 starting become controller state transition (kafka.controller.KafkaController)
[2015-08-10 16:53:56,893] INFO [Controller 1]: Initialized controller epoch to 59 and zk version 58 (kafka.controller.KafkaController)
[2015-08-10 16:53:56,898] INFO [Controller 1]: Controller 1 incremented epoch to 60 (kafka.controller.KafkaController)
[2015-08-10 16:53:57,040] INFO [Controller 1]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 16:53:57,041] INFO [Controller 1]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-08-10 16:53:57,041] INFO [Controller 1]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-08-10 16:53:57,045] INFO [Controller 1]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-08-10 16:53:57,046] INFO [Controller 1]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-08-10 16:53:57,047] INFO [Controller 1]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-08-10 16:53:57,052] INFO [Controller 1]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-08-10 16:53:57,053] INFO [Controller 1]: List of topics ineligible for deletion: t4,t3,t6,t2,t7,t1 (kafka.controller.KafkaController)
[2015-08-10 16:53:57,056] INFO [Controller 1]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 16:53:57,057] INFO [Controller 1]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-10 16:53:57,057] INFO [Controller 1]: Current list of topics in the cluster: Set(t4, t3, t6, t2, t7, t1) (kafka.controller.KafkaController)
[2015-08-10 16:53:57,065] INFO [Replica state machine on controller 1]: Started replica state machine with initial state -> Map([Topic=t3,Partition=1,Replica=2] -> ReplicaDeletionIneligible, [Topic=t6,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=t2,Partition=1,Replica=2] -> ReplicaDeletionIneligible, [Topic=t2,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=t1,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=t2,Partition=2,Replica=0] -> ReplicaDeletionIneligible, [Topic=t1,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=t7,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=t3,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=t4,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=t1,Partition=2,Replica=2] -> ReplicaDeletionIneligible, [Topic=t3,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-08-10 16:53:57,080] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:53:57,095] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:53:57,106] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:53:57,117] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:53:57,127] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:53:57,138] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:53:57,147] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t7,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:53:57,156] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:53:57,167] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:53:57,177] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:53:57,188] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t6,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:53:57,199] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t4,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:53:57,204] INFO [Partition state machine on Controller 1]: Started partition state machine with initial state -> Map([t2,1] -> OfflinePartition, [t1,2] -> OfflinePartition, [t3,1] -> OfflinePartition, [t1,0] -> OfflinePartition, [t2,2] -> OfflinePartition, [t2,0] -> OfflinePartition, [t7,0] -> OfflinePartition, [t1,1] -> OfflinePartition, [t3,2] -> OfflinePartition, [t3,0] -> OfflinePartition, [t6,0] -> OfflinePartition, [t4,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:53:57,213] INFO [Controller 1]: Broker 1 is ready to serve as the new controller with epoch 60 (kafka.controller.KafkaController)
[2015-08-10 16:53:57,215] INFO [Controller 1]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-08-10 16:53:57,216] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-10 16:53:57,234] INFO [Controller 1]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-08-10 16:53:57,236] INFO [Controller 1]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 16:53:57,236] INFO [delete-topics-thread-1], Starting  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-10 16:53:57,237] DEBUG [Topic Deletion Manager 1], Waiting for signal to start or continue topic deletion (kafka.controller.TopicDeletionManager)
[2015-08-10 16:53:57,254] INFO [BrokerChangeListener on Controller 1]: Broker change listener fired for path /brokers/ids with children 1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 16:53:57,282] INFO [BrokerChangeListener on Controller 1]: Newly added brokers: 1, deleted brokers: , all live brokers: 1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 16:53:57,284] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2015-08-10 16:53:57,291] INFO [Controller-1-to-broker-1-send-thread], Controller 1 connected to id:1,host:fufuka,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 16:53:57,292] INFO [Controller-1-to-broker-1-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 16:53:57,293] INFO [Controller 1]: New broker startup callback for 1 (kafka.controller.KafkaController)
[2015-08-10 16:53:57,320] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:53:57,332] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:53:57,343] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:53:57,356] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:53:57,365] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:53:57,383] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:53:57,395] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t7,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:53:57,405] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:53:57,414] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:53:57,425] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:53:57,433] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t6,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:53:57,439] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t4,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:54:02,135] INFO [Controller 2]: Controller starting up (kafka.controller.KafkaController)
[2015-08-10 16:54:02,155] INFO [Controller 2]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-10 16:54:02,169] INFO [BrokerChangeListener on Controller 1]: Broker change listener fired for path /brokers/ids with children 1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 16:54:02,182] INFO [BrokerChangeListener on Controller 1]: Newly added brokers: 2, deleted brokers: , all live brokers: 1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-10 16:54:02,182] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2015-08-10 16:54:02,182] INFO [Controller-1-to-broker-2-send-thread], Controller 1 connected to id:2,host:fufuka,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-10 16:54:02,183] INFO [Controller 1]: New broker startup callback for 2 (kafka.controller.KafkaController)
[2015-08-10 16:54:02,184] INFO [Controller-1-to-broker-2-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-10 16:54:02,186] INFO [Replica state machine on controller 1]: Invoking state change to OnlineReplica for replicas [Topic=t3,Partition=1,Replica=2],[Topic=t2,Partition=1,Replica=2],[Topic=t4,Partition=0,Replica=2],[Topic=t1,Partition=2,Replica=2],[Topic=t1,Partition=0,Replica=2] (kafka.controller.ReplicaStateMachine)
[2015-08-10 16:54:02,218] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,1]. Pick the leader from the alive assigned replicas: 2 (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:54:02,218] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,1]. Elect leader 2 from live brokers 2. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:54:02,220] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":52,"isr":[2]} for offline partition [t2,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:54:02,227] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t2,1] -> (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60), [t1,2] -> (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59), [t3,1] -> (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59), [t1,0] -> (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59), [t2,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t2,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t7,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t6,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t4,0] -> (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59)) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:54:02,234] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,2]. Pick the leader from the alive assigned replicas: 2 (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:54:02,234] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,2]. Elect leader 2 from live brokers 2. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:54:02,234] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":52,"isr":[2]} for offline partition [t1,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:54:02,237] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t2,1] -> (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60), [t1,2] -> (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60), [t3,1] -> (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59), [t1,0] -> (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59), [t2,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t2,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t7,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t6,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t4,0] -> (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59)) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:54:02,245] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,1]. Pick the leader from the alive assigned replicas: 2 (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:54:02,245] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,1]. Elect leader 2 from live brokers 2. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:54:02,246] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":52,"isr":[2]} for offline partition [t3,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:54:02,251] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t2,1] -> (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60), [t1,2] -> (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60), [t3,1] -> (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60), [t1,0] -> (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59), [t2,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t2,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t7,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t6,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t4,0] -> (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59)) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:54:02,261] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,0]. Pick the leader from the alive assigned replicas: 2 (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:54:02,261] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,0]. Elect leader 2 from live brokers 2. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:54:02,261] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":52,"isr":[2]} for offline partition [t1,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:54:02,267] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t2,1] -> (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60), [t1,2] -> (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60), [t3,1] -> (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60), [t1,0] -> (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60), [t2,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t2,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t7,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t6,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t4,0] -> (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59)) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:54:02,276] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:54:02,288] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:54:02,294] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t7,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:54:02,301] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:54:02,311] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:54:02,317] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:54:02,326] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t6,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:54:02,334] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t4,0]. Pick the leader from the alive assigned replicas: 2 (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:54:02,334] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t4,0]. Elect leader 2 from live brokers 2. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:54:02,334] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":52,"isr":[2]} for offline partition [t4,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-10 16:54:02,338] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t2,1] -> (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60), [t1,2] -> (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60), [t3,1] -> (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60), [t1,0] -> (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60), [t2,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t2,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t7,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t1,1] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,2] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t3,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t6,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54), [t4,0] -> (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60)) (kafka.controller.PartitionStateMachine)
[2015-08-10 16:54:02,344] TRACE [Controller 1]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 16:54:02,349] DEBUG [Controller 1]: preferred replicas by broker Map(2 -> Map([t2,1] -> List(2), [t1,2] -> List(2), [t3,1] -> List(2), [t1,0] -> List(2), [t4,0] -> List(2)), 0 -> Map([t2,2] -> List(0), [t2,0] -> List(0), [t7,0] -> List(0), [t1,1] -> List(0), [t3,2] -> List(0), [t3,0] -> List(0), [t6,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 16:54:02,352] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 16:54:02,353] TRACE [Controller 1]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 16:54:02,353] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 16:54:02,354] TRACE [Controller 1]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 16:59:02,230] TRACE [Controller 1]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-10 16:59:02,231] DEBUG [Controller 1]: preferred replicas by broker Map(2 -> Map([t2,1] -> List(2), [t1,2] -> List(2), [t3,1] -> List(2), [t1,0] -> List(2), [t4,0] -> List(2)), 0 -> Map([t2,2] -> List(0), [t2,0] -> List(0), [t7,0] -> List(0), [t1,1] -> List(0), [t3,2] -> List(0), [t3,0] -> List(0), [t6,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-10 16:59:02,231] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 16:59:02,231] TRACE [Controller 1]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-10 16:59:02,231] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-10 16:59:02,231] TRACE [Controller 1]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
