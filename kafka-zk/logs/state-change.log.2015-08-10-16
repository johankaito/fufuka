[2015-08-10 16:00:42,243] TRACE Controller 2 epoch 55 changed state of replica 2 for partition [t3,1] from OnlineReplica to OnlineReplica (state.change.logger)
[2015-08-10 16:00:42,244] TRACE Controller 2 epoch 55 changed state of replica 2 for partition [t2,1] from OnlineReplica to OnlineReplica (state.change.logger)
[2015-08-10 16:00:42,244] TRACE Controller 2 epoch 55 changed state of replica 2 for partition [t4,0] from OnlineReplica to OnlineReplica (state.change.logger)
[2015-08-10 16:00:42,244] TRACE Controller 2 epoch 55 changed state of replica 2 for partition [t1,2] from OnlineReplica to OnlineReplica (state.change.logger)
[2015-08-10 16:00:42,244] TRACE Controller 2 epoch 55 changed state of replica 2 for partition [t1,0] from OnlineReplica to OnlineReplica (state.change.logger)
[2015-08-10 16:00:42,246] TRACE Controller 2 epoch 55 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 0 to broker 2 for partition [t2,1] (state.change.logger)
[2015-08-10 16:00:42,246] TRACE Controller 2 epoch 55 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 0 to broker 2 for partition [t3,1] (state.change.logger)
[2015-08-10 16:00:42,246] TRACE Controller 2 epoch 55 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 0 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-10 16:00:42,247] TRACE Controller 2 epoch 55 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 0 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-10 16:00:42,247] TRACE Controller 2 epoch 55 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 0 to broker 2 for partition [t1,2] (state.change.logger)
[2015-08-10 16:00:42,248] TRACE Controller 2 epoch 55 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 0 to broker 2 for partition [t2,1] (state.change.logger)
[2015-08-10 16:00:42,248] TRACE Controller 2 epoch 55 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 0 to broker 2 for partition [t3,1] (state.change.logger)
[2015-08-10 16:00:42,248] TRACE Controller 2 epoch 55 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 0 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-10 16:00:42,248] TRACE Controller 2 epoch 55 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 0 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-10 16:00:42,248] TRACE Controller 2 epoch 55 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 0 to broker 2 for partition [t1,2] (state.change.logger)
[2015-08-10 16:00:42,250] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) correlation id 0 from controller 2 epoch 55 for partition [t2,1] (state.change.logger)
[2015-08-10 16:00:42,251] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) correlation id 0 from controller 2 epoch 55 for partition [t3,1] (state.change.logger)
[2015-08-10 16:00:42,251] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) correlation id 0 from controller 2 epoch 55 for partition [t1,0] (state.change.logger)
[2015-08-10 16:00:42,251] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) correlation id 0 from controller 2 epoch 55 for partition [t4,0] (state.change.logger)
[2015-08-10 16:00:42,251] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) correlation id 0 from controller 2 epoch 55 for partition [t1,2] (state.change.logger)
[2015-08-10 16:00:42,252] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 55 for partition [t2,1] since its associated leader epoch 46 is old. Current leader epoch is 46 (state.change.logger)
[2015-08-10 16:00:42,252] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 55 for partition [t3,1] since its associated leader epoch 46 is old. Current leader epoch is 46 (state.change.logger)
[2015-08-10 16:00:42,252] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 55 for partition [t1,0] since its associated leader epoch 46 is old. Current leader epoch is 46 (state.change.logger)
[2015-08-10 16:00:42,252] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 55 for partition [t4,0] since its associated leader epoch 46 is old. Current leader epoch is 46 (state.change.logger)
[2015-08-10 16:00:42,252] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 55 for partition [t1,2] since its associated leader epoch 46 is old. Current leader epoch is 46 (state.change.logger)
[2015-08-10 16:00:42,255] TRACE Controller 2 epoch 55 started leader election for partition [t2,2] (state.change.logger)
[2015-08-10 16:00:42,256] TRACE Controller 2 epoch 55 received response LeaderAndIsrResponse(0,Map((t2,1) -> 13, (t1,2) -> 13, (t3,1) -> 13, (t1,0) -> 13, (t4,0) -> 13),0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-10 16:00:42,261] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t2,1] in response to UpdateMetadata request sent by controller 2 epoch 55 with correlation id 0 (state.change.logger)
[2015-08-10 16:00:42,262] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t3,1] in response to UpdateMetadata request sent by controller 2 epoch 55 with correlation id 0 (state.change.logger)
[2015-08-10 16:00:42,262] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 2 epoch 55 with correlation id 0 (state.change.logger)
[2015-08-10 16:00:42,262] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t4,0] in response to UpdateMetadata request sent by controller 2 epoch 55 with correlation id 0 (state.change.logger)
[2015-08-10 16:00:42,262] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t1,2] in response to UpdateMetadata request sent by controller 2 epoch 55 with correlation id 0 (state.change.logger)
[2015-08-10 16:00:42,262] TRACE Controller 2 epoch 55 received response UpdateMetadataResponse(0,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-10 16:00:42,266] ERROR Controller 2 epoch 55 initiated state change for partition [t2,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,2] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:139)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:134)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:549)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:00:42,266] TRACE Controller 2 epoch 55 started leader election for partition [t2,0] (state.change.logger)
[2015-08-10 16:00:42,272] ERROR Controller 2 epoch 55 initiated state change for partition [t2,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:139)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:134)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:549)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:00:42,272] TRACE Controller 2 epoch 55 started leader election for partition [t7,0] (state.change.logger)
[2015-08-10 16:00:42,278] ERROR Controller 2 epoch 55 initiated state change for partition [t7,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t7,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:139)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:134)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:549)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:00:42,278] TRACE Controller 2 epoch 55 started leader election for partition [t1,1] (state.change.logger)
[2015-08-10 16:00:42,283] ERROR Controller 2 epoch 55 initiated state change for partition [t1,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,1] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:139)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:134)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:549)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:00:42,283] TRACE Controller 2 epoch 55 started leader election for partition [t3,2] (state.change.logger)
[2015-08-10 16:00:42,288] ERROR Controller 2 epoch 55 initiated state change for partition [t3,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,2] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:139)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:134)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:549)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:00:42,289] TRACE Controller 2 epoch 55 started leader election for partition [t3,0] (state.change.logger)
[2015-08-10 16:00:42,293] ERROR Controller 2 epoch 55 initiated state change for partition [t3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:139)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:134)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:549)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:00:42,294] TRACE Controller 2 epoch 55 started leader election for partition [t6,0] (state.change.logger)
[2015-08-10 16:00:42,299] ERROR Controller 2 epoch 55 initiated state change for partition [t6,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t6,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:139)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:134)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:134)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:549)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:00:42,309] TRACE Controller 2 epoch 55 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 2 for partition [t1,1] (state.change.logger)
[2015-08-10 16:00:42,309] TRACE Controller 2 epoch 55 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 2 for partition [t3,0] (state.change.logger)
[2015-08-10 16:00:42,309] TRACE Controller 2 epoch 55 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 3 to broker 2 for partition [t2,1] (state.change.logger)
[2015-08-10 16:00:42,309] TRACE Controller 2 epoch 55 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 3 to broker 2 for partition [t3,1] (state.change.logger)
[2015-08-10 16:00:42,309] TRACE Controller 2 epoch 55 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 2 for partition [t3,2] (state.change.logger)
[2015-08-10 16:00:42,309] TRACE Controller 2 epoch 55 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 2 for partition [t7,0] (state.change.logger)
[2015-08-10 16:00:42,309] TRACE Controller 2 epoch 55 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 3 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-10 16:00:42,309] TRACE Controller 2 epoch 55 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 3 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-10 16:00:42,309] TRACE Controller 2 epoch 55 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 2 for partition [t6,0] (state.change.logger)
[2015-08-10 16:00:42,309] TRACE Controller 2 epoch 55 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 3 to broker 2 for partition [t1,2] (state.change.logger)
[2015-08-10 16:00:42,309] TRACE Controller 2 epoch 55 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 2 for partition [t2,0] (state.change.logger)
[2015-08-10 16:00:42,310] TRACE Controller 2 epoch 55 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 2 for partition [t2,2] (state.change.logger)
[2015-08-10 16:00:42,310] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t1,1] in response to UpdateMetadata request sent by controller 2 epoch 55 with correlation id 3 (state.change.logger)
[2015-08-10 16:00:42,310] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t3,0] in response to UpdateMetadata request sent by controller 2 epoch 55 with correlation id 3 (state.change.logger)
[2015-08-10 16:00:42,310] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t2,1] in response to UpdateMetadata request sent by controller 2 epoch 55 with correlation id 3 (state.change.logger)
[2015-08-10 16:00:42,311] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t3,1] in response to UpdateMetadata request sent by controller 2 epoch 55 with correlation id 3 (state.change.logger)
[2015-08-10 16:00:42,311] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t3,2] in response to UpdateMetadata request sent by controller 2 epoch 55 with correlation id 3 (state.change.logger)
[2015-08-10 16:00:42,311] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t7,0] in response to UpdateMetadata request sent by controller 2 epoch 55 with correlation id 3 (state.change.logger)
[2015-08-10 16:00:42,311] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 2 epoch 55 with correlation id 3 (state.change.logger)
[2015-08-10 16:00:42,311] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t4,0] in response to UpdateMetadata request sent by controller 2 epoch 55 with correlation id 3 (state.change.logger)
[2015-08-10 16:00:42,311] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t6,0] in response to UpdateMetadata request sent by controller 2 epoch 55 with correlation id 3 (state.change.logger)
[2015-08-10 16:00:42,311] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t1,2] in response to UpdateMetadata request sent by controller 2 epoch 55 with correlation id 3 (state.change.logger)
[2015-08-10 16:00:42,311] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t2,0] in response to UpdateMetadata request sent by controller 2 epoch 55 with correlation id 3 (state.change.logger)
[2015-08-10 16:00:42,311] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t2,2] in response to UpdateMetadata request sent by controller 2 epoch 55 with correlation id 3 (state.change.logger)
[2015-08-10 16:00:42,311] TRACE Controller 2 epoch 55 received response UpdateMetadataResponse(3,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-10 16:19:17,679] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2015-08-10 16:20:58,671] TRACE Controller 1 epoch 56 started leader election for partition [t2,1] (state.change.logger)
[2015-08-10 16:20:58,683] ERROR Controller 1 epoch 56 initiated state change for partition [t2,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,1] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:20:58,685] TRACE Controller 1 epoch 56 started leader election for partition [t1,2] (state.change.logger)
[2015-08-10 16:20:58,693] ERROR Controller 1 epoch 56 initiated state change for partition [t1,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,2] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:20:58,694] TRACE Controller 1 epoch 56 started leader election for partition [t3,1] (state.change.logger)
[2015-08-10 16:20:58,703] ERROR Controller 1 epoch 56 initiated state change for partition [t3,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,1] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:20:58,704] TRACE Controller 1 epoch 56 started leader election for partition [t1,0] (state.change.logger)
[2015-08-10 16:20:58,713] ERROR Controller 1 epoch 56 initiated state change for partition [t1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:20:58,714] TRACE Controller 1 epoch 56 started leader election for partition [t2,2] (state.change.logger)
[2015-08-10 16:20:58,722] ERROR Controller 1 epoch 56 initiated state change for partition [t2,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,2] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:20:58,723] TRACE Controller 1 epoch 56 started leader election for partition [t2,0] (state.change.logger)
[2015-08-10 16:20:58,731] ERROR Controller 1 epoch 56 initiated state change for partition [t2,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:20:58,732] TRACE Controller 1 epoch 56 started leader election for partition [t7,0] (state.change.logger)
[2015-08-10 16:20:58,738] ERROR Controller 1 epoch 56 initiated state change for partition [t7,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t7,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:20:58,739] TRACE Controller 1 epoch 56 started leader election for partition [t1,1] (state.change.logger)
[2015-08-10 16:20:58,747] ERROR Controller 1 epoch 56 initiated state change for partition [t1,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,1] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:20:58,747] TRACE Controller 1 epoch 56 started leader election for partition [t3,2] (state.change.logger)
[2015-08-10 16:20:58,755] ERROR Controller 1 epoch 56 initiated state change for partition [t3,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,2] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:20:58,756] TRACE Controller 1 epoch 56 started leader election for partition [t3,0] (state.change.logger)
[2015-08-10 16:20:58,766] ERROR Controller 1 epoch 56 initiated state change for partition [t3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:20:58,766] TRACE Controller 1 epoch 56 started leader election for partition [t6,0] (state.change.logger)
[2015-08-10 16:20:58,773] ERROR Controller 1 epoch 56 initiated state change for partition [t6,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t6,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:20:58,774] TRACE Controller 1 epoch 56 started leader election for partition [t4,0] (state.change.logger)
[2015-08-10 16:20:58,781] ERROR Controller 1 epoch 56 initiated state change for partition [t4,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t4,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:20:58,857] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t1,1] (state.change.logger)
[2015-08-10 16:20:58,858] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t3,0] (state.change.logger)
[2015-08-10 16:20:58,858] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t2,1] (state.change.logger)
[2015-08-10 16:20:58,858] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t3,1] (state.change.logger)
[2015-08-10 16:20:58,858] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t3,2] (state.change.logger)
[2015-08-10 16:20:58,859] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t7,0] (state.change.logger)
[2015-08-10 16:20:58,859] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t1,0] (state.change.logger)
[2015-08-10 16:20:58,859] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-10 16:20:58,859] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t6,0] (state.change.logger)
[2015-08-10 16:20:58,859] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t1,2] (state.change.logger)
[2015-08-10 16:20:58,860] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t2,0] (state.change.logger)
[2015-08-10 16:20:58,861] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t2,2] (state.change.logger)
[2015-08-10 16:20:58,862] TRACE Controller 1 epoch 56 started leader election for partition [t2,1] (state.change.logger)
[2015-08-10 16:20:58,868] ERROR Controller 1 epoch 56 initiated state change for partition [t2,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,1] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:20:58,869] TRACE Controller 1 epoch 56 started leader election for partition [t1,2] (state.change.logger)
[2015-08-10 16:20:58,876] ERROR Controller 1 epoch 56 initiated state change for partition [t1,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,2] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:20:58,877] TRACE Controller 1 epoch 56 started leader election for partition [t3,1] (state.change.logger)
[2015-08-10 16:20:58,884] ERROR Controller 1 epoch 56 initiated state change for partition [t3,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,1] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:20:58,885] TRACE Controller 1 epoch 56 started leader election for partition [t1,0] (state.change.logger)
[2015-08-10 16:20:58,892] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t1,1] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 3 (state.change.logger)
[2015-08-10 16:20:58,893] ERROR Controller 1 epoch 56 initiated state change for partition [t1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:20:58,893] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t3,0] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 3 (state.change.logger)
[2015-08-10 16:20:58,893] TRACE Controller 1 epoch 56 started leader election for partition [t2,2] (state.change.logger)
[2015-08-10 16:20:58,893] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t2,1] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 3 (state.change.logger)
[2015-08-10 16:20:58,894] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t3,1] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 3 (state.change.logger)
[2015-08-10 16:20:58,894] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t3,2] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 3 (state.change.logger)
[2015-08-10 16:20:58,894] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t7,0] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 3 (state.change.logger)
[2015-08-10 16:20:58,894] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 3 (state.change.logger)
[2015-08-10 16:20:58,895] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 3 (state.change.logger)
[2015-08-10 16:20:58,895] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t6,0] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 3 (state.change.logger)
[2015-08-10 16:20:58,895] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t1,2] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 3 (state.change.logger)
[2015-08-10 16:20:58,895] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t2,0] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 3 (state.change.logger)
[2015-08-10 16:20:58,896] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t2,2] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 3 (state.change.logger)
[2015-08-10 16:20:58,901] ERROR Controller 1 epoch 56 initiated state change for partition [t2,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,2] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:20:58,902] TRACE Controller 1 epoch 56 started leader election for partition [t2,0] (state.change.logger)
[2015-08-10 16:20:58,908] ERROR Controller 1 epoch 56 initiated state change for partition [t2,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:20:58,910] TRACE Controller 1 epoch 56 started leader election for partition [t7,0] (state.change.logger)
[2015-08-10 16:20:58,911] TRACE Controller 1 epoch 56 received response UpdateMetadataResponse(3,0) for a request sent to broker id:1,host:fufuka,port:9092 (state.change.logger)
[2015-08-10 16:20:58,916] ERROR Controller 1 epoch 56 initiated state change for partition [t7,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t7,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:20:58,916] TRACE Controller 1 epoch 56 started leader election for partition [t1,1] (state.change.logger)
[2015-08-10 16:20:58,924] ERROR Controller 1 epoch 56 initiated state change for partition [t1,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,1] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:20:58,924] TRACE Controller 1 epoch 56 started leader election for partition [t3,2] (state.change.logger)
[2015-08-10 16:20:58,931] ERROR Controller 1 epoch 56 initiated state change for partition [t3,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,2] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:20:58,931] TRACE Controller 1 epoch 56 started leader election for partition [t3,0] (state.change.logger)
[2015-08-10 16:20:58,938] ERROR Controller 1 epoch 56 initiated state change for partition [t3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:20:58,938] TRACE Controller 1 epoch 56 started leader election for partition [t6,0] (state.change.logger)
[2015-08-10 16:20:58,945] ERROR Controller 1 epoch 56 initiated state change for partition [t6,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t6,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:20:58,946] TRACE Controller 1 epoch 56 started leader election for partition [t4,0] (state.change.logger)
[2015-08-10 16:20:58,952] ERROR Controller 1 epoch 56 initiated state change for partition [t4,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t4,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:21:26,617] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t1,1] (state.change.logger)
[2015-08-10 16:21:26,618] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t3,0] (state.change.logger)
[2015-08-10 16:21:26,618] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t2,1] (state.change.logger)
[2015-08-10 16:21:26,618] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t3,1] (state.change.logger)
[2015-08-10 16:21:26,618] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t3,2] (state.change.logger)
[2015-08-10 16:21:26,618] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t7,0] (state.change.logger)
[2015-08-10 16:21:26,618] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-10 16:21:26,618] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-10 16:21:26,619] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t6,0] (state.change.logger)
[2015-08-10 16:21:26,619] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t1,2] (state.change.logger)
[2015-08-10 16:21:26,619] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t2,0] (state.change.logger)
[2015-08-10 16:21:26,619] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t2,2] (state.change.logger)
[2015-08-10 16:21:26,631] TRACE Controller 1 epoch 56 changed state of replica 2 for partition [t3,1] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 16:21:26,632] TRACE Controller 1 epoch 56 changed state of replica 2 for partition [t2,1] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 16:21:26,632] TRACE Controller 1 epoch 56 changed state of replica 2 for partition [t4,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 16:21:26,633] TRACE Controller 1 epoch 56 changed state of replica 2 for partition [t1,2] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 16:21:26,633] TRACE Controller 1 epoch 56 changed state of replica 2 for partition [t1,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 16:21:26,637] TRACE Controller 1 epoch 56 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 6 to broker 2 for partition [t2,1] (state.change.logger)
[2015-08-10 16:21:26,637] TRACE Controller 1 epoch 56 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 6 to broker 2 for partition [t3,1] (state.change.logger)
[2015-08-10 16:21:26,637] TRACE Controller 1 epoch 56 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 6 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-10 16:21:26,637] TRACE Controller 1 epoch 56 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 6 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-10 16:21:26,637] TRACE Controller 1 epoch 56 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 6 to broker 2 for partition [t1,2] (state.change.logger)
[2015-08-10 16:21:26,638] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 6 to broker 2 for partition [t2,1] (state.change.logger)
[2015-08-10 16:21:26,638] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 6 to broker 2 for partition [t3,1] (state.change.logger)
[2015-08-10 16:21:26,638] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 6 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-10 16:21:26,638] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 6 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-10 16:21:26,638] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 6 to broker 2 for partition [t1,2] (state.change.logger)
[2015-08-10 16:21:26,639] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 6 to broker 1 for partition [t2,1] (state.change.logger)
[2015-08-10 16:21:26,639] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 6 to broker 1 for partition [t3,1] (state.change.logger)
[2015-08-10 16:21:26,639] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 6 to broker 1 for partition [t1,0] (state.change.logger)
[2015-08-10 16:21:26,639] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 6 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-10 16:21:26,639] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54) with correlationId 6 to broker 1 for partition [t1,2] (state.change.logger)
[2015-08-10 16:21:26,639] TRACE Controller 1 epoch 56 started leader election for partition [t2,1] (state.change.logger)
[2015-08-10 16:21:26,641] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t2,1] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 6 (state.change.logger)
[2015-08-10 16:21:26,641] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t3,1] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 6 (state.change.logger)
[2015-08-10 16:21:26,642] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 6 (state.change.logger)
[2015-08-10 16:21:26,642] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 6 (state.change.logger)
[2015-08-10 16:21:26,642] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t1,2] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 6 (state.change.logger)
[2015-08-10 16:21:26,643] TRACE Controller 1 epoch 56 received response UpdateMetadataResponse(6,0) for a request sent to broker id:1,host:fufuka,port:9092 (state.change.logger)
[2015-08-10 16:21:26,653] TRACE Controller 1 epoch 56 elected leader 2 for Offline partition [t2,1] (state.change.logger)
[2015-08-10 16:21:26,655] TRACE Controller 1 epoch 56 changed partition [t2,1] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2015-08-10 16:21:26,656] TRACE Controller 1 epoch 56 started leader election for partition [t1,2] (state.change.logger)
[2015-08-10 16:21:26,656] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t1,1] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 5 (state.change.logger)
[2015-08-10 16:21:26,657] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t3,0] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 5 (state.change.logger)
[2015-08-10 16:21:26,657] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t2,1] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 5 (state.change.logger)
[2015-08-10 16:21:26,657] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t3,1] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 5 (state.change.logger)
[2015-08-10 16:21:26,658] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t3,2] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 5 (state.change.logger)
[2015-08-10 16:21:26,658] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t7,0] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 5 (state.change.logger)
[2015-08-10 16:21:26,658] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 5 (state.change.logger)
[2015-08-10 16:21:26,659] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 5 (state.change.logger)
[2015-08-10 16:21:26,659] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t6,0] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 5 (state.change.logger)
[2015-08-10 16:21:26,660] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t1,2] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 5 (state.change.logger)
[2015-08-10 16:21:26,660] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t2,0] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 5 (state.change.logger)
[2015-08-10 16:21:26,660] TRACE Controller 1 epoch 56 elected leader 2 for Offline partition [t1,2] (state.change.logger)
[2015-08-10 16:21:26,660] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t2,2] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 5 (state.change.logger)
[2015-08-10 16:21:26,662] TRACE Controller 1 epoch 56 changed partition [t1,2] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2015-08-10 16:21:26,662] TRACE Controller 1 epoch 56 started leader election for partition [t3,1] (state.change.logger)
[2015-08-10 16:21:26,668] TRACE Controller 1 epoch 56 elected leader 2 for Offline partition [t3,1] (state.change.logger)
[2015-08-10 16:21:26,669] TRACE Controller 1 epoch 56 changed partition [t3,1] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2015-08-10 16:21:26,669] TRACE Controller 1 epoch 56 started leader election for partition [t1,0] (state.change.logger)
[2015-08-10 16:21:26,674] TRACE Controller 1 epoch 56 elected leader 2 for Offline partition [t1,0] (state.change.logger)
[2015-08-10 16:21:26,675] TRACE Controller 1 epoch 56 changed partition [t1,0] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2015-08-10 16:21:26,675] TRACE Controller 1 epoch 56 started leader election for partition [t2,2] (state.change.logger)
[2015-08-10 16:21:26,680] TRACE Controller 1 epoch 56 received response UpdateMetadataResponse(5,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-10 16:21:26,682] ERROR Controller 1 epoch 56 initiated state change for partition [t2,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,2] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:21:26,682] TRACE Controller 1 epoch 56 started leader election for partition [t2,0] (state.change.logger)
[2015-08-10 16:21:26,687] ERROR Controller 1 epoch 56 initiated state change for partition [t2,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,0] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:21:26,688] TRACE Controller 1 epoch 56 started leader election for partition [t7,0] (state.change.logger)
[2015-08-10 16:21:26,695] ERROR Controller 1 epoch 56 initiated state change for partition [t7,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t7,0] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:21:26,696] TRACE Controller 1 epoch 56 started leader election for partition [t1,1] (state.change.logger)
[2015-08-10 16:21:26,702] ERROR Controller 1 epoch 56 initiated state change for partition [t1,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,1] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:21:26,703] TRACE Controller 1 epoch 56 started leader election for partition [t3,2] (state.change.logger)
[2015-08-10 16:21:26,709] ERROR Controller 1 epoch 56 initiated state change for partition [t3,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,2] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:21:26,710] TRACE Controller 1 epoch 56 started leader election for partition [t3,0] (state.change.logger)
[2015-08-10 16:21:26,717] ERROR Controller 1 epoch 56 initiated state change for partition [t3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,0] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:21:26,718] TRACE Controller 1 epoch 56 started leader election for partition [t6,0] (state.change.logger)
[2015-08-10 16:21:26,724] ERROR Controller 1 epoch 56 initiated state change for partition [t6,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t6,0] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:21:26,724] TRACE Controller 1 epoch 56 started leader election for partition [t4,0] (state.change.logger)
[2015-08-10 16:21:26,729] TRACE Controller 1 epoch 56 elected leader 2 for Offline partition [t4,0] (state.change.logger)
[2015-08-10 16:21:26,731] TRACE Controller 1 epoch 56 changed partition [t4,0] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2015-08-10 16:21:26,731] TRACE Controller 1 epoch 56 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 7 to broker 2 for partition [t2,1] (state.change.logger)
[2015-08-10 16:21:26,731] TRACE Controller 1 epoch 56 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 7 to broker 2 for partition [t3,1] (state.change.logger)
[2015-08-10 16:21:26,731] TRACE Controller 1 epoch 56 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 7 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-10 16:21:26,731] TRACE Controller 1 epoch 56 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 7 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-10 16:21:26,731] TRACE Controller 1 epoch 56 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 7 to broker 2 for partition [t1,2] (state.change.logger)
[2015-08-10 16:21:26,731] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 7 to broker 2 for partition [t2,1] (state.change.logger)
[2015-08-10 16:21:26,731] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 7 to broker 2 for partition [t3,1] (state.change.logger)
[2015-08-10 16:21:26,732] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 7 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-10 16:21:26,732] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 7 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-10 16:21:26,732] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 7 to broker 2 for partition [t1,2] (state.change.logger)
[2015-08-10 16:21:26,732] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 7 to broker 1 for partition [t2,1] (state.change.logger)
[2015-08-10 16:21:26,732] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 7 to broker 1 for partition [t3,1] (state.change.logger)
[2015-08-10 16:21:26,732] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 7 to broker 1 for partition [t1,0] (state.change.logger)
[2015-08-10 16:21:26,732] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 7 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-10 16:21:26,732] TRACE Controller 1 epoch 56 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 7 to broker 1 for partition [t1,2] (state.change.logger)
[2015-08-10 16:21:26,733] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t2,1] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 7 (state.change.logger)
[2015-08-10 16:21:26,734] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t3,1] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 7 (state.change.logger)
[2015-08-10 16:21:26,734] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 7 (state.change.logger)
[2015-08-10 16:21:26,734] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 7 (state.change.logger)
[2015-08-10 16:21:26,734] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t1,2] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 7 (state.change.logger)
[2015-08-10 16:21:26,734] TRACE Controller 1 epoch 56 received response UpdateMetadataResponse(7,0) for a request sent to broker id:1,host:fufuka,port:9092 (state.change.logger)
[2015-08-10 16:21:26,756] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) correlation id 6 from controller 1 epoch 56 for partition [t2,1] (state.change.logger)
[2015-08-10 16:21:26,756] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) correlation id 6 from controller 1 epoch 56 for partition [t3,1] (state.change.logger)
[2015-08-10 16:21:26,757] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) correlation id 6 from controller 1 epoch 56 for partition [t1,0] (state.change.logger)
[2015-08-10 16:21:26,757] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) correlation id 6 from controller 1 epoch 56 for partition [t4,0] (state.change.logger)
[2015-08-10 16:21:26,757] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) correlation id 6 from controller 1 epoch 56 for partition [t1,2] (state.change.logger)
[2015-08-10 16:21:26,767] TRACE Broker 2 handling LeaderAndIsr request correlationId 6 from controller 1 epoch 56 starting the become-leader transition for partition [t1,2] (state.change.logger)
[2015-08-10 16:21:26,767] TRACE Broker 2 handling LeaderAndIsr request correlationId 6 from controller 1 epoch 56 starting the become-leader transition for partition [t3,1] (state.change.logger)
[2015-08-10 16:21:26,767] TRACE Broker 2 handling LeaderAndIsr request correlationId 6 from controller 1 epoch 56 starting the become-leader transition for partition [t2,1] (state.change.logger)
[2015-08-10 16:21:26,768] TRACE Broker 2 handling LeaderAndIsr request correlationId 6 from controller 1 epoch 56 starting the become-leader transition for partition [t1,0] (state.change.logger)
[2015-08-10 16:21:26,768] TRACE Broker 2 handling LeaderAndIsr request correlationId 6 from controller 1 epoch 56 starting the become-leader transition for partition [t4,0] (state.change.logger)
[2015-08-10 16:21:26,771] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 56 with correlation id 6 for partition [t1,2] (state.change.logger)
[2015-08-10 16:21:26,772] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 56 with correlation id 6 for partition [t3,1] (state.change.logger)
[2015-08-10 16:21:26,772] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 56 with correlation id 6 for partition [t2,1] (state.change.logger)
[2015-08-10 16:21:26,772] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 56 with correlation id 6 for partition [t1,0] (state.change.logger)
[2015-08-10 16:21:26,772] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 56 with correlation id 6 for partition [t4,0] (state.change.logger)
[2015-08-10 16:21:26,800] TRACE Broker 2 completed LeaderAndIsr request correlationId 6 from controller 1 epoch 56 for the become-leader transition for partition [t1,2] (state.change.logger)
[2015-08-10 16:21:26,800] TRACE Broker 2 completed LeaderAndIsr request correlationId 6 from controller 1 epoch 56 for the become-leader transition for partition [t3,1] (state.change.logger)
[2015-08-10 16:21:26,800] TRACE Broker 2 completed LeaderAndIsr request correlationId 6 from controller 1 epoch 56 for the become-leader transition for partition [t2,1] (state.change.logger)
[2015-08-10 16:21:26,800] TRACE Broker 2 completed LeaderAndIsr request correlationId 6 from controller 1 epoch 56 for the become-leader transition for partition [t1,0] (state.change.logger)
[2015-08-10 16:21:26,800] TRACE Broker 2 completed LeaderAndIsr request correlationId 6 from controller 1 epoch 56 for the become-leader transition for partition [t4,0] (state.change.logger)
[2015-08-10 16:21:26,806] TRACE Controller 1 epoch 56 received response LeaderAndIsrResponse(6,Map((t2,1) -> 0, (t1,2) -> 0, (t3,1) -> 0, (t1,0) -> 0, (t4,0) -> 0),0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-10 16:21:26,807] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t2,1] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 6 (state.change.logger)
[2015-08-10 16:21:26,808] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t3,1] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 6 (state.change.logger)
[2015-08-10 16:21:26,808] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 6 (state.change.logger)
[2015-08-10 16:21:26,808] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 6 (state.change.logger)
[2015-08-10 16:21:26,808] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:46,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:2) for partition [t1,2] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 6 (state.change.logger)
[2015-08-10 16:21:26,809] TRACE Controller 1 epoch 56 received response UpdateMetadataResponse(6,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-10 16:21:26,810] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) correlation id 7 from controller 1 epoch 56 for partition [t2,1] (state.change.logger)
[2015-08-10 16:21:26,810] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) correlation id 7 from controller 1 epoch 56 for partition [t3,1] (state.change.logger)
[2015-08-10 16:21:26,811] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) correlation id 7 from controller 1 epoch 56 for partition [t1,0] (state.change.logger)
[2015-08-10 16:21:26,811] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) correlation id 7 from controller 1 epoch 56 for partition [t4,0] (state.change.logger)
[2015-08-10 16:21:26,811] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) correlation id 7 from controller 1 epoch 56 for partition [t1,2] (state.change.logger)
[2015-08-10 16:21:26,811] TRACE Broker 2 handling LeaderAndIsr request correlationId 7 from controller 1 epoch 56 starting the become-leader transition for partition [t1,2] (state.change.logger)
[2015-08-10 16:21:26,811] TRACE Broker 2 handling LeaderAndIsr request correlationId 7 from controller 1 epoch 56 starting the become-leader transition for partition [t3,1] (state.change.logger)
[2015-08-10 16:21:26,811] TRACE Broker 2 handling LeaderAndIsr request correlationId 7 from controller 1 epoch 56 starting the become-leader transition for partition [t2,1] (state.change.logger)
[2015-08-10 16:21:26,811] TRACE Broker 2 handling LeaderAndIsr request correlationId 7 from controller 1 epoch 56 starting the become-leader transition for partition [t1,0] (state.change.logger)
[2015-08-10 16:21:26,812] TRACE Broker 2 handling LeaderAndIsr request correlationId 7 from controller 1 epoch 56 starting the become-leader transition for partition [t4,0] (state.change.logger)
[2015-08-10 16:21:26,812] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 56 with correlation id 7 for partition [t1,2] (state.change.logger)
[2015-08-10 16:21:26,812] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 56 with correlation id 7 for partition [t3,1] (state.change.logger)
[2015-08-10 16:21:26,812] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 56 with correlation id 7 for partition [t2,1] (state.change.logger)
[2015-08-10 16:21:26,812] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 56 with correlation id 7 for partition [t1,0] (state.change.logger)
[2015-08-10 16:21:26,813] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 56 with correlation id 7 for partition [t4,0] (state.change.logger)
[2015-08-10 16:21:26,813] TRACE Broker 2 completed LeaderAndIsr request correlationId 7 from controller 1 epoch 56 for the become-leader transition for partition [t1,2] (state.change.logger)
[2015-08-10 16:21:26,813] TRACE Broker 2 completed LeaderAndIsr request correlationId 7 from controller 1 epoch 56 for the become-leader transition for partition [t3,1] (state.change.logger)
[2015-08-10 16:21:26,814] TRACE Broker 2 completed LeaderAndIsr request correlationId 7 from controller 1 epoch 56 for the become-leader transition for partition [t2,1] (state.change.logger)
[2015-08-10 16:21:26,814] TRACE Broker 2 completed LeaderAndIsr request correlationId 7 from controller 1 epoch 56 for the become-leader transition for partition [t1,0] (state.change.logger)
[2015-08-10 16:21:26,814] TRACE Broker 2 completed LeaderAndIsr request correlationId 7 from controller 1 epoch 56 for the become-leader transition for partition [t4,0] (state.change.logger)
[2015-08-10 16:21:26,815] TRACE Controller 1 epoch 56 received response LeaderAndIsrResponse(7,Map((t2,1) -> 0, (t1,2) -> 0, (t3,1) -> 0, (t1,0) -> 0, (t4,0) -> 0),0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-10 16:21:26,816] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t2,1] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 7 (state.change.logger)
[2015-08-10 16:21:26,816] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t3,1] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 7 (state.change.logger)
[2015-08-10 16:21:26,816] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 7 (state.change.logger)
[2015-08-10 16:21:26,816] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 7 (state.change.logger)
[2015-08-10 16:21:26,817] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t1,2] in response to UpdateMetadata request sent by controller 1 epoch 56 with correlation id 7 (state.change.logger)
[2015-08-10 16:21:26,817] TRACE Controller 1 epoch 56 received response UpdateMetadataResponse(7,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-10 16:24:04,866] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2015-08-10 16:24:34,192] TRACE Controller 1 epoch 57 started leader election for partition [t2,1] (state.change.logger)
[2015-08-10 16:24:34,206] ERROR Controller 1 epoch 57 initiated state change for partition [t2,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,1] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:24:34,209] TRACE Controller 1 epoch 57 started leader election for partition [t1,2] (state.change.logger)
[2015-08-10 16:24:34,224] ERROR Controller 1 epoch 57 initiated state change for partition [t1,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,2] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:24:34,225] TRACE Controller 1 epoch 57 started leader election for partition [t3,1] (state.change.logger)
[2015-08-10 16:24:34,238] ERROR Controller 1 epoch 57 initiated state change for partition [t3,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,1] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:24:34,240] TRACE Controller 1 epoch 57 started leader election for partition [t1,0] (state.change.logger)
[2015-08-10 16:24:34,250] ERROR Controller 1 epoch 57 initiated state change for partition [t1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:24:34,251] TRACE Controller 1 epoch 57 started leader election for partition [t2,2] (state.change.logger)
[2015-08-10 16:24:34,262] ERROR Controller 1 epoch 57 initiated state change for partition [t2,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,2] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:24:34,264] TRACE Controller 1 epoch 57 started leader election for partition [t2,0] (state.change.logger)
[2015-08-10 16:24:34,273] ERROR Controller 1 epoch 57 initiated state change for partition [t2,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:24:34,274] TRACE Controller 1 epoch 57 started leader election for partition [t7,0] (state.change.logger)
[2015-08-10 16:24:34,283] ERROR Controller 1 epoch 57 initiated state change for partition [t7,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t7,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:24:34,284] TRACE Controller 1 epoch 57 started leader election for partition [t1,1] (state.change.logger)
[2015-08-10 16:24:34,292] ERROR Controller 1 epoch 57 initiated state change for partition [t1,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,1] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:24:34,293] TRACE Controller 1 epoch 57 started leader election for partition [t3,2] (state.change.logger)
[2015-08-10 16:24:34,302] ERROR Controller 1 epoch 57 initiated state change for partition [t3,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,2] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:24:34,303] TRACE Controller 1 epoch 57 started leader election for partition [t3,0] (state.change.logger)
[2015-08-10 16:24:34,314] ERROR Controller 1 epoch 57 initiated state change for partition [t3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:24:34,315] TRACE Controller 1 epoch 57 started leader election for partition [t6,0] (state.change.logger)
[2015-08-10 16:24:34,323] ERROR Controller 1 epoch 57 initiated state change for partition [t6,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t6,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:24:34,323] TRACE Controller 1 epoch 57 started leader election for partition [t4,0] (state.change.logger)
[2015-08-10 16:24:34,333] ERROR Controller 1 epoch 57 initiated state change for partition [t4,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t4,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:24:34,460] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t1,1] (state.change.logger)
[2015-08-10 16:24:34,461] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t3,0] (state.change.logger)
[2015-08-10 16:24:34,461] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 3 to broker 1 for partition [t2,1] (state.change.logger)
[2015-08-10 16:24:34,461] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 3 to broker 1 for partition [t3,1] (state.change.logger)
[2015-08-10 16:24:34,461] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t3,2] (state.change.logger)
[2015-08-10 16:24:34,461] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t7,0] (state.change.logger)
[2015-08-10 16:24:34,462] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 3 to broker 1 for partition [t1,0] (state.change.logger)
[2015-08-10 16:24:34,462] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 3 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-10 16:24:34,464] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t6,0] (state.change.logger)
[2015-08-10 16:24:34,464] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 3 to broker 1 for partition [t1,2] (state.change.logger)
[2015-08-10 16:24:34,464] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t2,0] (state.change.logger)
[2015-08-10 16:24:34,465] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t2,2] (state.change.logger)
[2015-08-10 16:24:34,466] TRACE Controller 1 epoch 57 started leader election for partition [t2,1] (state.change.logger)
[2015-08-10 16:24:34,476] ERROR Controller 1 epoch 57 initiated state change for partition [t2,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,1] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:24:34,477] TRACE Controller 1 epoch 57 started leader election for partition [t1,2] (state.change.logger)
[2015-08-10 16:24:34,486] ERROR Controller 1 epoch 57 initiated state change for partition [t1,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,2] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:24:34,487] TRACE Controller 1 epoch 57 started leader election for partition [t3,1] (state.change.logger)
[2015-08-10 16:24:34,496] ERROR Controller 1 epoch 57 initiated state change for partition [t3,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,1] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:24:34,497] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t1,1] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 3 (state.change.logger)
[2015-08-10 16:24:34,497] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t3,0] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 3 (state.change.logger)
[2015-08-10 16:24:34,497] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t2,1] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 3 (state.change.logger)
[2015-08-10 16:24:34,498] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t3,1] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 3 (state.change.logger)
[2015-08-10 16:24:34,498] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t3,2] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 3 (state.change.logger)
[2015-08-10 16:24:34,498] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t7,0] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 3 (state.change.logger)
[2015-08-10 16:24:34,498] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 3 (state.change.logger)
[2015-08-10 16:24:34,498] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 3 (state.change.logger)
[2015-08-10 16:24:34,499] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t6,0] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 3 (state.change.logger)
[2015-08-10 16:24:34,499] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t1,2] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 3 (state.change.logger)
[2015-08-10 16:24:34,499] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t2,0] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 3 (state.change.logger)
[2015-08-10 16:24:34,499] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t2,2] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 3 (state.change.logger)
[2015-08-10 16:24:34,500] TRACE Controller 1 epoch 57 started leader election for partition [t1,0] (state.change.logger)
[2015-08-10 16:24:34,512] ERROR Controller 1 epoch 57 initiated state change for partition [t1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:24:34,513] TRACE Controller 1 epoch 57 started leader election for partition [t2,2] (state.change.logger)
[2015-08-10 16:24:34,518] TRACE Controller 1 epoch 57 received response UpdateMetadataResponse(3,0) for a request sent to broker id:1,host:fufuka,port:9092 (state.change.logger)
[2015-08-10 16:24:34,524] ERROR Controller 1 epoch 57 initiated state change for partition [t2,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,2] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:24:34,525] TRACE Controller 1 epoch 57 started leader election for partition [t2,0] (state.change.logger)
[2015-08-10 16:24:34,551] ERROR Controller 1 epoch 57 initiated state change for partition [t2,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:24:34,552] TRACE Controller 1 epoch 57 started leader election for partition [t7,0] (state.change.logger)
[2015-08-10 16:24:34,559] ERROR Controller 1 epoch 57 initiated state change for partition [t7,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t7,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:24:34,559] TRACE Controller 1 epoch 57 started leader election for partition [t1,1] (state.change.logger)
[2015-08-10 16:24:34,566] ERROR Controller 1 epoch 57 initiated state change for partition [t1,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,1] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:24:34,567] TRACE Controller 1 epoch 57 started leader election for partition [t3,2] (state.change.logger)
[2015-08-10 16:24:34,573] ERROR Controller 1 epoch 57 initiated state change for partition [t3,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,2] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:24:34,574] TRACE Controller 1 epoch 57 started leader election for partition [t3,0] (state.change.logger)
[2015-08-10 16:24:34,582] ERROR Controller 1 epoch 57 initiated state change for partition [t3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:24:34,582] TRACE Controller 1 epoch 57 started leader election for partition [t6,0] (state.change.logger)
[2015-08-10 16:24:34,588] ERROR Controller 1 epoch 57 initiated state change for partition [t6,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t6,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:24:34,589] TRACE Controller 1 epoch 57 started leader election for partition [t4,0] (state.change.logger)
[2015-08-10 16:24:34,596] ERROR Controller 1 epoch 57 initiated state change for partition [t4,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t4,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:25:10,009] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t1,1] (state.change.logger)
[2015-08-10 16:25:10,009] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t3,0] (state.change.logger)
[2015-08-10 16:25:10,009] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 5 to broker 2 for partition [t2,1] (state.change.logger)
[2015-08-10 16:25:10,009] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 5 to broker 2 for partition [t3,1] (state.change.logger)
[2015-08-10 16:25:10,009] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t3,2] (state.change.logger)
[2015-08-10 16:25:10,009] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t7,0] (state.change.logger)
[2015-08-10 16:25:10,009] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 5 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-10 16:25:10,009] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 5 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-10 16:25:10,010] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t6,0] (state.change.logger)
[2015-08-10 16:25:10,010] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 5 to broker 2 for partition [t1,2] (state.change.logger)
[2015-08-10 16:25:10,010] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t2,0] (state.change.logger)
[2015-08-10 16:25:10,010] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t2,2] (state.change.logger)
[2015-08-10 16:25:10,035] TRACE Controller 1 epoch 57 changed state of replica 2 for partition [t3,1] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 16:25:10,036] TRACE Controller 1 epoch 57 changed state of replica 2 for partition [t2,1] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 16:25:10,036] TRACE Controller 1 epoch 57 changed state of replica 2 for partition [t4,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 16:25:10,036] TRACE Controller 1 epoch 57 changed state of replica 2 for partition [t1,2] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 16:25:10,037] TRACE Controller 1 epoch 57 changed state of replica 2 for partition [t1,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 16:25:10,041] TRACE Controller 1 epoch 57 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 6 to broker 2 for partition [t2,1] (state.change.logger)
[2015-08-10 16:25:10,041] TRACE Controller 1 epoch 57 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 6 to broker 2 for partition [t3,1] (state.change.logger)
[2015-08-10 16:25:10,041] TRACE Controller 1 epoch 57 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 6 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-10 16:25:10,042] TRACE Controller 1 epoch 57 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 6 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-10 16:25:10,042] TRACE Controller 1 epoch 57 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 6 to broker 2 for partition [t1,2] (state.change.logger)
[2015-08-10 16:25:10,043] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 6 to broker 2 for partition [t2,1] (state.change.logger)
[2015-08-10 16:25:10,043] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 6 to broker 2 for partition [t3,1] (state.change.logger)
[2015-08-10 16:25:10,043] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 6 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-10 16:25:10,043] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 6 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-10 16:25:10,043] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 6 to broker 2 for partition [t1,2] (state.change.logger)
[2015-08-10 16:25:10,045] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 6 to broker 1 for partition [t2,1] (state.change.logger)
[2015-08-10 16:25:10,045] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 6 to broker 1 for partition [t3,1] (state.change.logger)
[2015-08-10 16:25:10,045] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 6 to broker 1 for partition [t1,0] (state.change.logger)
[2015-08-10 16:25:10,045] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 6 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-10 16:25:10,045] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56) with correlationId 6 to broker 1 for partition [t1,2] (state.change.logger)
[2015-08-10 16:25:10,045] TRACE Controller 1 epoch 57 started leader election for partition [t2,1] (state.change.logger)
[2015-08-10 16:25:10,053] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t2,1] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 6 (state.change.logger)
[2015-08-10 16:25:10,053] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t3,1] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 6 (state.change.logger)
[2015-08-10 16:25:10,053] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 6 (state.change.logger)
[2015-08-10 16:25:10,054] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 6 (state.change.logger)
[2015-08-10 16:25:10,054] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t1,2] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 6 (state.change.logger)
[2015-08-10 16:25:10,057] TRACE Controller 1 epoch 57 received response UpdateMetadataResponse(6,0) for a request sent to broker id:1,host:fufuka,port:9092 (state.change.logger)
[2015-08-10 16:25:10,061] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t1,1] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 5 (state.change.logger)
[2015-08-10 16:25:10,061] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t3,0] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 5 (state.change.logger)
[2015-08-10 16:25:10,062] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t2,1] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 5 (state.change.logger)
[2015-08-10 16:25:10,062] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t3,1] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 5 (state.change.logger)
[2015-08-10 16:25:10,062] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t3,2] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 5 (state.change.logger)
[2015-08-10 16:25:10,063] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t7,0] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 5 (state.change.logger)
[2015-08-10 16:25:10,063] TRACE Controller 1 epoch 57 elected leader 2 for Offline partition [t2,1] (state.change.logger)
[2015-08-10 16:25:10,063] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 5 (state.change.logger)
[2015-08-10 16:25:10,063] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 5 (state.change.logger)
[2015-08-10 16:25:10,064] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t6,0] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 5 (state.change.logger)
[2015-08-10 16:25:10,064] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t1,2] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 5 (state.change.logger)
[2015-08-10 16:25:10,064] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t2,0] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 5 (state.change.logger)
[2015-08-10 16:25:10,065] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t2,2] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 5 (state.change.logger)
[2015-08-10 16:25:10,065] TRACE Controller 1 epoch 57 changed partition [t2,1] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2015-08-10 16:25:10,066] TRACE Controller 1 epoch 57 started leader election for partition [t1,2] (state.change.logger)
[2015-08-10 16:25:10,071] TRACE Controller 1 epoch 57 elected leader 2 for Offline partition [t1,2] (state.change.logger)
[2015-08-10 16:25:10,074] TRACE Controller 1 epoch 57 changed partition [t1,2] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2015-08-10 16:25:10,074] TRACE Controller 1 epoch 57 started leader election for partition [t3,1] (state.change.logger)
[2015-08-10 16:25:10,083] TRACE Controller 1 epoch 57 elected leader 2 for Offline partition [t3,1] (state.change.logger)
[2015-08-10 16:25:10,084] TRACE Controller 1 epoch 57 changed partition [t3,1] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2015-08-10 16:25:10,084] TRACE Controller 1 epoch 57 started leader election for partition [t1,0] (state.change.logger)
[2015-08-10 16:25:10,090] TRACE Controller 1 epoch 57 elected leader 2 for Offline partition [t1,0] (state.change.logger)
[2015-08-10 16:25:10,091] TRACE Controller 1 epoch 57 changed partition [t1,0] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2015-08-10 16:25:10,091] TRACE Controller 1 epoch 57 started leader election for partition [t2,2] (state.change.logger)
[2015-08-10 16:25:10,093] TRACE Controller 1 epoch 57 received response UpdateMetadataResponse(5,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-10 16:25:10,101] ERROR Controller 1 epoch 57 initiated state change for partition [t2,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,2] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:25:10,101] TRACE Controller 1 epoch 57 started leader election for partition [t2,0] (state.change.logger)
[2015-08-10 16:25:10,108] ERROR Controller 1 epoch 57 initiated state change for partition [t2,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,0] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:25:10,109] TRACE Controller 1 epoch 57 started leader election for partition [t7,0] (state.change.logger)
[2015-08-10 16:25:10,121] ERROR Controller 1 epoch 57 initiated state change for partition [t7,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t7,0] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:25:10,121] TRACE Controller 1 epoch 57 started leader election for partition [t1,1] (state.change.logger)
[2015-08-10 16:25:10,127] ERROR Controller 1 epoch 57 initiated state change for partition [t1,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,1] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:25:10,128] TRACE Controller 1 epoch 57 started leader election for partition [t3,2] (state.change.logger)
[2015-08-10 16:25:10,133] ERROR Controller 1 epoch 57 initiated state change for partition [t3,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,2] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:25:10,134] TRACE Controller 1 epoch 57 started leader election for partition [t3,0] (state.change.logger)
[2015-08-10 16:25:10,140] ERROR Controller 1 epoch 57 initiated state change for partition [t3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,0] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:25:10,140] TRACE Controller 1 epoch 57 started leader election for partition [t6,0] (state.change.logger)
[2015-08-10 16:25:10,149] ERROR Controller 1 epoch 57 initiated state change for partition [t6,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t6,0] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:25:10,150] TRACE Controller 1 epoch 57 started leader election for partition [t4,0] (state.change.logger)
[2015-08-10 16:25:10,154] TRACE Controller 1 epoch 57 elected leader 2 for Offline partition [t4,0] (state.change.logger)
[2015-08-10 16:25:10,155] TRACE Controller 1 epoch 57 changed partition [t4,0] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2015-08-10 16:25:10,155] TRACE Controller 1 epoch 57 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 7 to broker 2 for partition [t2,1] (state.change.logger)
[2015-08-10 16:25:10,155] TRACE Controller 1 epoch 57 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 7 to broker 2 for partition [t3,1] (state.change.logger)
[2015-08-10 16:25:10,155] TRACE Controller 1 epoch 57 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 7 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-10 16:25:10,155] TRACE Controller 1 epoch 57 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 7 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-10 16:25:10,156] TRACE Controller 1 epoch 57 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 7 to broker 2 for partition [t1,2] (state.change.logger)
[2015-08-10 16:25:10,156] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 7 to broker 2 for partition [t2,1] (state.change.logger)
[2015-08-10 16:25:10,156] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 7 to broker 2 for partition [t3,1] (state.change.logger)
[2015-08-10 16:25:10,156] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 7 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-10 16:25:10,156] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 7 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-10 16:25:10,156] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 7 to broker 2 for partition [t1,2] (state.change.logger)
[2015-08-10 16:25:10,156] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 7 to broker 1 for partition [t2,1] (state.change.logger)
[2015-08-10 16:25:10,156] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 7 to broker 1 for partition [t3,1] (state.change.logger)
[2015-08-10 16:25:10,156] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 7 to broker 1 for partition [t1,0] (state.change.logger)
[2015-08-10 16:25:10,157] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 7 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-10 16:25:10,157] TRACE Controller 1 epoch 57 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 7 to broker 1 for partition [t1,2] (state.change.logger)
[2015-08-10 16:25:10,158] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) for partition [t2,1] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 7 (state.change.logger)
[2015-08-10 16:25:10,158] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) for partition [t3,1] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 7 (state.change.logger)
[2015-08-10 16:25:10,158] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 7 (state.change.logger)
[2015-08-10 16:25:10,158] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 7 (state.change.logger)
[2015-08-10 16:25:10,159] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) for partition [t1,2] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 7 (state.change.logger)
[2015-08-10 16:25:10,159] TRACE Controller 1 epoch 57 received response UpdateMetadataResponse(7,0) for a request sent to broker id:1,host:fufuka,port:9092 (state.change.logger)
[2015-08-10 16:25:10,174] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) correlation id 6 from controller 1 epoch 57 for partition [t2,1] (state.change.logger)
[2015-08-10 16:25:10,174] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) correlation id 6 from controller 1 epoch 57 for partition [t3,1] (state.change.logger)
[2015-08-10 16:25:10,175] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) correlation id 6 from controller 1 epoch 57 for partition [t1,0] (state.change.logger)
[2015-08-10 16:25:10,175] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) correlation id 6 from controller 1 epoch 57 for partition [t4,0] (state.change.logger)
[2015-08-10 16:25:10,175] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) correlation id 6 from controller 1 epoch 57 for partition [t1,2] (state.change.logger)
[2015-08-10 16:25:10,182] TRACE Broker 2 handling LeaderAndIsr request correlationId 6 from controller 1 epoch 57 starting the become-leader transition for partition [t1,2] (state.change.logger)
[2015-08-10 16:25:10,182] TRACE Broker 2 handling LeaderAndIsr request correlationId 6 from controller 1 epoch 57 starting the become-leader transition for partition [t3,1] (state.change.logger)
[2015-08-10 16:25:10,182] TRACE Broker 2 handling LeaderAndIsr request correlationId 6 from controller 1 epoch 57 starting the become-leader transition for partition [t2,1] (state.change.logger)
[2015-08-10 16:25:10,182] TRACE Broker 2 handling LeaderAndIsr request correlationId 6 from controller 1 epoch 57 starting the become-leader transition for partition [t1,0] (state.change.logger)
[2015-08-10 16:25:10,183] TRACE Broker 2 handling LeaderAndIsr request correlationId 6 from controller 1 epoch 57 starting the become-leader transition for partition [t4,0] (state.change.logger)
[2015-08-10 16:25:10,185] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 57 with correlation id 6 for partition [t1,2] (state.change.logger)
[2015-08-10 16:25:10,186] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 57 with correlation id 6 for partition [t3,1] (state.change.logger)
[2015-08-10 16:25:10,186] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 57 with correlation id 6 for partition [t2,1] (state.change.logger)
[2015-08-10 16:25:10,186] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 57 with correlation id 6 for partition [t1,0] (state.change.logger)
[2015-08-10 16:25:10,186] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 57 with correlation id 6 for partition [t4,0] (state.change.logger)
[2015-08-10 16:25:10,214] TRACE Broker 2 completed LeaderAndIsr request correlationId 6 from controller 1 epoch 57 for the become-leader transition for partition [t1,2] (state.change.logger)
[2015-08-10 16:25:10,214] TRACE Broker 2 completed LeaderAndIsr request correlationId 6 from controller 1 epoch 57 for the become-leader transition for partition [t3,1] (state.change.logger)
[2015-08-10 16:25:10,215] TRACE Broker 2 completed LeaderAndIsr request correlationId 6 from controller 1 epoch 57 for the become-leader transition for partition [t2,1] (state.change.logger)
[2015-08-10 16:25:10,215] TRACE Broker 2 completed LeaderAndIsr request correlationId 6 from controller 1 epoch 57 for the become-leader transition for partition [t1,0] (state.change.logger)
[2015-08-10 16:25:10,215] TRACE Broker 2 completed LeaderAndIsr request correlationId 6 from controller 1 epoch 57 for the become-leader transition for partition [t4,0] (state.change.logger)
[2015-08-10 16:25:10,221] TRACE Controller 1 epoch 57 received response LeaderAndIsrResponse(6,Map((t2,1) -> 0, (t1,2) -> 0, (t3,1) -> 0, (t1,0) -> 0, (t4,0) -> 0),0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-10 16:25:10,222] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t2,1] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 6 (state.change.logger)
[2015-08-10 16:25:10,223] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t3,1] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 6 (state.change.logger)
[2015-08-10 16:25:10,223] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 6 (state.change.logger)
[2015-08-10 16:25:10,223] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 6 (state.change.logger)
[2015-08-10 16:25:10,223] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:47,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:2) for partition [t1,2] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 6 (state.change.logger)
[2015-08-10 16:25:10,224] TRACE Controller 1 epoch 57 received response UpdateMetadataResponse(6,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-10 16:25:10,225] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) correlation id 7 from controller 1 epoch 57 for partition [t2,1] (state.change.logger)
[2015-08-10 16:25:10,225] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) correlation id 7 from controller 1 epoch 57 for partition [t3,1] (state.change.logger)
[2015-08-10 16:25:10,225] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) correlation id 7 from controller 1 epoch 57 for partition [t1,0] (state.change.logger)
[2015-08-10 16:25:10,225] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) correlation id 7 from controller 1 epoch 57 for partition [t4,0] (state.change.logger)
[2015-08-10 16:25:10,225] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) correlation id 7 from controller 1 epoch 57 for partition [t1,2] (state.change.logger)
[2015-08-10 16:25:10,226] TRACE Broker 2 handling LeaderAndIsr request correlationId 7 from controller 1 epoch 57 starting the become-leader transition for partition [t1,2] (state.change.logger)
[2015-08-10 16:25:10,226] TRACE Broker 2 handling LeaderAndIsr request correlationId 7 from controller 1 epoch 57 starting the become-leader transition for partition [t3,1] (state.change.logger)
[2015-08-10 16:25:10,226] TRACE Broker 2 handling LeaderAndIsr request correlationId 7 from controller 1 epoch 57 starting the become-leader transition for partition [t2,1] (state.change.logger)
[2015-08-10 16:25:10,226] TRACE Broker 2 handling LeaderAndIsr request correlationId 7 from controller 1 epoch 57 starting the become-leader transition for partition [t1,0] (state.change.logger)
[2015-08-10 16:25:10,226] TRACE Broker 2 handling LeaderAndIsr request correlationId 7 from controller 1 epoch 57 starting the become-leader transition for partition [t4,0] (state.change.logger)
[2015-08-10 16:25:10,227] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 57 with correlation id 7 for partition [t1,2] (state.change.logger)
[2015-08-10 16:25:10,227] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 57 with correlation id 7 for partition [t3,1] (state.change.logger)
[2015-08-10 16:25:10,227] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 57 with correlation id 7 for partition [t2,1] (state.change.logger)
[2015-08-10 16:25:10,227] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 57 with correlation id 7 for partition [t1,0] (state.change.logger)
[2015-08-10 16:25:10,227] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 57 with correlation id 7 for partition [t4,0] (state.change.logger)
[2015-08-10 16:25:10,228] TRACE Broker 2 completed LeaderAndIsr request correlationId 7 from controller 1 epoch 57 for the become-leader transition for partition [t1,2] (state.change.logger)
[2015-08-10 16:25:10,228] TRACE Broker 2 completed LeaderAndIsr request correlationId 7 from controller 1 epoch 57 for the become-leader transition for partition [t3,1] (state.change.logger)
[2015-08-10 16:25:10,229] TRACE Broker 2 completed LeaderAndIsr request correlationId 7 from controller 1 epoch 57 for the become-leader transition for partition [t2,1] (state.change.logger)
[2015-08-10 16:25:10,229] TRACE Broker 2 completed LeaderAndIsr request correlationId 7 from controller 1 epoch 57 for the become-leader transition for partition [t1,0] (state.change.logger)
[2015-08-10 16:25:10,229] TRACE Broker 2 completed LeaderAndIsr request correlationId 7 from controller 1 epoch 57 for the become-leader transition for partition [t4,0] (state.change.logger)
[2015-08-10 16:25:10,230] TRACE Controller 1 epoch 57 received response LeaderAndIsrResponse(7,Map((t2,1) -> 0, (t1,2) -> 0, (t3,1) -> 0, (t1,0) -> 0, (t4,0) -> 0),0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-10 16:25:10,232] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) for partition [t2,1] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 7 (state.change.logger)
[2015-08-10 16:25:10,232] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) for partition [t3,1] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 7 (state.change.logger)
[2015-08-10 16:25:10,232] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 7 (state.change.logger)
[2015-08-10 16:25:10,232] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 7 (state.change.logger)
[2015-08-10 16:25:10,232] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) for partition [t1,2] in response to UpdateMetadata request sent by controller 1 epoch 57 with correlation id 7 (state.change.logger)
[2015-08-10 16:25:10,233] TRACE Controller 1 epoch 57 received response UpdateMetadataResponse(7,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-10 16:35:18,248] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2015-08-10 16:38:17,172] TRACE Controller 2 epoch 58 started leader election for partition [t2,1] (state.change.logger)
[2015-08-10 16:38:17,184] ERROR Controller 2 epoch 58 initiated state change for partition [t2,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,1] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:38:17,186] TRACE Controller 2 epoch 58 started leader election for partition [t1,2] (state.change.logger)
[2015-08-10 16:38:17,195] ERROR Controller 2 epoch 58 initiated state change for partition [t1,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,2] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:38:17,196] TRACE Controller 2 epoch 58 started leader election for partition [t3,1] (state.change.logger)
[2015-08-10 16:38:17,206] ERROR Controller 2 epoch 58 initiated state change for partition [t3,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,1] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:38:17,207] TRACE Controller 2 epoch 58 started leader election for partition [t1,0] (state.change.logger)
[2015-08-10 16:38:17,216] ERROR Controller 2 epoch 58 initiated state change for partition [t1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:38:17,217] TRACE Controller 2 epoch 58 started leader election for partition [t2,2] (state.change.logger)
[2015-08-10 16:38:17,226] ERROR Controller 2 epoch 58 initiated state change for partition [t2,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,2] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:38:17,227] TRACE Controller 2 epoch 58 started leader election for partition [t2,0] (state.change.logger)
[2015-08-10 16:38:17,234] ERROR Controller 2 epoch 58 initiated state change for partition [t2,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:38:17,235] TRACE Controller 2 epoch 58 started leader election for partition [t7,0] (state.change.logger)
[2015-08-10 16:38:17,243] ERROR Controller 2 epoch 58 initiated state change for partition [t7,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t7,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:38:17,244] TRACE Controller 2 epoch 58 started leader election for partition [t1,1] (state.change.logger)
[2015-08-10 16:38:17,253] ERROR Controller 2 epoch 58 initiated state change for partition [t1,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,1] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:38:17,254] TRACE Controller 2 epoch 58 started leader election for partition [t3,2] (state.change.logger)
[2015-08-10 16:38:17,263] ERROR Controller 2 epoch 58 initiated state change for partition [t3,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,2] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:38:17,263] TRACE Controller 2 epoch 58 started leader election for partition [t3,0] (state.change.logger)
[2015-08-10 16:38:17,271] ERROR Controller 2 epoch 58 initiated state change for partition [t3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:38:17,272] TRACE Controller 2 epoch 58 started leader election for partition [t6,0] (state.change.logger)
[2015-08-10 16:38:17,278] ERROR Controller 2 epoch 58 initiated state change for partition [t6,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t6,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:38:17,280] TRACE Controller 2 epoch 58 started leader election for partition [t4,0] (state.change.logger)
[2015-08-10 16:38:17,286] ERROR Controller 2 epoch 58 initiated state change for partition [t4,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t4,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:38:17,367] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 2 for partition [t1,1] (state.change.logger)
[2015-08-10 16:38:17,367] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 2 for partition [t3,0] (state.change.logger)
[2015-08-10 16:38:17,368] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 3 to broker 2 for partition [t2,1] (state.change.logger)
[2015-08-10 16:38:17,368] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 3 to broker 2 for partition [t3,1] (state.change.logger)
[2015-08-10 16:38:17,368] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 2 for partition [t3,2] (state.change.logger)
[2015-08-10 16:38:17,368] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 2 for partition [t7,0] (state.change.logger)
[2015-08-10 16:38:17,369] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 3 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-10 16:38:17,369] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 3 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-10 16:38:17,369] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 2 for partition [t6,0] (state.change.logger)
[2015-08-10 16:38:17,369] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 3 to broker 2 for partition [t1,2] (state.change.logger)
[2015-08-10 16:38:17,369] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 2 for partition [t2,0] (state.change.logger)
[2015-08-10 16:38:17,370] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 2 for partition [t2,2] (state.change.logger)
[2015-08-10 16:38:17,381] TRACE Controller 2 epoch 58 changed state of replica 2 for partition [t3,1] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 16:38:17,381] TRACE Controller 2 epoch 58 changed state of replica 2 for partition [t2,1] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 16:38:17,382] TRACE Controller 2 epoch 58 changed state of replica 2 for partition [t4,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 16:38:17,382] TRACE Controller 2 epoch 58 changed state of replica 2 for partition [t1,2] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 16:38:17,382] TRACE Controller 2 epoch 58 changed state of replica 2 for partition [t1,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 16:38:17,384] TRACE Controller 2 epoch 58 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 4 to broker 2 for partition [t2,1] (state.change.logger)
[2015-08-10 16:38:17,385] TRACE Controller 2 epoch 58 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 4 to broker 2 for partition [t3,1] (state.change.logger)
[2015-08-10 16:38:17,385] TRACE Controller 2 epoch 58 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 4 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-10 16:38:17,385] TRACE Controller 2 epoch 58 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 4 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-10 16:38:17,385] TRACE Controller 2 epoch 58 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 4 to broker 2 for partition [t1,2] (state.change.logger)
[2015-08-10 16:38:17,385] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 4 to broker 2 for partition [t2,1] (state.change.logger)
[2015-08-10 16:38:17,386] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 4 to broker 2 for partition [t3,1] (state.change.logger)
[2015-08-10 16:38:17,386] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 4 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-10 16:38:17,386] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 4 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-10 16:38:17,386] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57) with correlationId 4 to broker 2 for partition [t1,2] (state.change.logger)
[2015-08-10 16:38:17,386] TRACE Controller 2 epoch 58 started leader election for partition [t2,1] (state.change.logger)
[2015-08-10 16:38:17,398] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t1,1] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 3 (state.change.logger)
[2015-08-10 16:38:17,398] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t3,0] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 3 (state.change.logger)
[2015-08-10 16:38:17,398] TRACE Controller 2 epoch 58 elected leader 2 for Offline partition [t2,1] (state.change.logger)
[2015-08-10 16:38:17,399] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) for partition [t2,1] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 3 (state.change.logger)
[2015-08-10 16:38:17,399] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) for partition [t3,1] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 3 (state.change.logger)
[2015-08-10 16:38:17,399] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t3,2] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 3 (state.change.logger)
[2015-08-10 16:38:17,399] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t7,0] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 3 (state.change.logger)
[2015-08-10 16:38:17,400] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 3 (state.change.logger)
[2015-08-10 16:38:17,400] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) for partition [t4,0] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 3 (state.change.logger)
[2015-08-10 16:38:17,400] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t6,0] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 3 (state.change.logger)
[2015-08-10 16:38:17,400] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) for partition [t1,2] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 3 (state.change.logger)
[2015-08-10 16:38:17,400] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t2,0] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 3 (state.change.logger)
[2015-08-10 16:38:17,401] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t2,2] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 3 (state.change.logger)
[2015-08-10 16:38:17,401] TRACE Controller 2 epoch 58 changed partition [t2,1] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2015-08-10 16:38:17,402] TRACE Controller 2 epoch 58 started leader election for partition [t1,2] (state.change.logger)
[2015-08-10 16:38:17,409] TRACE Controller 2 epoch 58 elected leader 2 for Offline partition [t1,2] (state.change.logger)
[2015-08-10 16:38:17,410] TRACE Controller 2 epoch 58 changed partition [t1,2] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2015-08-10 16:38:17,410] TRACE Controller 2 epoch 58 started leader election for partition [t3,1] (state.change.logger)
[2015-08-10 16:38:17,414] TRACE Controller 2 epoch 58 received response UpdateMetadataResponse(3,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-10 16:38:17,418] TRACE Controller 2 epoch 58 elected leader 2 for Offline partition [t3,1] (state.change.logger)
[2015-08-10 16:38:17,419] TRACE Controller 2 epoch 58 changed partition [t3,1] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2015-08-10 16:38:17,419] TRACE Controller 2 epoch 58 started leader election for partition [t1,0] (state.change.logger)
[2015-08-10 16:38:17,429] TRACE Controller 2 epoch 58 elected leader 2 for Offline partition [t1,0] (state.change.logger)
[2015-08-10 16:38:17,430] TRACE Controller 2 epoch 58 changed partition [t1,0] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2015-08-10 16:38:17,430] TRACE Controller 2 epoch 58 started leader election for partition [t2,2] (state.change.logger)
[2015-08-10 16:38:17,437] ERROR Controller 2 epoch 58 initiated state change for partition [t2,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,2] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:38:17,437] TRACE Controller 2 epoch 58 started leader election for partition [t2,0] (state.change.logger)
[2015-08-10 16:38:17,445] ERROR Controller 2 epoch 58 initiated state change for partition [t2,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:38:17,445] TRACE Controller 2 epoch 58 started leader election for partition [t7,0] (state.change.logger)
[2015-08-10 16:38:17,451] ERROR Controller 2 epoch 58 initiated state change for partition [t7,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t7,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:38:17,452] TRACE Controller 2 epoch 58 started leader election for partition [t1,1] (state.change.logger)
[2015-08-10 16:38:17,456] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) correlation id 4 from controller 2 epoch 58 for partition [t2,1] (state.change.logger)
[2015-08-10 16:38:17,456] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) correlation id 4 from controller 2 epoch 58 for partition [t3,1] (state.change.logger)
[2015-08-10 16:38:17,456] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) correlation id 4 from controller 2 epoch 58 for partition [t1,0] (state.change.logger)
[2015-08-10 16:38:17,457] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) correlation id 4 from controller 2 epoch 58 for partition [t4,0] (state.change.logger)
[2015-08-10 16:38:17,457] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) correlation id 4 from controller 2 epoch 58 for partition [t1,2] (state.change.logger)
[2015-08-10 16:38:17,458] ERROR Controller 2 epoch 58 initiated state change for partition [t1,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,1] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:38:17,459] TRACE Controller 2 epoch 58 started leader election for partition [t3,2] (state.change.logger)
[2015-08-10 16:38:17,466] ERROR Controller 2 epoch 58 initiated state change for partition [t3,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,2] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:38:17,466] TRACE Broker 2 handling LeaderAndIsr request correlationId 4 from controller 2 epoch 58 starting the become-leader transition for partition [t1,2] (state.change.logger)
[2015-08-10 16:38:17,466] TRACE Controller 2 epoch 58 started leader election for partition [t3,0] (state.change.logger)
[2015-08-10 16:38:17,466] TRACE Broker 2 handling LeaderAndIsr request correlationId 4 from controller 2 epoch 58 starting the become-leader transition for partition [t3,1] (state.change.logger)
[2015-08-10 16:38:17,467] TRACE Broker 2 handling LeaderAndIsr request correlationId 4 from controller 2 epoch 58 starting the become-leader transition for partition [t2,1] (state.change.logger)
[2015-08-10 16:38:17,467] TRACE Broker 2 handling LeaderAndIsr request correlationId 4 from controller 2 epoch 58 starting the become-leader transition for partition [t1,0] (state.change.logger)
[2015-08-10 16:38:17,467] TRACE Broker 2 handling LeaderAndIsr request correlationId 4 from controller 2 epoch 58 starting the become-leader transition for partition [t4,0] (state.change.logger)
[2015-08-10 16:38:17,472] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 58 with correlation id 4 for partition [t1,2] (state.change.logger)
[2015-08-10 16:38:17,472] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 58 with correlation id 4 for partition [t3,1] (state.change.logger)
[2015-08-10 16:38:17,473] ERROR Controller 2 epoch 58 initiated state change for partition [t3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:38:17,473] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 58 with correlation id 4 for partition [t2,1] (state.change.logger)
[2015-08-10 16:38:17,474] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 58 with correlation id 4 for partition [t1,0] (state.change.logger)
[2015-08-10 16:38:17,474] TRACE Controller 2 epoch 58 started leader election for partition [t6,0] (state.change.logger)
[2015-08-10 16:38:17,474] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 58 with correlation id 4 for partition [t4,0] (state.change.logger)
[2015-08-10 16:38:17,481] ERROR Controller 2 epoch 58 initiated state change for partition [t6,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t6,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:38:17,481] TRACE Controller 2 epoch 58 started leader election for partition [t4,0] (state.change.logger)
[2015-08-10 16:38:17,488] TRACE Controller 2 epoch 58 elected leader 2 for Offline partition [t4,0] (state.change.logger)
[2015-08-10 16:38:17,490] TRACE Controller 2 epoch 58 changed partition [t4,0] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2015-08-10 16:38:17,490] TRACE Controller 2 epoch 58 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58) with correlationId 5 to broker 2 for partition [t2,1] (state.change.logger)
[2015-08-10 16:38:17,490] TRACE Controller 2 epoch 58 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58) with correlationId 5 to broker 2 for partition [t3,1] (state.change.logger)
[2015-08-10 16:38:17,490] TRACE Controller 2 epoch 58 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58) with correlationId 5 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-10 16:38:17,490] TRACE Controller 2 epoch 58 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58) with correlationId 5 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-10 16:38:17,491] TRACE Controller 2 epoch 58 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58) with correlationId 5 to broker 2 for partition [t1,2] (state.change.logger)
[2015-08-10 16:38:17,491] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58) with correlationId 5 to broker 2 for partition [t2,1] (state.change.logger)
[2015-08-10 16:38:17,491] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58) with correlationId 5 to broker 2 for partition [t3,1] (state.change.logger)
[2015-08-10 16:38:17,491] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58) with correlationId 5 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-10 16:38:17,491] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58) with correlationId 5 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-10 16:38:17,491] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58) with correlationId 5 to broker 2 for partition [t1,2] (state.change.logger)
[2015-08-10 16:38:17,506] TRACE Broker 2 completed LeaderAndIsr request correlationId 4 from controller 2 epoch 58 for the become-leader transition for partition [t1,2] (state.change.logger)
[2015-08-10 16:38:17,506] TRACE Broker 2 completed LeaderAndIsr request correlationId 4 from controller 2 epoch 58 for the become-leader transition for partition [t3,1] (state.change.logger)
[2015-08-10 16:38:17,506] TRACE Broker 2 completed LeaderAndIsr request correlationId 4 from controller 2 epoch 58 for the become-leader transition for partition [t2,1] (state.change.logger)
[2015-08-10 16:38:17,506] TRACE Broker 2 completed LeaderAndIsr request correlationId 4 from controller 2 epoch 58 for the become-leader transition for partition [t1,0] (state.change.logger)
[2015-08-10 16:38:17,506] TRACE Broker 2 completed LeaderAndIsr request correlationId 4 from controller 2 epoch 58 for the become-leader transition for partition [t4,0] (state.change.logger)
[2015-08-10 16:38:17,511] TRACE Controller 2 epoch 58 received response LeaderAndIsrResponse(4,Map((t2,1) -> 0, (t1,2) -> 0, (t3,1) -> 0, (t1,0) -> 0, (t4,0) -> 0),0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-10 16:38:17,513] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) for partition [t2,1] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 4 (state.change.logger)
[2015-08-10 16:38:17,513] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) for partition [t3,1] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 4 (state.change.logger)
[2015-08-10 16:38:17,513] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 4 (state.change.logger)
[2015-08-10 16:38:17,513] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) for partition [t4,0] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 4 (state.change.logger)
[2015-08-10 16:38:17,513] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:2) for partition [t1,2] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 4 (state.change.logger)
[2015-08-10 16:38:17,514] TRACE Controller 2 epoch 58 received response UpdateMetadataResponse(4,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-10 16:38:17,515] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58),ReplicationFactor:1),AllReplicas:2) correlation id 5 from controller 2 epoch 58 for partition [t2,1] (state.change.logger)
[2015-08-10 16:38:17,515] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58),ReplicationFactor:1),AllReplicas:2) correlation id 5 from controller 2 epoch 58 for partition [t3,1] (state.change.logger)
[2015-08-10 16:38:17,515] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58),ReplicationFactor:1),AllReplicas:2) correlation id 5 from controller 2 epoch 58 for partition [t1,0] (state.change.logger)
[2015-08-10 16:38:17,515] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58),ReplicationFactor:1),AllReplicas:2) correlation id 5 from controller 2 epoch 58 for partition [t4,0] (state.change.logger)
[2015-08-10 16:38:17,516] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58),ReplicationFactor:1),AllReplicas:2) correlation id 5 from controller 2 epoch 58 for partition [t1,2] (state.change.logger)
[2015-08-10 16:38:17,516] TRACE Broker 2 handling LeaderAndIsr request correlationId 5 from controller 2 epoch 58 starting the become-leader transition for partition [t1,2] (state.change.logger)
[2015-08-10 16:38:17,516] TRACE Broker 2 handling LeaderAndIsr request correlationId 5 from controller 2 epoch 58 starting the become-leader transition for partition [t3,1] (state.change.logger)
[2015-08-10 16:38:17,516] TRACE Broker 2 handling LeaderAndIsr request correlationId 5 from controller 2 epoch 58 starting the become-leader transition for partition [t2,1] (state.change.logger)
[2015-08-10 16:38:17,516] TRACE Broker 2 handling LeaderAndIsr request correlationId 5 from controller 2 epoch 58 starting the become-leader transition for partition [t1,0] (state.change.logger)
[2015-08-10 16:38:17,516] TRACE Broker 2 handling LeaderAndIsr request correlationId 5 from controller 2 epoch 58 starting the become-leader transition for partition [t4,0] (state.change.logger)
[2015-08-10 16:38:17,517] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 58 with correlation id 5 for partition [t1,2] (state.change.logger)
[2015-08-10 16:38:17,517] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 58 with correlation id 5 for partition [t3,1] (state.change.logger)
[2015-08-10 16:38:17,517] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 58 with correlation id 5 for partition [t2,1] (state.change.logger)
[2015-08-10 16:38:17,517] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 58 with correlation id 5 for partition [t1,0] (state.change.logger)
[2015-08-10 16:38:17,517] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 58 with correlation id 5 for partition [t4,0] (state.change.logger)
[2015-08-10 16:38:17,518] TRACE Broker 2 completed LeaderAndIsr request correlationId 5 from controller 2 epoch 58 for the become-leader transition for partition [t1,2] (state.change.logger)
[2015-08-10 16:38:17,518] TRACE Broker 2 completed LeaderAndIsr request correlationId 5 from controller 2 epoch 58 for the become-leader transition for partition [t3,1] (state.change.logger)
[2015-08-10 16:38:17,518] TRACE Broker 2 completed LeaderAndIsr request correlationId 5 from controller 2 epoch 58 for the become-leader transition for partition [t2,1] (state.change.logger)
[2015-08-10 16:38:17,518] TRACE Broker 2 completed LeaderAndIsr request correlationId 5 from controller 2 epoch 58 for the become-leader transition for partition [t1,0] (state.change.logger)
[2015-08-10 16:38:17,518] TRACE Broker 2 completed LeaderAndIsr request correlationId 5 from controller 2 epoch 58 for the become-leader transition for partition [t4,0] (state.change.logger)
[2015-08-10 16:38:17,519] TRACE Controller 2 epoch 58 received response LeaderAndIsrResponse(5,Map((t2,1) -> 0, (t1,2) -> 0, (t3,1) -> 0, (t1,0) -> 0, (t4,0) -> 0),0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-10 16:38:17,520] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58),ReplicationFactor:1),AllReplicas:2) for partition [t2,1] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 5 (state.change.logger)
[2015-08-10 16:38:17,520] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58),ReplicationFactor:1),AllReplicas:2) for partition [t3,1] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 5 (state.change.logger)
[2015-08-10 16:38:17,520] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 5 (state.change.logger)
[2015-08-10 16:38:17,520] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58),ReplicationFactor:1),AllReplicas:2) for partition [t4,0] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 5 (state.change.logger)
[2015-08-10 16:38:17,521] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58),ReplicationFactor:1),AllReplicas:2) for partition [t1,2] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 5 (state.change.logger)
[2015-08-10 16:38:17,521] TRACE Controller 2 epoch 58 received response UpdateMetadataResponse(5,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-10 16:38:38,371] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 6 to broker 1 for partition [t1,1] (state.change.logger)
[2015-08-10 16:38:38,371] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 6 to broker 1 for partition [t3,0] (state.change.logger)
[2015-08-10 16:38:38,371] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58) with correlationId 6 to broker 1 for partition [t2,1] (state.change.logger)
[2015-08-10 16:38:38,371] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58) with correlationId 6 to broker 1 for partition [t3,1] (state.change.logger)
[2015-08-10 16:38:38,371] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 6 to broker 1 for partition [t3,2] (state.change.logger)
[2015-08-10 16:38:38,371] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 6 to broker 1 for partition [t7,0] (state.change.logger)
[2015-08-10 16:38:38,371] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58) with correlationId 6 to broker 1 for partition [t1,0] (state.change.logger)
[2015-08-10 16:38:38,372] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58) with correlationId 6 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-10 16:38:38,372] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 6 to broker 1 for partition [t6,0] (state.change.logger)
[2015-08-10 16:38:38,372] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58) with correlationId 6 to broker 1 for partition [t1,2] (state.change.logger)
[2015-08-10 16:38:38,372] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 6 to broker 1 for partition [t2,0] (state.change.logger)
[2015-08-10 16:38:38,372] TRACE Controller 2 epoch 58 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 6 to broker 1 for partition [t2,2] (state.change.logger)
[2015-08-10 16:38:38,372] TRACE Controller 2 epoch 58 started leader election for partition [t2,2] (state.change.logger)
[2015-08-10 16:38:38,383] ERROR Controller 2 epoch 58 initiated state change for partition [t2,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,2] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:38:38,383] TRACE Controller 2 epoch 58 started leader election for partition [t2,0] (state.change.logger)
[2015-08-10 16:38:38,389] ERROR Controller 2 epoch 58 initiated state change for partition [t2,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,0] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:38:38,389] TRACE Controller 2 epoch 58 started leader election for partition [t7,0] (state.change.logger)
[2015-08-10 16:38:38,394] ERROR Controller 2 epoch 58 initiated state change for partition [t7,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t7,0] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:38:38,395] TRACE Controller 2 epoch 58 started leader election for partition [t1,1] (state.change.logger)
[2015-08-10 16:38:38,402] ERROR Controller 2 epoch 58 initiated state change for partition [t1,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,1] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:38:38,403] TRACE Controller 2 epoch 58 started leader election for partition [t3,2] (state.change.logger)
[2015-08-10 16:38:38,409] ERROR Controller 2 epoch 58 initiated state change for partition [t3,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,2] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:38:38,410] TRACE Controller 2 epoch 58 started leader election for partition [t3,0] (state.change.logger)
[2015-08-10 16:38:38,416] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t1,1] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 6 (state.change.logger)
[2015-08-10 16:38:38,417] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t3,0] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 6 (state.change.logger)
[2015-08-10 16:38:38,417] ERROR Controller 2 epoch 58 initiated state change for partition [t3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,0] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:38:38,417] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58),ReplicationFactor:1),AllReplicas:2) for partition [t2,1] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 6 (state.change.logger)
[2015-08-10 16:38:38,417] TRACE Controller 2 epoch 58 started leader election for partition [t6,0] (state.change.logger)
[2015-08-10 16:38:38,417] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58),ReplicationFactor:1),AllReplicas:2) for partition [t3,1] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 6 (state.change.logger)
[2015-08-10 16:38:38,418] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t3,2] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 6 (state.change.logger)
[2015-08-10 16:38:38,418] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t7,0] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 6 (state.change.logger)
[2015-08-10 16:38:38,419] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 6 (state.change.logger)
[2015-08-10 16:38:38,419] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58),ReplicationFactor:1),AllReplicas:2) for partition [t4,0] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 6 (state.change.logger)
[2015-08-10 16:38:38,419] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t6,0] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 6 (state.change.logger)
[2015-08-10 16:38:38,420] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58),ReplicationFactor:1),AllReplicas:2) for partition [t1,2] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 6 (state.change.logger)
[2015-08-10 16:38:38,420] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t2,0] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 6 (state.change.logger)
[2015-08-10 16:38:38,420] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t2,2] in response to UpdateMetadata request sent by controller 2 epoch 58 with correlation id 6 (state.change.logger)
[2015-08-10 16:38:38,430] ERROR Controller 2 epoch 58 initiated state change for partition [t6,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t6,0] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:38:38,438] TRACE Controller 2 epoch 58 received response UpdateMetadataResponse(6,0) for a request sent to broker id:1,host:fufuka,port:9092 (state.change.logger)
[2015-08-10 16:42:34,578] TRACE Controller 2 epoch 58 started leader election for partition [t2,2] (state.change.logger)
[2015-08-10 16:42:34,581] ERROR Controller 2 epoch 58 initiated state change for partition [t2,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,2] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:446)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:373)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:42:34,582] TRACE Controller 2 epoch 58 started leader election for partition [t2,0] (state.change.logger)
[2015-08-10 16:42:34,586] ERROR Controller 2 epoch 58 initiated state change for partition [t2,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:446)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:373)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:42:34,587] TRACE Controller 2 epoch 58 started leader election for partition [t7,0] (state.change.logger)
[2015-08-10 16:42:34,592] ERROR Controller 2 epoch 58 initiated state change for partition [t7,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t7,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:446)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:373)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:42:34,592] TRACE Controller 2 epoch 58 started leader election for partition [t1,1] (state.change.logger)
[2015-08-10 16:42:34,604] ERROR Controller 2 epoch 58 initiated state change for partition [t1,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,1] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:446)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:373)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:42:34,604] TRACE Controller 2 epoch 58 started leader election for partition [t3,2] (state.change.logger)
[2015-08-10 16:42:34,608] ERROR Controller 2 epoch 58 initiated state change for partition [t3,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,2] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:446)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:373)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:42:34,608] TRACE Controller 2 epoch 58 started leader election for partition [t3,0] (state.change.logger)
[2015-08-10 16:42:34,611] ERROR Controller 2 epoch 58 initiated state change for partition [t3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:446)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:373)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:42:34,611] TRACE Controller 2 epoch 58 started leader election for partition [t6,0] (state.change.logger)
[2015-08-10 16:42:34,614] ERROR Controller 2 epoch 58 initiated state change for partition [t6,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t6,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:446)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:373)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:53:40,507] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2015-08-10 16:53:57,070] TRACE Controller 1 epoch 60 started leader election for partition [t2,1] (state.change.logger)
[2015-08-10 16:53:57,082] ERROR Controller 1 epoch 60 initiated state change for partition [t2,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,1] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:53:57,085] TRACE Controller 1 epoch 60 started leader election for partition [t1,2] (state.change.logger)
[2015-08-10 16:53:57,096] ERROR Controller 1 epoch 60 initiated state change for partition [t1,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,2] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:53:57,097] TRACE Controller 1 epoch 60 started leader election for partition [t3,1] (state.change.logger)
[2015-08-10 16:53:57,107] ERROR Controller 1 epoch 60 initiated state change for partition [t3,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,1] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:53:57,108] TRACE Controller 1 epoch 60 started leader election for partition [t1,0] (state.change.logger)
[2015-08-10 16:53:57,118] ERROR Controller 1 epoch 60 initiated state change for partition [t1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:53:57,119] TRACE Controller 1 epoch 60 started leader election for partition [t2,2] (state.change.logger)
[2015-08-10 16:53:57,128] ERROR Controller 1 epoch 60 initiated state change for partition [t2,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,2] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:53:57,129] TRACE Controller 1 epoch 60 started leader election for partition [t2,0] (state.change.logger)
[2015-08-10 16:53:57,139] ERROR Controller 1 epoch 60 initiated state change for partition [t2,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:53:57,140] TRACE Controller 1 epoch 60 started leader election for partition [t7,0] (state.change.logger)
[2015-08-10 16:53:57,147] ERROR Controller 1 epoch 60 initiated state change for partition [t7,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t7,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:53:57,148] TRACE Controller 1 epoch 60 started leader election for partition [t1,1] (state.change.logger)
[2015-08-10 16:53:57,156] ERROR Controller 1 epoch 60 initiated state change for partition [t1,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,1] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:53:57,157] TRACE Controller 1 epoch 60 started leader election for partition [t3,2] (state.change.logger)
[2015-08-10 16:53:57,167] ERROR Controller 1 epoch 60 initiated state change for partition [t3,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,2] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:53:57,168] TRACE Controller 1 epoch 60 started leader election for partition [t3,0] (state.change.logger)
[2015-08-10 16:53:57,178] ERROR Controller 1 epoch 60 initiated state change for partition [t3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:53:57,179] TRACE Controller 1 epoch 60 started leader election for partition [t6,0] (state.change.logger)
[2015-08-10 16:53:57,189] ERROR Controller 1 epoch 60 initiated state change for partition [t6,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t6,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:53:57,189] TRACE Controller 1 epoch 60 started leader election for partition [t4,0] (state.change.logger)
[2015-08-10 16:53:57,200] ERROR Controller 1 epoch 60 initiated state change for partition [t4,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t4,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:314)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:161)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:81)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:49)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:47)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:47)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:650)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:646)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.KafkaController.startup(KafkaController.scala:646)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:117)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:29)
	at kafka.Kafka$.main(Kafka.scala:46)
	at kafka.Kafka.main(Kafka.scala)
[2015-08-10 16:53:57,303] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t1,1] (state.change.logger)
[2015-08-10 16:53:57,303] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t3,0] (state.change.logger)
[2015-08-10 16:53:57,303] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 3 to broker 1 for partition [t2,1] (state.change.logger)
[2015-08-10 16:53:57,304] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 3 to broker 1 for partition [t3,1] (state.change.logger)
[2015-08-10 16:53:57,304] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t3,2] (state.change.logger)
[2015-08-10 16:53:57,304] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t7,0] (state.change.logger)
[2015-08-10 16:53:57,304] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 3 to broker 1 for partition [t1,0] (state.change.logger)
[2015-08-10 16:53:57,304] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 3 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-10 16:53:57,305] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t6,0] (state.change.logger)
[2015-08-10 16:53:57,305] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 3 to broker 1 for partition [t1,2] (state.change.logger)
[2015-08-10 16:53:57,305] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t2,0] (state.change.logger)
[2015-08-10 16:53:57,305] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 3 to broker 1 for partition [t2,2] (state.change.logger)
[2015-08-10 16:53:57,308] TRACE Controller 1 epoch 60 started leader election for partition [t2,1] (state.change.logger)
[2015-08-10 16:53:57,321] ERROR Controller 1 epoch 60 initiated state change for partition [t2,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,1] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:53:57,321] TRACE Controller 1 epoch 60 started leader election for partition [t1,2] (state.change.logger)
[2015-08-10 16:53:57,333] ERROR Controller 1 epoch 60 initiated state change for partition [t1,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,2] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:53:57,333] TRACE Controller 1 epoch 60 started leader election for partition [t3,1] (state.change.logger)
[2015-08-10 16:53:57,343] ERROR Controller 1 epoch 60 initiated state change for partition [t3,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,1] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:53:57,344] TRACE Controller 1 epoch 60 started leader election for partition [t1,0] (state.change.logger)
[2015-08-10 16:53:57,344] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t1,1] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 3 (state.change.logger)
[2015-08-10 16:53:57,344] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t3,0] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 3 (state.change.logger)
[2015-08-10 16:53:57,345] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) for partition [t2,1] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 3 (state.change.logger)
[2015-08-10 16:53:57,345] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) for partition [t3,1] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 3 (state.change.logger)
[2015-08-10 16:53:57,345] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t3,2] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 3 (state.change.logger)
[2015-08-10 16:53:57,345] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t7,0] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 3 (state.change.logger)
[2015-08-10 16:53:57,346] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 3 (state.change.logger)
[2015-08-10 16:53:57,346] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 3 (state.change.logger)
[2015-08-10 16:53:57,346] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t6,0] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 3 (state.change.logger)
[2015-08-10 16:53:57,346] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) for partition [t1,2] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 3 (state.change.logger)
[2015-08-10 16:53:57,347] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t2,0] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 3 (state.change.logger)
[2015-08-10 16:53:57,347] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t2,2] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 3 (state.change.logger)
[2015-08-10 16:53:57,357] ERROR Controller 1 epoch 60 initiated state change for partition [t1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:53:57,357] TRACE Controller 1 epoch 60 started leader election for partition [t2,2] (state.change.logger)
[2015-08-10 16:53:57,365] TRACE Controller 1 epoch 60 received response UpdateMetadataResponse(3,0) for a request sent to broker id:1,host:fufuka,port:9092 (state.change.logger)
[2015-08-10 16:53:57,365] ERROR Controller 1 epoch 60 initiated state change for partition [t2,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,2] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:53:57,366] TRACE Controller 1 epoch 60 started leader election for partition [t2,0] (state.change.logger)
[2015-08-10 16:53:57,383] ERROR Controller 1 epoch 60 initiated state change for partition [t2,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:53:57,383] TRACE Controller 1 epoch 60 started leader election for partition [t7,0] (state.change.logger)
[2015-08-10 16:53:57,395] ERROR Controller 1 epoch 60 initiated state change for partition [t7,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t7,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:53:57,396] TRACE Controller 1 epoch 60 started leader election for partition [t1,1] (state.change.logger)
[2015-08-10 16:53:57,405] ERROR Controller 1 epoch 60 initiated state change for partition [t1,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,1] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:53:57,406] TRACE Controller 1 epoch 60 started leader election for partition [t3,2] (state.change.logger)
[2015-08-10 16:53:57,415] ERROR Controller 1 epoch 60 initiated state change for partition [t3,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,2] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:53:57,415] TRACE Controller 1 epoch 60 started leader election for partition [t3,0] (state.change.logger)
[2015-08-10 16:53:57,426] ERROR Controller 1 epoch 60 initiated state change for partition [t3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:53:57,427] TRACE Controller 1 epoch 60 started leader election for partition [t6,0] (state.change.logger)
[2015-08-10 16:53:57,433] ERROR Controller 1 epoch 60 initiated state change for partition [t6,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t6,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:53:57,433] TRACE Controller 1 epoch 60 started leader election for partition [t4,0] (state.change.logger)
[2015-08-10 16:53:57,440] ERROR Controller 1 epoch 60 initiated state change for partition [t4,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t4,0] is alive. Live brokers are: [Set(1)], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:54:02,183] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t1,1] (state.change.logger)
[2015-08-10 16:54:02,184] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t3,0] (state.change.logger)
[2015-08-10 16:54:02,184] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 5 to broker 2 for partition [t2,1] (state.change.logger)
[2015-08-10 16:54:02,184] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 5 to broker 2 for partition [t3,1] (state.change.logger)
[2015-08-10 16:54:02,184] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t3,2] (state.change.logger)
[2015-08-10 16:54:02,184] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t7,0] (state.change.logger)
[2015-08-10 16:54:02,184] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 5 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-10 16:54:02,184] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 5 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-10 16:54:02,185] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t6,0] (state.change.logger)
[2015-08-10 16:54:02,185] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 5 to broker 2 for partition [t1,2] (state.change.logger)
[2015-08-10 16:54:02,185] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t2,0] (state.change.logger)
[2015-08-10 16:54:02,185] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54) with correlationId 5 to broker 2 for partition [t2,2] (state.change.logger)
[2015-08-10 16:54:02,199] TRACE Controller 1 epoch 60 changed state of replica 2 for partition [t3,1] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 16:54:02,199] TRACE Controller 1 epoch 60 changed state of replica 2 for partition [t2,1] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 16:54:02,199] TRACE Controller 1 epoch 60 changed state of replica 2 for partition [t4,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 16:54:02,200] TRACE Controller 1 epoch 60 changed state of replica 2 for partition [t1,2] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 16:54:02,200] TRACE Controller 1 epoch 60 changed state of replica 2 for partition [t1,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2015-08-10 16:54:02,205] TRACE Controller 1 epoch 60 sending become-follower LeaderAndIsr request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 6 to broker 2 for partition [t2,1] (state.change.logger)
[2015-08-10 16:54:02,205] TRACE Controller 1 epoch 60 sending become-follower LeaderAndIsr request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 6 to broker 2 for partition [t3,1] (state.change.logger)
[2015-08-10 16:54:02,205] TRACE Controller 1 epoch 60 sending become-follower LeaderAndIsr request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 6 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-10 16:54:02,205] TRACE Controller 1 epoch 60 sending become-follower LeaderAndIsr request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 6 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-10 16:54:02,205] TRACE Controller 1 epoch 60 sending become-follower LeaderAndIsr request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 6 to broker 2 for partition [t1,2] (state.change.logger)
[2015-08-10 16:54:02,206] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 6 to broker 2 for partition [t2,1] (state.change.logger)
[2015-08-10 16:54:02,206] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 6 to broker 2 for partition [t3,1] (state.change.logger)
[2015-08-10 16:54:02,206] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 6 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-10 16:54:02,206] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 6 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-10 16:54:02,206] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 6 to broker 2 for partition [t1,2] (state.change.logger)
[2015-08-10 16:54:02,206] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 6 to broker 1 for partition [t2,1] (state.change.logger)
[2015-08-10 16:54:02,206] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 6 to broker 1 for partition [t3,1] (state.change.logger)
[2015-08-10 16:54:02,207] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 6 to broker 1 for partition [t1,0] (state.change.logger)
[2015-08-10 16:54:02,207] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 6 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-10 16:54:02,207] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59) with correlationId 6 to broker 1 for partition [t1,2] (state.change.logger)
[2015-08-10 16:54:02,207] TRACE Controller 1 epoch 60 started leader election for partition [t2,1] (state.change.logger)
[2015-08-10 16:54:02,209] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) for partition [t2,1] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 6 (state.change.logger)
[2015-08-10 16:54:02,209] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) for partition [t3,1] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 6 (state.change.logger)
[2015-08-10 16:54:02,209] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 6 (state.change.logger)
[2015-08-10 16:54:02,210] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 6 (state.change.logger)
[2015-08-10 16:54:02,210] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) for partition [t1,2] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 6 (state.change.logger)
[2015-08-10 16:54:02,211] TRACE Controller 1 epoch 60 received response UpdateMetadataResponse(6,0) for a request sent to broker id:1,host:fufuka,port:9092 (state.change.logger)
[2015-08-10 16:54:02,224] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t1,1] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 5 (state.change.logger)
[2015-08-10 16:54:02,224] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t3,0] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 5 (state.change.logger)
[2015-08-10 16:54:02,225] TRACE Controller 1 epoch 60 elected leader 2 for Offline partition [t2,1] (state.change.logger)
[2015-08-10 16:54:02,225] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) for partition [t2,1] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 5 (state.change.logger)
[2015-08-10 16:54:02,225] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) for partition [t3,1] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 5 (state.change.logger)
[2015-08-10 16:54:02,226] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t3,2] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 5 (state.change.logger)
[2015-08-10 16:54:02,226] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t7,0] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 5 (state.change.logger)
[2015-08-10 16:54:02,226] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 5 (state.change.logger)
[2015-08-10 16:54:02,227] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 5 (state.change.logger)
[2015-08-10 16:54:02,227] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t6,0] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 5 (state.change.logger)
[2015-08-10 16:54:02,227] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) for partition [t1,2] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 5 (state.change.logger)
[2015-08-10 16:54:02,228] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t2,0] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 5 (state.change.logger)
[2015-08-10 16:54:02,228] TRACE Controller 1 epoch 60 changed partition [t2,1] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2015-08-10 16:54:02,228] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [t2,2] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 5 (state.change.logger)
[2015-08-10 16:54:02,228] TRACE Controller 1 epoch 60 started leader election for partition [t1,2] (state.change.logger)
[2015-08-10 16:54:02,236] TRACE Controller 1 epoch 60 elected leader 2 for Offline partition [t1,2] (state.change.logger)
[2015-08-10 16:54:02,238] TRACE Controller 1 epoch 60 changed partition [t1,2] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2015-08-10 16:54:02,238] TRACE Controller 1 epoch 60 started leader election for partition [t3,1] (state.change.logger)
[2015-08-10 16:54:02,248] TRACE Controller 1 epoch 60 elected leader 2 for Offline partition [t3,1] (state.change.logger)
[2015-08-10 16:54:02,248] TRACE Controller 1 epoch 60 received response UpdateMetadataResponse(5,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-10 16:54:02,252] TRACE Controller 1 epoch 60 changed partition [t3,1] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2015-08-10 16:54:02,252] TRACE Controller 1 epoch 60 started leader election for partition [t1,0] (state.change.logger)
[2015-08-10 16:54:02,266] TRACE Controller 1 epoch 60 elected leader 2 for Offline partition [t1,0] (state.change.logger)
[2015-08-10 16:54:02,267] TRACE Controller 1 epoch 60 changed partition [t1,0] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2015-08-10 16:54:02,267] TRACE Controller 1 epoch 60 started leader election for partition [t2,2] (state.change.logger)
[2015-08-10 16:54:02,278] ERROR Controller 1 epoch 60 initiated state change for partition [t2,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,2] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:54:02,279] TRACE Controller 1 epoch 60 started leader election for partition [t2,0] (state.change.logger)
[2015-08-10 16:54:02,288] ERROR Controller 1 epoch 60 initiated state change for partition [t2,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t2,0] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:54:02,289] TRACE Controller 1 epoch 60 started leader election for partition [t7,0] (state.change.logger)
[2015-08-10 16:54:02,295] ERROR Controller 1 epoch 60 initiated state change for partition [t7,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t7,0] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:54:02,295] TRACE Controller 1 epoch 60 started leader election for partition [t1,1] (state.change.logger)
[2015-08-10 16:54:02,302] ERROR Controller 1 epoch 60 initiated state change for partition [t1,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t1,1] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:54:02,304] TRACE Controller 1 epoch 60 started leader election for partition [t3,2] (state.change.logger)
[2015-08-10 16:54:02,311] ERROR Controller 1 epoch 60 initiated state change for partition [t3,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,2] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:54:02,312] TRACE Controller 1 epoch 60 started leader election for partition [t3,0] (state.change.logger)
[2015-08-10 16:54:02,318] ERROR Controller 1 epoch 60 initiated state change for partition [t3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t3,0] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:54:02,318] TRACE Controller 1 epoch 60 started leader election for partition [t6,0] (state.change.logger)
[2015-08-10 16:54:02,326] ERROR Controller 1 epoch 60 initiated state change for partition [t6,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [t6,0] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:357)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:206)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:406)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:371)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:359)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:357)
	at kafka.utils.Utils$.inLock(Utils.scala:535)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:356)
	at org.I0Itec.zkclient.ZkClient$7.run(ZkClient.java:568)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2015-08-10 16:54:02,327] TRACE Controller 1 epoch 60 started leader election for partition [t4,0] (state.change.logger)
[2015-08-10 16:54:02,333] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) correlation id 6 from controller 1 epoch 60 for partition [t2,1] (state.change.logger)
[2015-08-10 16:54:02,333] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) correlation id 6 from controller 1 epoch 60 for partition [t3,1] (state.change.logger)
[2015-08-10 16:54:02,333] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) correlation id 6 from controller 1 epoch 60 for partition [t1,0] (state.change.logger)
[2015-08-10 16:54:02,333] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) correlation id 6 from controller 1 epoch 60 for partition [t4,0] (state.change.logger)
[2015-08-10 16:54:02,334] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) correlation id 6 from controller 1 epoch 60 for partition [t1,2] (state.change.logger)
[2015-08-10 16:54:02,337] TRACE Controller 1 epoch 60 elected leader 2 for Offline partition [t4,0] (state.change.logger)
[2015-08-10 16:54:02,340] TRACE Controller 1 epoch 60 changed partition [t4,0] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2015-08-10 16:54:02,340] TRACE Controller 1 epoch 60 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60) with correlationId 7 to broker 2 for partition [t2,1] (state.change.logger)
[2015-08-10 16:54:02,340] TRACE Controller 1 epoch 60 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60) with correlationId 7 to broker 2 for partition [t3,1] (state.change.logger)
[2015-08-10 16:54:02,341] TRACE Controller 1 epoch 60 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60) with correlationId 7 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-10 16:54:02,341] TRACE Controller 1 epoch 60 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60) with correlationId 7 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-10 16:54:02,341] TRACE Controller 1 epoch 60 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60) with correlationId 7 to broker 2 for partition [t1,2] (state.change.logger)
[2015-08-10 16:54:02,341] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60) with correlationId 7 to broker 2 for partition [t2,1] (state.change.logger)
[2015-08-10 16:54:02,341] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60) with correlationId 7 to broker 2 for partition [t3,1] (state.change.logger)
[2015-08-10 16:54:02,341] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60) with correlationId 7 to broker 2 for partition [t1,0] (state.change.logger)
[2015-08-10 16:54:02,341] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60) with correlationId 7 to broker 2 for partition [t4,0] (state.change.logger)
[2015-08-10 16:54:02,342] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60) with correlationId 7 to broker 2 for partition [t1,2] (state.change.logger)
[2015-08-10 16:54:02,342] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60) with correlationId 7 to broker 1 for partition [t2,1] (state.change.logger)
[2015-08-10 16:54:02,342] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60) with correlationId 7 to broker 1 for partition [t3,1] (state.change.logger)
[2015-08-10 16:54:02,342] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60) with correlationId 7 to broker 1 for partition [t1,0] (state.change.logger)
[2015-08-10 16:54:02,342] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60) with correlationId 7 to broker 1 for partition [t4,0] (state.change.logger)
[2015-08-10 16:54:02,342] TRACE Controller 1 epoch 60 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60) with correlationId 7 to broker 1 for partition [t1,2] (state.change.logger)
[2015-08-10 16:54:02,344] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60),ReplicationFactor:1),AllReplicas:2) for partition [t2,1] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 7 (state.change.logger)
[2015-08-10 16:54:02,344] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60),ReplicationFactor:1),AllReplicas:2) for partition [t3,1] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 7 (state.change.logger)
[2015-08-10 16:54:02,344] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 7 (state.change.logger)
[2015-08-10 16:54:02,344] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60),ReplicationFactor:1),AllReplicas:2) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 7 (state.change.logger)
[2015-08-10 16:54:02,345] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60),ReplicationFactor:1),AllReplicas:2) for partition [t1,2] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 7 (state.change.logger)
[2015-08-10 16:54:02,345] TRACE Controller 1 epoch 60 received response UpdateMetadataResponse(7,0) for a request sent to broker id:1,host:fufuka,port:9092 (state.change.logger)
[2015-08-10 16:54:02,346] TRACE Broker 2 handling LeaderAndIsr request correlationId 6 from controller 1 epoch 60 starting the become-follower transition for partition [t1,2] (state.change.logger)
[2015-08-10 16:54:02,346] TRACE Broker 2 handling LeaderAndIsr request correlationId 6 from controller 1 epoch 60 starting the become-follower transition for partition [t3,1] (state.change.logger)
[2015-08-10 16:54:02,347] TRACE Broker 2 handling LeaderAndIsr request correlationId 6 from controller 1 epoch 60 starting the become-follower transition for partition [t2,1] (state.change.logger)
[2015-08-10 16:54:02,347] TRACE Broker 2 handling LeaderAndIsr request correlationId 6 from controller 1 epoch 60 starting the become-follower transition for partition [t1,0] (state.change.logger)
[2015-08-10 16:54:02,347] TRACE Broker 2 handling LeaderAndIsr request correlationId 6 from controller 1 epoch 60 starting the become-follower transition for partition [t4,0] (state.change.logger)
[2015-08-10 16:54:02,349] ERROR Broker 2 received LeaderAndIsrRequest with correlation id 6 from controller 1 epoch 59 for partition [t1,2] but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2015-08-10 16:54:02,358] ERROR Broker 2 received LeaderAndIsrRequest with correlation id 6 from controller 1 epoch 59 for partition [t3,1] but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2015-08-10 16:54:02,363] ERROR Broker 2 received LeaderAndIsrRequest with correlation id 6 from controller 1 epoch 59 for partition [t2,1] but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2015-08-10 16:54:02,367] ERROR Broker 2 received LeaderAndIsrRequest with correlation id 6 from controller 1 epoch 59 for partition [t1,0] but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2015-08-10 16:54:02,372] ERROR Broker 2 received LeaderAndIsrRequest with correlation id 6 from controller 1 epoch 59 for partition [t4,0] but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2015-08-10 16:54:02,385] TRACE Broker 2 completed LeaderAndIsr request correlationId 6 from controller 1 epoch 60 for the become-follower transition for partition [t1,2] (state.change.logger)
[2015-08-10 16:54:02,385] TRACE Broker 2 completed LeaderAndIsr request correlationId 6 from controller 1 epoch 60 for the become-follower transition for partition [t3,1] (state.change.logger)
[2015-08-10 16:54:02,385] TRACE Broker 2 completed LeaderAndIsr request correlationId 6 from controller 1 epoch 60 for the become-follower transition for partition [t2,1] (state.change.logger)
[2015-08-10 16:54:02,385] TRACE Broker 2 completed LeaderAndIsr request correlationId 6 from controller 1 epoch 60 for the become-follower transition for partition [t1,0] (state.change.logger)
[2015-08-10 16:54:02,386] TRACE Broker 2 completed LeaderAndIsr request correlationId 6 from controller 1 epoch 60 for the become-follower transition for partition [t4,0] (state.change.logger)
[2015-08-10 16:54:02,391] TRACE Controller 1 epoch 60 received response LeaderAndIsrResponse(6,Map((t2,1) -> 0, (t1,2) -> 0, (t3,1) -> 0, (t1,0) -> 0, (t4,0) -> 0),0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-10 16:54:02,393] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) for partition [t2,1] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 6 (state.change.logger)
[2015-08-10 16:54:02,393] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) for partition [t3,1] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 6 (state.change.logger)
[2015-08-10 16:54:02,393] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 6 (state.change.logger)
[2015-08-10 16:54:02,394] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 6 (state.change.logger)
[2015-08-10 16:54:02,394] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:51,ControllerEpoch:59),ReplicationFactor:1),AllReplicas:2) for partition [t1,2] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 6 (state.change.logger)
[2015-08-10 16:54:02,394] TRACE Controller 1 epoch 60 received response UpdateMetadataResponse(6,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-10 16:54:02,396] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60),ReplicationFactor:1),AllReplicas:2) correlation id 7 from controller 1 epoch 60 for partition [t2,1] (state.change.logger)
[2015-08-10 16:54:02,396] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60),ReplicationFactor:1),AllReplicas:2) correlation id 7 from controller 1 epoch 60 for partition [t3,1] (state.change.logger)
[2015-08-10 16:54:02,396] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60),ReplicationFactor:1),AllReplicas:2) correlation id 7 from controller 1 epoch 60 for partition [t1,0] (state.change.logger)
[2015-08-10 16:54:02,396] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60),ReplicationFactor:1),AllReplicas:2) correlation id 7 from controller 1 epoch 60 for partition [t4,0] (state.change.logger)
[2015-08-10 16:54:02,397] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60),ReplicationFactor:1),AllReplicas:2) correlation id 7 from controller 1 epoch 60 for partition [t1,2] (state.change.logger)
[2015-08-10 16:54:02,398] TRACE Broker 2 handling LeaderAndIsr request correlationId 7 from controller 1 epoch 60 starting the become-leader transition for partition [t1,2] (state.change.logger)
[2015-08-10 16:54:02,398] TRACE Broker 2 handling LeaderAndIsr request correlationId 7 from controller 1 epoch 60 starting the become-leader transition for partition [t3,1] (state.change.logger)
[2015-08-10 16:54:02,398] TRACE Broker 2 handling LeaderAndIsr request correlationId 7 from controller 1 epoch 60 starting the become-leader transition for partition [t2,1] (state.change.logger)
[2015-08-10 16:54:02,398] TRACE Broker 2 handling LeaderAndIsr request correlationId 7 from controller 1 epoch 60 starting the become-leader transition for partition [t1,0] (state.change.logger)
[2015-08-10 16:54:02,398] TRACE Broker 2 handling LeaderAndIsr request correlationId 7 from controller 1 epoch 60 starting the become-leader transition for partition [t4,0] (state.change.logger)
[2015-08-10 16:54:02,400] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 60 with correlation id 7 for partition [t1,2] (state.change.logger)
[2015-08-10 16:54:02,401] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 60 with correlation id 7 for partition [t3,1] (state.change.logger)
[2015-08-10 16:54:02,401] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 60 with correlation id 7 for partition [t2,1] (state.change.logger)
[2015-08-10 16:54:02,401] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 60 with correlation id 7 for partition [t1,0] (state.change.logger)
[2015-08-10 16:54:02,401] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 60 with correlation id 7 for partition [t4,0] (state.change.logger)
[2015-08-10 16:54:02,409] TRACE Broker 2 completed LeaderAndIsr request correlationId 7 from controller 1 epoch 60 for the become-leader transition for partition [t1,2] (state.change.logger)
[2015-08-10 16:54:02,409] TRACE Broker 2 completed LeaderAndIsr request correlationId 7 from controller 1 epoch 60 for the become-leader transition for partition [t3,1] (state.change.logger)
[2015-08-10 16:54:02,410] TRACE Broker 2 completed LeaderAndIsr request correlationId 7 from controller 1 epoch 60 for the become-leader transition for partition [t2,1] (state.change.logger)
[2015-08-10 16:54:02,410] TRACE Broker 2 completed LeaderAndIsr request correlationId 7 from controller 1 epoch 60 for the become-leader transition for partition [t1,0] (state.change.logger)
[2015-08-10 16:54:02,410] TRACE Broker 2 completed LeaderAndIsr request correlationId 7 from controller 1 epoch 60 for the become-leader transition for partition [t4,0] (state.change.logger)
[2015-08-10 16:54:02,412] TRACE Controller 1 epoch 60 received response LeaderAndIsrResponse(7,Map((t2,1) -> 0, (t1,2) -> 0, (t3,1) -> 0, (t1,0) -> 0, (t4,0) -> 0),0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
[2015-08-10 16:54:02,415] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60),ReplicationFactor:1),AllReplicas:2) for partition [t2,1] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 7 (state.change.logger)
[2015-08-10 16:54:02,415] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60),ReplicationFactor:1),AllReplicas:2) for partition [t3,1] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 7 (state.change.logger)
[2015-08-10 16:54:02,415] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60),ReplicationFactor:1),AllReplicas:2) for partition [t1,0] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 7 (state.change.logger)
[2015-08-10 16:54:02,416] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60),ReplicationFactor:1),AllReplicas:2) for partition [t4,0] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 7 (state.change.logger)
[2015-08-10 16:54:02,416] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:52,ControllerEpoch:60),ReplicationFactor:1),AllReplicas:2) for partition [t1,2] in response to UpdateMetadata request sent by controller 1 epoch 60 with correlation id 7 (state.change.logger)
[2015-08-10 16:54:02,417] TRACE Controller 1 epoch 60 received response UpdateMetadataResponse(7,0) for a request sent to broker id:2,host:fufuka,port:9093 (state.change.logger)
