[2015-08-12 11:10:39,064] INFO [Controller 2]: Broker 2 starting become controller state transition (kafka.controller.KafkaController)
[2015-08-12 11:10:39,069] INFO [Controller 2]: Initialized controller epoch to 7 and zk version 6 (kafka.controller.KafkaController)
[2015-08-12 11:10:39,072] INFO [Controller 2]: Controller 2 incremented epoch to 8 (kafka.controller.KafkaController)
[2015-08-12 11:10:39,145] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2015-08-12 11:10:39,153] INFO [Controller-2-to-broker-2-send-thread], Controller 2 connected to id:2,host:fufuka,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-12 11:10:39,156] INFO [Controller-2-to-broker-2-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-12 11:10:39,159] INFO [Controller 2]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-08-12 11:10:39,160] INFO [Controller 2]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-08-12 11:10:39,160] INFO [Controller 2]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-08-12 11:10:39,167] INFO [Controller 2]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-08-12 11:10:39,168] INFO [Controller 2]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-08-12 11:10:39,169] INFO [Controller 2]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-08-12 11:10:39,174] INFO [Controller 2]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-08-12 11:10:39,174] INFO [Controller 2]: List of topics ineligible for deletion: t2,t7,t6,t4 (kafka.controller.KafkaController)
[2015-08-12 11:10:39,177] INFO [Controller 2]: Currently active brokers in the cluster: Set(2) (kafka.controller.KafkaController)
[2015-08-12 11:10:39,178] INFO [Controller 2]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-12 11:10:39,178] INFO [Controller 2]: Current list of topics in the cluster: Set(t4, t3, t6, t2, t7, t1) (kafka.controller.KafkaController)
[2015-08-12 11:10:39,184] INFO [Replica state machine on controller 2]: Invoking state change to OnlineReplica for replicas [Topic=t1,Partition=0,Replica=2],[Topic=t3,Partition=0,Replica=2] (kafka.controller.ReplicaStateMachine)
[2015-08-12 11:10:39,198] INFO [Replica state machine on controller 2]: Started replica state machine with initial state -> Map([Topic=t2,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=t1,Partition=0,Replica=2] -> OnlineReplica, [Topic=t7,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=t4,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=t3,Partition=0,Replica=2] -> OnlineReplica, [Topic=t6,Partition=0,Replica=1] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-08-12 11:10:39,214] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:10:39,223] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t7,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:10:39,232] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t6,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:10:39,238] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t4,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:10:39,240] INFO [Partition state machine on Controller 2]: Started partition state machine with initial state -> Map([t1,0] -> OnlinePartition, [t2,0] -> OfflinePartition, [t7,0] -> OfflinePartition, [t3,0] -> OnlinePartition, [t6,0] -> OfflinePartition, [t4,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-08-12 11:10:39,246] INFO [Controller 2]: Broker 2 is ready to serve as the new controller with epoch 8 (kafka.controller.KafkaController)
[2015-08-12 11:10:39,247] INFO [Controller 2]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-08-12 11:10:39,248] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-12 11:10:39,253] INFO [Controller 2]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-08-12 11:10:39,256] INFO [delete-topics-thread-2], Starting  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-12 11:10:39,258] DEBUG [Topic Deletion Manager 2], Waiting for signal to start or continue topic deletion (kafka.controller.TopicDeletionManager)
[2015-08-12 11:10:39,671] INFO [Controller 2]: Shutting down broker 2 (kafka.controller.KafkaController)
[2015-08-12 11:10:39,672] DEBUG [Controller 2]: All shutting down brokers: 2 (kafka.controller.KafkaController)
[2015-08-12 11:10:39,672] DEBUG [Controller 2]: Live brokers:  (kafka.controller.KafkaController)
[2015-08-12 11:10:39,675] TRACE [Controller 2]: All leaders = [t1,0] -> (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7),[t7,0] -> (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7),[t2,0] -> (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7),[t3,0] -> (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7),[t6,0] -> (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7),[t4,0] -> (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7) (kafka.controller.KafkaController)
[2015-08-12 11:10:40,047] INFO [delete-topics-thread-2], Shutting down (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-12 11:10:40,047] INFO [delete-topics-thread-2], Stopped  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-12 11:10:40,047] INFO [delete-topics-thread-2], Shutdown completed (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-12 11:10:40,049] INFO [Partition state machine on Controller 2]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-08-12 11:10:40,049] INFO [Replica state machine on controller 2]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-08-12 11:10:40,050] INFO [Controller-2-to-broker-2-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-12 11:10:40,050] INFO [Controller-2-to-broker-2-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-12 11:10:40,050] INFO [Controller-2-to-broker-2-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-12 11:11:16,490] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-08-12 11:12:05,023] INFO [Controller 1]: Controller starting up (kafka.controller.KafkaController)
[2015-08-12 11:12:05,065] INFO [Controller 1]: Broker 1 starting become controller state transition (kafka.controller.KafkaController)
[2015-08-12 11:12:05,075] INFO [Controller 1]: Initialized controller epoch to 8 and zk version 7 (kafka.controller.KafkaController)
[2015-08-12 11:12:05,081] INFO [Controller 1]: Controller 1 incremented epoch to 9 (kafka.controller.KafkaController)
[2015-08-12 11:12:05,174] INFO [Controller 1]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-08-12 11:12:05,175] INFO [Controller 1]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-08-12 11:12:05,175] INFO [Controller 1]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-08-12 11:12:05,179] INFO [Controller 1]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-08-12 11:12:05,180] INFO [Controller 1]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-08-12 11:12:05,181] INFO [Controller 1]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-08-12 11:12:05,190] INFO [Controller 1]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-08-12 11:12:05,191] INFO [Controller 1]: List of topics ineligible for deletion: t4,t3,t6,t2,t7,t1 (kafka.controller.KafkaController)
[2015-08-12 11:12:05,194] INFO [Controller 1]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-12 11:12:05,195] INFO [Controller 1]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-12 11:12:05,195] INFO [Controller 1]: Current list of topics in the cluster: Set(t4, t3, t6, t2, t7, t1) (kafka.controller.KafkaController)
[2015-08-12 11:12:05,202] INFO [Replica state machine on controller 1]: Started replica state machine with initial state -> Map([Topic=t2,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=t1,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=t7,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=t4,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=t3,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=t6,Partition=0,Replica=1] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-08-12 11:12:05,223] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:12:05,241] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:12:05,255] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t7,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:12:05,271] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:12:05,281] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t6,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:12:05,294] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t4,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:12:05,301] INFO [Partition state machine on Controller 1]: Started partition state machine with initial state -> Map([t1,0] -> OfflinePartition, [t2,0] -> OfflinePartition, [t7,0] -> OfflinePartition, [t3,0] -> OfflinePartition, [t6,0] -> OfflinePartition, [t4,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-08-12 11:12:05,312] INFO [Controller 1]: Broker 1 is ready to serve as the new controller with epoch 9 (kafka.controller.KafkaController)
[2015-08-12 11:12:05,313] INFO [Controller 1]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-08-12 11:12:05,315] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-12 11:12:05,329] INFO [Controller 1]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-08-12 11:12:05,331] INFO [delete-topics-thread-1], Starting  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-12 11:12:05,332] DEBUG [Topic Deletion Manager 1], Waiting for signal to start or continue topic deletion (kafka.controller.TopicDeletionManager)
[2015-08-12 11:12:05,333] INFO [Controller 1]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-12 11:12:05,351] INFO [BrokerChangeListener on Controller 1]: Broker change listener fired for path /brokers/ids with children 1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-12 11:12:05,379] INFO [BrokerChangeListener on Controller 1]: Newly added brokers: 1, deleted brokers: , all live brokers: 1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-12 11:12:05,380] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2015-08-12 11:12:05,387] INFO [Controller-1-to-broker-1-send-thread], Controller 1 connected to id:1,host:fufuka,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-12 11:12:05,388] INFO [Controller-1-to-broker-1-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-12 11:12:05,389] INFO [Controller 1]: New broker startup callback for 1 (kafka.controller.KafkaController)
[2015-08-12 11:12:05,404] INFO [Replica state machine on controller 1]: Invoking state change to OnlineReplica for replicas [Topic=t2,Partition=0,Replica=1],[Topic=t7,Partition=0,Replica=1],[Topic=t6,Partition=0,Replica=1],[Topic=t4,Partition=0,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-08-12 11:12:05,430] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:12:05,438] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t2,0]. Select 1 from ISR 1 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:12:05,440] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":1,"leader_epoch":5,"isr":[1]} for offline partition [t2,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:12:05,452] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t1,0] -> (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7), [t2,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9), [t7,0] -> (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7), [t3,0] -> (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7), [t6,0] -> (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7), [t4,0] -> (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7)) (kafka.controller.PartitionStateMachine)
[2015-08-12 11:12:05,457] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t7,0]. Select 1 from ISR 1 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:12:05,457] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":1,"leader_epoch":5,"isr":[1]} for offline partition [t7,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:12:05,460] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t1,0] -> (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7), [t2,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9), [t7,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9), [t3,0] -> (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7), [t6,0] -> (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7), [t4,0] -> (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7)) (kafka.controller.PartitionStateMachine)
[2015-08-12 11:12:05,467] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:12:05,472] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t6,0]. Select 1 from ISR 1 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:12:05,472] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":1,"leader_epoch":5,"isr":[1]} for offline partition [t6,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:12:05,475] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t1,0] -> (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7), [t2,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9), [t7,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9), [t3,0] -> (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7), [t6,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9), [t4,0] -> (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:7)) (kafka.controller.PartitionStateMachine)
[2015-08-12 11:12:05,479] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t4,0]. Select 1 from ISR 1 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:12:05,479] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":1,"leader_epoch":5,"isr":[1]} for offline partition [t4,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:12:05,482] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t1,0] -> (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7), [t2,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9), [t7,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9), [t3,0] -> (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7), [t6,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9), [t4,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9)) (kafka.controller.PartitionStateMachine)
[2015-08-12 11:12:10,333] TRACE [Controller 1]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-12 11:12:10,338] DEBUG [Controller 1]: preferred replicas by broker Map(2 -> Map([t1,0] -> List(2), [t3,0] -> List(2)), 1 -> Map([t2,0] -> List(1), [t7,0] -> List(1), [t6,0] -> List(1), [t4,0] -> List(1))) (kafka.controller.KafkaController)
[2015-08-12 11:12:10,341] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-12 11:12:10,343] TRACE [Controller 1]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-12 11:12:10,343] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-12 11:12:10,343] TRACE [Controller 1]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-12 11:12:25,794] INFO [Controller 2]: Controller starting up (kafka.controller.KafkaController)
[2015-08-12 11:12:25,807] INFO [Controller 2]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-12 11:12:25,819] INFO [BrokerChangeListener on Controller 1]: Broker change listener fired for path /brokers/ids with children 1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-12 11:12:25,831] INFO [BrokerChangeListener on Controller 1]: Newly added brokers: 2, deleted brokers: , all live brokers: 1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-12 11:12:25,831] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2015-08-12 11:12:25,833] INFO [Controller-1-to-broker-2-send-thread], Controller 1 connected to id:2,host:fufuka,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-12 11:12:25,836] INFO [Controller 1]: New broker startup callback for 2 (kafka.controller.KafkaController)
[2015-08-12 11:12:25,837] INFO [Controller-1-to-broker-2-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-12 11:12:25,838] INFO [Replica state machine on controller 1]: Invoking state change to OnlineReplica for replicas [Topic=t1,Partition=0,Replica=2],[Topic=t3,Partition=0,Replica=2] (kafka.controller.ReplicaStateMachine)
[2015-08-12 11:12:25,849] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t1,0]. Select 2 from ISR 2 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:12:25,849] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":5,"isr":[2]} for offline partition [t1,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:12:25,852] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t1,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9), [t2,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9), [t7,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9), [t3,0] -> (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:7), [t6,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9), [t4,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9)) (kafka.controller.PartitionStateMachine)
[2015-08-12 11:12:25,856] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t3,0]. Select 2 from ISR 2 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:12:25,856] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":5,"isr":[2]} for offline partition [t3,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:12:25,861] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t1,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9), [t2,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9), [t7,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9), [t3,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9), [t6,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9), [t4,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9)) (kafka.controller.PartitionStateMachine)
[2015-08-12 11:15:14,845] INFO [Controller 1]: Shutting down broker 1 (kafka.controller.KafkaController)
[2015-08-12 11:15:14,846] DEBUG [Controller 1]: All shutting down brokers: 1 (kafka.controller.KafkaController)
[2015-08-12 11:15:14,847] DEBUG [Controller 1]: Live brokers: 2 (kafka.controller.KafkaController)
[2015-08-12 11:15:14,851] TRACE [Controller 1]: All leaders = [t1,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),[t7,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),[t2,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),[t3,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),[t6,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),[t4,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) (kafka.controller.KafkaController)
[2015-08-12 11:15:15,186] INFO [delete-topics-thread-1], Shutting down (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-12 11:15:15,187] INFO [delete-topics-thread-1], Stopped  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-12 11:15:15,187] INFO [delete-topics-thread-1], Shutdown completed (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-12 11:15:15,189] INFO [Partition state machine on Controller 1]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-08-12 11:15:15,189] INFO [Replica state machine on controller 1]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-08-12 11:15:15,190] INFO [Controller-1-to-broker-2-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-12 11:15:15,190] INFO [Controller-1-to-broker-2-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-12 11:15:15,190] INFO [Controller-1-to-broker-2-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-12 11:15:15,190] INFO [Controller-1-to-broker-1-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-12 11:15:15,190] INFO [Controller-1-to-broker-1-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-12 11:15:15,190] INFO [Controller-1-to-broker-1-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-12 11:15:15,207] INFO [Controller 2]: Broker 2 starting become controller state transition (kafka.controller.KafkaController)
[2015-08-12 11:15:15,209] INFO [Controller 2]: Initialized controller epoch to 9 and zk version 8 (kafka.controller.KafkaController)
[2015-08-12 11:15:15,211] INFO [Controller 2]: Controller 2 incremented epoch to 10 (kafka.controller.KafkaController)
[2015-08-12 11:15:15,303] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2015-08-12 11:15:15,316] INFO [Controller-2-to-broker-2-send-thread], Controller 2 connected to id:2,host:fufuka,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-12 11:15:15,320] INFO [Controller-2-to-broker-2-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-12 11:15:15,321] INFO [Controller 2]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-08-12 11:15:15,322] INFO [Controller 2]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-08-12 11:15:15,323] INFO [Controller 2]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-08-12 11:15:15,330] INFO [Controller 2]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-08-12 11:15:15,331] INFO [Controller 2]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-08-12 11:15:15,333] INFO [Controller 2]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-08-12 11:15:15,337] INFO [Controller 2]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-08-12 11:15:15,338] INFO [Controller 2]: List of topics ineligible for deletion: t2,t7,t6,t4 (kafka.controller.KafkaController)
[2015-08-12 11:15:15,340] INFO [Controller 2]: Currently active brokers in the cluster: Set(2) (kafka.controller.KafkaController)
[2015-08-12 11:15:15,341] INFO [Controller 2]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-12 11:15:15,341] INFO [Controller 2]: Current list of topics in the cluster: Set(t4, t3, t6, t2, t7, t1) (kafka.controller.KafkaController)
[2015-08-12 11:15:15,348] INFO [Replica state machine on controller 2]: Invoking state change to OnlineReplica for replicas [Topic=t1,Partition=0,Replica=2],[Topic=t3,Partition=0,Replica=2] (kafka.controller.ReplicaStateMachine)
[2015-08-12 11:15:15,361] INFO [Replica state machine on controller 2]: Started replica state machine with initial state -> Map([Topic=t2,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=t1,Partition=0,Replica=2] -> OnlineReplica, [Topic=t7,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=t4,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=t3,Partition=0,Replica=2] -> OnlineReplica, [Topic=t6,Partition=0,Replica=1] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-08-12 11:15:15,378] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:15:15,389] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t7,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:15:15,397] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t6,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:15:15,413] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t4,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:15:15,414] INFO [Partition state machine on Controller 2]: Started partition state machine with initial state -> Map([t1,0] -> OnlinePartition, [t2,0] -> OfflinePartition, [t7,0] -> OfflinePartition, [t3,0] -> OnlinePartition, [t6,0] -> OfflinePartition, [t4,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-08-12 11:15:15,420] INFO [Controller 2]: Broker 2 is ready to serve as the new controller with epoch 10 (kafka.controller.KafkaController)
[2015-08-12 11:15:15,423] INFO [Controller 2]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-08-12 11:15:15,424] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-12 11:15:15,432] INFO [Controller 2]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-08-12 11:15:15,439] INFO [delete-topics-thread-2], Starting  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-12 11:15:15,441] DEBUG [Topic Deletion Manager 2], Waiting for signal to start or continue topic deletion (kafka.controller.TopicDeletionManager)
[2015-08-12 11:15:15,783] INFO [Controller 2]: Shutting down broker 2 (kafka.controller.KafkaController)
[2015-08-12 11:15:15,784] DEBUG [Controller 2]: All shutting down brokers: 2 (kafka.controller.KafkaController)
[2015-08-12 11:15:15,784] DEBUG [Controller 2]: Live brokers:  (kafka.controller.KafkaController)
[2015-08-12 11:15:15,788] TRACE [Controller 2]: All leaders = [t1,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),[t7,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),[t2,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),[t3,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),[t6,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),[t4,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9) (kafka.controller.KafkaController)
[2015-08-12 11:15:16,067] INFO [delete-topics-thread-2], Shutting down (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-12 11:15:16,067] INFO [delete-topics-thread-2], Stopped  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-12 11:15:16,067] INFO [delete-topics-thread-2], Shutdown completed (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-12 11:15:16,069] INFO [Partition state machine on Controller 2]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-08-12 11:15:16,069] INFO [Replica state machine on controller 2]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-08-12 11:15:16,070] INFO [Controller-2-to-broker-2-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-12 11:15:16,070] INFO [Controller-2-to-broker-2-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-12 11:15:16,070] INFO [Controller-2-to-broker-2-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-12 11:15:18,891] INFO [Controller 1]: Controller starting up (kafka.controller.KafkaController)
[2015-08-12 11:15:18,907] INFO [Controller 1]: Broker 1 starting become controller state transition (kafka.controller.KafkaController)
[2015-08-12 11:15:18,913] INFO [Controller 1]: Initialized controller epoch to 10 and zk version 9 (kafka.controller.KafkaController)
[2015-08-12 11:15:18,916] INFO [Controller 1]: Controller 1 incremented epoch to 11 (kafka.controller.KafkaController)
[2015-08-12 11:15:19,061] INFO [Controller 1]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-08-12 11:15:19,061] INFO [Controller 1]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-08-12 11:15:19,062] INFO [Controller 1]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-08-12 11:15:19,067] INFO [Controller 1]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-08-12 11:15:19,068] INFO [Controller 1]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-08-12 11:15:19,070] INFO [Controller 1]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-08-12 11:15:19,076] INFO [Controller 1]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-08-12 11:15:19,077] INFO [Controller 1]: List of topics ineligible for deletion: t4,t3,t6,t2,t7,t1 (kafka.controller.KafkaController)
[2015-08-12 11:15:19,081] INFO [Controller 1]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-12 11:15:19,082] INFO [Controller 1]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-12 11:15:19,083] INFO [Controller 1]: Current list of topics in the cluster: Set(t4, t3, t6, t2, t7, t1) (kafka.controller.KafkaController)
[2015-08-12 11:15:19,090] INFO [Replica state machine on controller 1]: Started replica state machine with initial state -> Map([Topic=t2,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=t1,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=t7,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=t4,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=t3,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=t6,Partition=0,Replica=1] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-08-12 11:15:19,134] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:15:19,151] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:15:19,162] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t7,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:15:19,172] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:15:19,183] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t6,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:15:19,193] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t4,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:15:19,199] INFO [Partition state machine on Controller 1]: Started partition state machine with initial state -> Map([t1,0] -> OfflinePartition, [t2,0] -> OfflinePartition, [t7,0] -> OfflinePartition, [t3,0] -> OfflinePartition, [t6,0] -> OfflinePartition, [t4,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-08-12 11:15:19,207] INFO [Controller 1]: Broker 1 is ready to serve as the new controller with epoch 11 (kafka.controller.KafkaController)
[2015-08-12 11:15:19,209] INFO [Controller 1]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-08-12 11:15:19,210] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-12 11:15:19,217] INFO [Controller 1]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-08-12 11:15:19,219] INFO [delete-topics-thread-1], Starting  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-12 11:15:19,220] DEBUG [Topic Deletion Manager 1], Waiting for signal to start or continue topic deletion (kafka.controller.TopicDeletionManager)
[2015-08-12 11:15:19,220] INFO [Controller 1]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-12 11:15:19,234] INFO [BrokerChangeListener on Controller 1]: Broker change listener fired for path /brokers/ids with children 1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-12 11:15:19,257] INFO [BrokerChangeListener on Controller 1]: Newly added brokers: 1, deleted brokers: , all live brokers: 1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-12 11:15:19,258] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2015-08-12 11:15:19,264] INFO [Controller-1-to-broker-1-send-thread], Controller 1 connected to id:1,host:fufuka,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-12 11:15:19,265] INFO [Controller-1-to-broker-1-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-12 11:15:19,266] INFO [Controller 1]: New broker startup callback for 1 (kafka.controller.KafkaController)
[2015-08-12 11:15:19,274] INFO [Replica state machine on controller 1]: Invoking state change to OnlineReplica for replicas [Topic=t2,Partition=0,Replica=1],[Topic=t7,Partition=0,Replica=1],[Topic=t6,Partition=0,Replica=1],[Topic=t4,Partition=0,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-08-12 11:15:19,275] WARN [Controller-1-to-broker-1-send-thread], Controller 1 epoch 11 fails to send request Name:UpdateMetadataRequest;Version:0;Controller:1;ControllerEpoch:11;CorrelationId:3;ClientId:id_1-host_null-port_9092;AliveBrokers:id:1,host:fufuka,port:9092;PartitionState:[t3,0] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2),[t7,0] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:1),[t1,0] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2),[t4,0] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:1),[t6,0] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:1),[t2,0] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:1) to broker id:1,host:fufuka,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.nio.channels.ClosedChannelException
	at kafka.network.BlockingChannel.send(BlockingChannel.scala:100)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:132)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-12 11:15:19,276] INFO [Controller-1-to-broker-1-send-thread], Controller 1 connected to id:1,host:fufuka,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-12 11:15:19,299] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:15:19,331] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t2,0]. Select 1 from ISR 1 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:15:19,333] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":1,"leader_epoch":6,"isr":[1]} for offline partition [t2,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:15:19,342] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t1,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9), [t2,0] -> (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11), [t7,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9), [t3,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9), [t6,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9), [t4,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9)) (kafka.controller.PartitionStateMachine)
[2015-08-12 11:15:19,349] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t7,0]. Select 1 from ISR 1 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:15:19,349] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":1,"leader_epoch":6,"isr":[1]} for offline partition [t7,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:15:19,351] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t1,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9), [t2,0] -> (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11), [t7,0] -> (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11), [t3,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9), [t6,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9), [t4,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9)) (kafka.controller.PartitionStateMachine)
[2015-08-12 11:15:19,363] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:15:19,367] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t6,0]. Select 1 from ISR 1 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:15:19,367] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":1,"leader_epoch":6,"isr":[1]} for offline partition [t6,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:15:19,370] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t1,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9), [t2,0] -> (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11), [t7,0] -> (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11), [t3,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9), [t6,0] -> (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11), [t4,0] -> (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:9)) (kafka.controller.PartitionStateMachine)
[2015-08-12 11:15:19,374] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t4,0]. Select 1 from ISR 1 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:15:19,374] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":1,"leader_epoch":6,"isr":[1]} for offline partition [t4,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:15:19,377] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t1,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9), [t2,0] -> (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11), [t7,0] -> (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11), [t3,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9), [t6,0] -> (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11), [t4,0] -> (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11)) (kafka.controller.PartitionStateMachine)
[2015-08-12 11:15:19,383] INFO [delete-topics-thread-1], Shutting down (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-12 11:15:19,383] INFO [delete-topics-thread-1], Stopped  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-12 11:15:19,384] INFO [delete-topics-thread-1], Shutdown completed (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-12 11:15:19,386] INFO [Partition state machine on Controller 1]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-08-12 11:15:19,386] INFO [Replica state machine on controller 1]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-08-12 11:15:19,386] INFO [Controller-1-to-broker-1-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-12 11:15:19,388] ERROR [Controller-1-to-broker-1-send-thread], Controller 1 fails to send a request to broker id:1,host:fufuka,port:9092 (kafka.controller.RequestSendThread)
java.lang.NullPointerException
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:154)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-12 11:15:19,388] INFO [Controller-1-to-broker-1-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-12 11:15:19,388] INFO [Controller-1-to-broker-1-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-12 11:16:36,960] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-08-12 11:16:52,344] INFO [Controller 1]: Controller starting up (kafka.controller.KafkaController)
[2015-08-12 11:16:52,387] INFO [Controller 1]: Broker 1 starting become controller state transition (kafka.controller.KafkaController)
[2015-08-12 11:16:52,394] INFO [Controller 1]: Initialized controller epoch to 11 and zk version 10 (kafka.controller.KafkaController)
[2015-08-12 11:16:52,400] INFO [Controller 1]: Controller 1 incremented epoch to 12 (kafka.controller.KafkaController)
[2015-08-12 11:16:52,492] INFO [Controller 1]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-08-12 11:16:52,493] INFO [Controller 1]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-08-12 11:16:52,493] INFO [Controller 1]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-08-12 11:16:52,498] INFO [Controller 1]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-08-12 11:16:52,498] INFO [Controller 1]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-08-12 11:16:52,500] INFO [Controller 1]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-08-12 11:16:52,506] INFO [Controller 1]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-08-12 11:16:52,507] INFO [Controller 1]: List of topics ineligible for deletion: t4,t3,t6,t2,t7,t1 (kafka.controller.KafkaController)
[2015-08-12 11:16:52,510] INFO [Controller 1]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-12 11:16:52,510] INFO [Controller 1]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-12 11:16:52,511] INFO [Controller 1]: Current list of topics in the cluster: Set(t4, t3, t6, t2, t7, t1) (kafka.controller.KafkaController)
[2015-08-12 11:16:52,527] INFO [Replica state machine on controller 1]: Started replica state machine with initial state -> Map([Topic=t2,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=t1,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=t7,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=t4,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=t3,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=t6,Partition=0,Replica=1] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-08-12 11:16:52,542] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:16:52,555] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:16:52,565] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t7,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:16:52,575] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:16:52,589] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t6,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:16:52,598] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t4,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:16:52,603] INFO [Partition state machine on Controller 1]: Started partition state machine with initial state -> Map([t1,0] -> OfflinePartition, [t2,0] -> OfflinePartition, [t7,0] -> OfflinePartition, [t3,0] -> OfflinePartition, [t6,0] -> OfflinePartition, [t4,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-08-12 11:16:52,609] INFO [Controller 1]: Broker 1 is ready to serve as the new controller with epoch 12 (kafka.controller.KafkaController)
[2015-08-12 11:16:52,611] INFO [Controller 1]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-08-12 11:16:52,612] INFO [Partition state machine on Controller 1]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-12 11:16:52,630] INFO [Controller 1]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-08-12 11:16:52,632] INFO [delete-topics-thread-1], Starting  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-12 11:16:52,633] DEBUG [Topic Deletion Manager 1], Waiting for signal to start or continue topic deletion (kafka.controller.TopicDeletionManager)
[2015-08-12 11:16:52,633] INFO [Controller 1]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-12 11:16:52,648] INFO [BrokerChangeListener on Controller 1]: Broker change listener fired for path /brokers/ids with children 1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-12 11:16:52,673] INFO [BrokerChangeListener on Controller 1]: Newly added brokers: 1, deleted brokers: , all live brokers: 1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-12 11:16:52,674] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2015-08-12 11:16:52,679] INFO [Controller-1-to-broker-1-send-thread], Controller 1 connected to id:1,host:fufuka,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-12 11:16:52,680] INFO [Controller-1-to-broker-1-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-12 11:16:52,681] INFO [Controller 1]: New broker startup callback for 1 (kafka.controller.KafkaController)
[2015-08-12 11:16:52,690] INFO [Replica state machine on controller 1]: Invoking state change to OnlineReplica for replicas [Topic=t2,Partition=0,Replica=1],[Topic=t7,Partition=0,Replica=1],[Topic=t6,Partition=0,Replica=1],[Topic=t4,Partition=0,Replica=1] (kafka.controller.ReplicaStateMachine)
[2015-08-12 11:16:52,713] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t1,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:16:52,719] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t2,0]. Select 1 from ISR 1 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:16:52,720] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":1,"leader_epoch":7,"isr":[1]} for offline partition [t2,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:16:52,729] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t1,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9), [t2,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12), [t7,0] -> (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11), [t3,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9), [t6,0] -> (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11), [t4,0] -> (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11)) (kafka.controller.PartitionStateMachine)
[2015-08-12 11:16:52,736] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t7,0]. Select 1 from ISR 1 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:16:52,736] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":1,"leader_epoch":7,"isr":[1]} for offline partition [t7,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:16:52,738] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t1,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9), [t2,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12), [t7,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12), [t3,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9), [t6,0] -> (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11), [t4,0] -> (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11)) (kafka.controller.PartitionStateMachine)
[2015-08-12 11:16:52,746] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t3,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:16:52,752] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t6,0]. Select 1 from ISR 1 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:16:52,752] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":1,"leader_epoch":7,"isr":[1]} for offline partition [t6,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:16:52,756] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t1,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9), [t2,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12), [t7,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12), [t3,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9), [t6,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12), [t4,0] -> (Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:11)) (kafka.controller.PartitionStateMachine)
[2015-08-12 11:16:52,761] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t4,0]. Select 1 from ISR 1 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:16:52,761] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":1,"leader_epoch":7,"isr":[1]} for offline partition [t4,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:16:52,766] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t1,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9), [t2,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12), [t7,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12), [t3,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9), [t6,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12), [t4,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12)) (kafka.controller.PartitionStateMachine)
[2015-08-12 11:16:57,275] INFO [Controller 2]: Controller starting up (kafka.controller.KafkaController)
[2015-08-12 11:16:57,296] INFO [Controller 2]: Controller startup complete (kafka.controller.KafkaController)
[2015-08-12 11:16:57,312] INFO [BrokerChangeListener on Controller 1]: Broker change listener fired for path /brokers/ids with children 1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-12 11:16:57,329] INFO [BrokerChangeListener on Controller 1]: Newly added brokers: 2, deleted brokers: , all live brokers: 1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-12 11:16:57,329] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2015-08-12 11:16:57,330] INFO [Controller-1-to-broker-2-send-thread], Controller 1 connected to id:2,host:fufuka,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-12 11:16:57,330] INFO [Controller 1]: New broker startup callback for 2 (kafka.controller.KafkaController)
[2015-08-12 11:16:57,331] INFO [Controller-1-to-broker-2-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-12 11:16:57,333] INFO [Replica state machine on controller 1]: Invoking state change to OnlineReplica for replicas [Topic=t1,Partition=0,Replica=2],[Topic=t3,Partition=0,Replica=2] (kafka.controller.ReplicaStateMachine)
[2015-08-12 11:16:57,347] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t1,0]. Select 2 from ISR 2 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:16:57,347] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":6,"isr":[2]} for offline partition [t1,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:16:57,350] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t1,0] -> (Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12), [t2,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12), [t7,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12), [t3,0] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:9), [t6,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12), [t4,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12)) (kafka.controller.PartitionStateMachine)
[2015-08-12 11:16:57,354] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [t3,0]. Select 2 from ISR 2 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:16:57,354] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":6,"isr":[2]} for offline partition [t3,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:16:57,368] DEBUG [Partition state machine on Controller 1]: After leader election, leader cache is updated to Map([t1,0] -> (Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12), [t2,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12), [t7,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12), [t3,0] -> (Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12), [t6,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12), [t4,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12)) (kafka.controller.PartitionStateMachine)
[2015-08-12 11:16:57,633] TRACE [Controller 1]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-12 11:16:57,637] DEBUG [Controller 1]: preferred replicas by broker Map(2 -> Map([t1,0] -> List(2), [t3,0] -> List(2)), 1 -> Map([t2,0] -> List(1), [t7,0] -> List(1), [t6,0] -> List(1), [t4,0] -> List(1))) (kafka.controller.KafkaController)
[2015-08-12 11:16:57,639] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-12 11:16:57,641] TRACE [Controller 1]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-12 11:16:57,641] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-12 11:16:57,641] TRACE [Controller 1]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-12 11:21:57,629] TRACE [Controller 1]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-12 11:21:57,631] DEBUG [Controller 1]: preferred replicas by broker Map(2 -> Map([t1,0] -> List(2), [t3,0] -> List(2)), 1 -> Map([t2,0] -> List(1), [t7,0] -> List(1), [t6,0] -> List(1), [t4,0] -> List(1))) (kafka.controller.KafkaController)
[2015-08-12 11:21:57,631] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-12 11:21:57,631] TRACE [Controller 1]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-12 11:21:57,631] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-12 11:21:57,631] TRACE [Controller 1]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-12 11:26:57,619] TRACE [Controller 1]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-12 11:26:57,620] DEBUG [Controller 1]: preferred replicas by broker Map(2 -> Map([t1,0] -> List(2), [t3,0] -> List(2)), 1 -> Map([t2,0] -> List(1), [t7,0] -> List(1), [t6,0] -> List(1), [t4,0] -> List(1))) (kafka.controller.KafkaController)
[2015-08-12 11:26:57,620] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-12 11:26:57,620] TRACE [Controller 1]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-12 11:26:57,621] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-12 11:26:57,621] TRACE [Controller 1]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-12 11:31:57,618] TRACE [Controller 1]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-12 11:31:57,619] DEBUG [Controller 1]: preferred replicas by broker Map(2 -> Map([t1,0] -> List(2), [t3,0] -> List(2)), 1 -> Map([t2,0] -> List(1), [t7,0] -> List(1), [t6,0] -> List(1), [t4,0] -> List(1))) (kafka.controller.KafkaController)
[2015-08-12 11:31:57,619] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-12 11:31:57,619] TRACE [Controller 1]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-12 11:31:57,619] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-12 11:31:57,619] TRACE [Controller 1]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-12 11:36:57,612] TRACE [Controller 1]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-12 11:36:57,612] DEBUG [Controller 1]: preferred replicas by broker Map(2 -> Map([t1,0] -> List(2), [t3,0] -> List(2)), 1 -> Map([t2,0] -> List(1), [t7,0] -> List(1), [t6,0] -> List(1), [t4,0] -> List(1))) (kafka.controller.KafkaController)
[2015-08-12 11:36:57,613] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-12 11:36:57,613] TRACE [Controller 1]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-12 11:36:57,613] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-12 11:36:57,613] TRACE [Controller 1]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-12 11:41:57,604] TRACE [Controller 1]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-12 11:41:57,604] DEBUG [Controller 1]: preferred replicas by broker Map(2 -> Map([t1,0] -> List(2), [t3,0] -> List(2)), 1 -> Map([t2,0] -> List(1), [t7,0] -> List(1), [t6,0] -> List(1), [t4,0] -> List(1))) (kafka.controller.KafkaController)
[2015-08-12 11:41:57,604] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-12 11:41:57,604] TRACE [Controller 1]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-12 11:41:57,604] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-12 11:41:57,604] TRACE [Controller 1]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-12 11:46:57,596] TRACE [Controller 1]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-12 11:46:57,596] DEBUG [Controller 1]: preferred replicas by broker Map(2 -> Map([t1,0] -> List(2), [t3,0] -> List(2)), 1 -> Map([t2,0] -> List(1), [t7,0] -> List(1), [t6,0] -> List(1), [t4,0] -> List(1))) (kafka.controller.KafkaController)
[2015-08-12 11:46:57,596] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-12 11:46:57,596] TRACE [Controller 1]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-12 11:46:57,596] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-12 11:46:57,596] TRACE [Controller 1]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-12 11:51:57,594] TRACE [Controller 1]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-12 11:51:57,594] DEBUG [Controller 1]: preferred replicas by broker Map(2 -> Map([t1,0] -> List(2), [t3,0] -> List(2)), 1 -> Map([t2,0] -> List(1), [t7,0] -> List(1), [t6,0] -> List(1), [t4,0] -> List(1))) (kafka.controller.KafkaController)
[2015-08-12 11:51:57,594] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-12 11:51:57,595] TRACE [Controller 1]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-12 11:51:57,595] DEBUG [Controller 1]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-12 11:51:57,595] TRACE [Controller 1]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2015-08-12 11:54:30,019] INFO [Controller 1]: Shutting down broker 1 (kafka.controller.KafkaController)
[2015-08-12 11:54:30,020] DEBUG [Controller 1]: All shutting down brokers: 1 (kafka.controller.KafkaController)
[2015-08-12 11:54:30,021] DEBUG [Controller 1]: Live brokers: 2 (kafka.controller.KafkaController)
[2015-08-12 11:54:30,025] TRACE [Controller 1]: All leaders = [t1,0] -> (Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12),[t7,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12),[t2,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12),[t3,0] -> (Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12),[t6,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12),[t4,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12) (kafka.controller.KafkaController)
[2015-08-12 11:54:30,322] INFO [delete-topics-thread-1], Shutting down (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-12 11:54:30,323] INFO [delete-topics-thread-1], Stopped  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-12 11:54:30,323] INFO [delete-topics-thread-1], Shutdown completed (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-12 11:54:30,326] INFO [Partition state machine on Controller 1]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-08-12 11:54:30,326] INFO [Replica state machine on controller 1]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-08-12 11:54:30,327] INFO [Controller-1-to-broker-2-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-12 11:54:30,327] INFO [Controller-1-to-broker-2-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-12 11:54:30,327] INFO [Controller-1-to-broker-2-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-12 11:54:30,327] INFO [Controller-1-to-broker-1-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-12 11:54:30,328] INFO [Controller-1-to-broker-1-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-12 11:54:30,328] INFO [Controller-1-to-broker-1-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-12 11:54:30,346] INFO [Controller 2]: Broker 2 starting become controller state transition (kafka.controller.KafkaController)
[2015-08-12 11:54:30,348] INFO [Controller 2]: Initialized controller epoch to 12 and zk version 11 (kafka.controller.KafkaController)
[2015-08-12 11:54:30,351] INFO [Controller 2]: Controller 2 incremented epoch to 13 (kafka.controller.KafkaController)
[2015-08-12 11:54:30,431] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2015-08-12 11:54:30,440] INFO [Controller-2-to-broker-2-send-thread], Controller 2 connected to id:2,host:fufuka,port:9093 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-12 11:54:30,441] INFO [Controller-2-to-broker-2-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-08-12 11:54:30,442] INFO [Controller 2]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-08-12 11:54:30,443] INFO [Controller 2]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-08-12 11:54:30,443] INFO [Controller 2]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-08-12 11:54:30,446] INFO [Controller 2]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-08-12 11:54:30,447] INFO [Controller 2]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-08-12 11:54:30,449] INFO [Controller 2]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-08-12 11:54:30,453] INFO [Controller 2]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-08-12 11:54:30,453] INFO [Controller 2]: List of topics ineligible for deletion: t2,t7,t6,t4 (kafka.controller.KafkaController)
[2015-08-12 11:54:30,456] INFO [Controller 2]: Currently active brokers in the cluster: Set(2) (kafka.controller.KafkaController)
[2015-08-12 11:54:30,457] INFO [Controller 2]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-08-12 11:54:30,458] INFO [Controller 2]: Current list of topics in the cluster: Set(t4, t3, t6, t2, t7, t1) (kafka.controller.KafkaController)
[2015-08-12 11:54:30,463] INFO [Replica state machine on controller 2]: Invoking state change to OnlineReplica for replicas [Topic=t1,Partition=0,Replica=2],[Topic=t3,Partition=0,Replica=2] (kafka.controller.ReplicaStateMachine)
[2015-08-12 11:54:30,493] INFO [Replica state machine on controller 2]: Started replica state machine with initial state -> Map([Topic=t2,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=t1,Partition=0,Replica=2] -> OnlineReplica, [Topic=t7,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=t4,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=t3,Partition=0,Replica=2] -> OnlineReplica, [Topic=t6,Partition=0,Replica=1] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-08-12 11:54:30,505] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t2,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:54:30,513] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t7,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:54:30,520] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t6,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:54:30,527] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [t4,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-08-12 11:54:30,528] INFO [Partition state machine on Controller 2]: Started partition state machine with initial state -> Map([t1,0] -> OnlinePartition, [t2,0] -> OfflinePartition, [t7,0] -> OfflinePartition, [t3,0] -> OnlinePartition, [t6,0] -> OfflinePartition, [t4,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-08-12 11:54:30,532] INFO [Controller 2]: Broker 2 is ready to serve as the new controller with epoch 13 (kafka.controller.KafkaController)
[2015-08-12 11:54:30,537] INFO [Controller 2]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-08-12 11:54:30,538] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-08-12 11:54:30,542] INFO [Controller 2]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-08-12 11:54:30,544] INFO [delete-topics-thread-2], Starting  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-12 11:54:30,545] DEBUG [Topic Deletion Manager 2], Waiting for signal to start or continue topic deletion (kafka.controller.TopicDeletionManager)
[2015-08-12 11:54:32,341] INFO [Controller 2]: Shutting down broker 2 (kafka.controller.KafkaController)
[2015-08-12 11:54:32,342] DEBUG [Controller 2]: All shutting down brokers: 2 (kafka.controller.KafkaController)
[2015-08-12 11:54:32,342] DEBUG [Controller 2]: Live brokers:  (kafka.controller.KafkaController)
[2015-08-12 11:54:32,346] TRACE [Controller 2]: All leaders = [t1,0] -> (Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12),[t7,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12),[t2,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12),[t3,0] -> (Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:12),[t6,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12),[t4,0] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:12) (kafka.controller.KafkaController)
[2015-08-12 11:54:32,609] INFO [delete-topics-thread-2], Shutting down (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-12 11:54:32,610] INFO [delete-topics-thread-2], Stopped  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-12 11:54:32,610] INFO [delete-topics-thread-2], Shutdown completed (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-12 11:54:32,611] INFO [Partition state machine on Controller 2]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-08-12 11:54:32,612] INFO [Replica state machine on controller 2]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-08-12 11:54:32,612] INFO [Controller-2-to-broker-2-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-12 11:54:32,612] INFO [Controller-2-to-broker-2-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-12 11:54:32,612] INFO [Controller-2-to-broker-2-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-12 11:54:39,039] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
