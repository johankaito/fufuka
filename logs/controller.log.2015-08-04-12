[2015-08-04 13:00:11,886] TRACE [Controller 2]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-08-04 13:00:11,887] DEBUG [Controller 2]: preferred replicas by broker Map(2 -> Map([t2,1] -> List(2), [t1,2] -> List(2), [t1,0] -> List(2), [t3,1] -> List(2), [t4,0] -> List(2)), 0 -> Map([t7,0] -> List(0), [t2,0] -> List(0), [t2,2] -> List(0), [t1,1] -> List(0), [t3,2] -> List(0), [t3,0] -> List(0), [t6,0] -> List(0))) (kafka.controller.KafkaController)
[2015-08-04 13:00:11,887] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-04 13:00:11,887] TRACE [Controller 2]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2015-08-04 13:00:11,887] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-08-04 13:00:11,888] TRACE [Controller 2]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-08-04 13:00:20,776] INFO [Controller-2-to-broker-0-send-thread], Controller 2 connected to id:0,host:fufuka,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-04 13:00:21,087] WARN [Controller-2-to-broker-0-send-thread], Controller 2 epoch 11 fails to send request Name:UpdateMetadataRequest;Version:0;Controller:2;ControllerEpoch:11;CorrelationId:10;ClientId:id_2-host_null-port_9093;AliveBrokers:id:0,host:fufuka,port:9092,id:2,host:jketos-macbook-pro.local,port:9093;PartitionState:[t1,1] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:10),ReplicationFactor:1),AllReplicas:0),[t3,0] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:10),ReplicationFactor:1),AllReplicas:0),[t2,1] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2),[t3,1] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2),[t3,2] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:10),ReplicationFactor:1),AllReplicas:0),[t7,0] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:10),ReplicationFactor:1),AllReplicas:0),[t1,0] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2),[t4,0] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2),[t6,0] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:10),ReplicationFactor:1),AllReplicas:0),[t1,2] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2),[t2,0] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:10),ReplicationFactor:1),AllReplicas:0),[t2,2] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:10),ReplicationFactor:1),AllReplicas:0) to broker id:0,host:fufuka,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.nio.channels.ClosedChannelException
	at kafka.network.BlockingChannel.send(BlockingChannel.scala:100)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:132)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-04 13:01:43,274] INFO [Controller-2-to-broker-0-send-thread], Controller 2 connected to id:0,host:fufuka,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-04 13:44:54,302] WARN [Controller-2-to-broker-0-send-thread], Controller 2 epoch 11 fails to send request Name:UpdateMetadataRequest;Version:0;Controller:2;ControllerEpoch:11;CorrelationId:10;ClientId:id_2-host_null-port_9093;AliveBrokers:id:0,host:fufuka,port:9092,id:2,host:jketos-macbook-pro.local,port:9093;PartitionState:[t1,1] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:10),ReplicationFactor:1),AllReplicas:0),[t3,0] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:10),ReplicationFactor:1),AllReplicas:0),[t2,1] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2),[t3,1] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2),[t3,2] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:10),ReplicationFactor:1),AllReplicas:0),[t7,0] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:10),ReplicationFactor:1),AllReplicas:0),[t1,0] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2),[t4,0] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2),[t6,0] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:10),ReplicationFactor:1),AllReplicas:0),[t1,2] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2),[t2,0] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:10),ReplicationFactor:1),AllReplicas:0),[t2,2] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:10),ReplicationFactor:1),AllReplicas:0) to broker id:0,host:fufuka,port:9092. Reconnecting to broker. (kafka.controller.RequestSendThread)
java.nio.channels.ClosedChannelException
	at kafka.network.BlockingChannel.send(BlockingChannel.scala:100)
	at kafka.controller.RequestSendThread.liftedTree1$1(ControllerChannelManager.scala:132)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-04 13:44:55,651] INFO [SessionExpirationListener on 2], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2015-08-04 13:44:55,652] INFO [delete-topics-thread-2], Shutting down (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-04 13:44:55,652] INFO [delete-topics-thread-2], Stopped  (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-04 13:44:55,652] INFO [delete-topics-thread-2], Shutdown completed (kafka.controller.TopicDeletionManager$DeleteTopicsThread)
[2015-08-04 13:44:55,653] INFO [Partition state machine on Controller 2]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2015-08-04 13:44:55,653] INFO [Replica state machine on controller 2]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2015-08-04 13:44:55,653] INFO [Controller-2-to-broker-2-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-04 13:44:55,653] INFO [Controller-2-to-broker-2-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-04 13:44:55,653] INFO [Controller-2-to-broker-2-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-04 13:45:24,306] INFO [Controller-2-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2015-08-04 13:45:24,306] INFO [Controller-2-to-broker-0-send-thread], Controller 2 connected to id:0,host:fufuka,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-08-04 13:45:24,308] ERROR [Controller-2-to-broker-0-send-thread], Controller 2 fails to send a request to broker id:0,host:fufuka,port:9092 (kafka.controller.RequestSendThread)
java.lang.NullPointerException
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:154)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:60)
[2015-08-04 13:45:24,308] INFO [Controller-2-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2015-08-04 13:45:24,308] INFO [Controller-2-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2015-08-04 13:45:24,318] INFO [BrokerChangeListener on Controller 2]: Broker change listener fired for path /brokers/ids with children 0,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-08-04 13:45:24,318] DEBUG [DeleteTopicsListener on 2]: Delete topics listener fired for topics  to be deleted (kafka.controller.PartitionStateMachine$DeleteTopicsListener)
[2015-08-04 13:45:24,326] INFO [AddPartitionsListener on 2]: Add Partition triggered {"version":1,"partitions":{"0":[2]}} for path /brokers/topics/t4 (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2015-08-04 13:45:24,332] INFO [AddPartitionsListener on 2]: Add Partition triggered {"version":1,"partitions":{"2":[0],"1":[2],"0":[0]}} for path /brokers/topics/t3 (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2015-08-04 13:45:24,342] INFO [AddPartitionsListener on 2]: Add Partition triggered {"version":1,"partitions":{"2":[0],"1":[2],"0":[0]}} for path /brokers/topics/t2 (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2015-08-04 13:45:24,348] INFO [AddPartitionsListener on 2]: Add Partition triggered {"version":1,"partitions":{"2":[2],"1":[0],"0":[2]}} for path /brokers/topics/t1 (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2015-08-04 13:45:24,353] INFO [AddPartitionsListener on 2]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/t7 (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2015-08-04 13:45:24,358] INFO [AddPartitionsListener on 2]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/t6 (kafka.controller.PartitionStateMachine$AddPartitionsListener)
